/*! For license information please see player.v2.modern.js.LICENSE.txt */
(()=>{function e(r){var n=i[r];if(void 0!==n)return n.exports;var o=i[r]={id:r,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.exports}var t={4514:(e,t,i)=>{(t=e.exports=i(6462)(!1)).push([e.id,"._1gZJUfw{user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;position:relative;background:#000;background-position:center;background-size:contain;background-repeat:no-repeat;width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;text-align:left;outline:0}._2jlIyxK{width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;user-select:none;text-align:left;outline:0;position:absolute;top:0;left:0;pointer-events:none;background:0 0}._1gZJUfw ._17DR8Wz{display:none!important}._1gZJUfw>iframe.KNlHF8r{position:absolute;width:100%;height:100%;border:0}._1gZJUfw .xDBHr4L{position:absolute;width:100%;height:100%;pointer-events:none}._1gZJUfw video{width:100%;height:100%}._1gZJUfw video::-webkit-media-controls-start-playback-button{z-index:2147483647!important}._1gZJUfw video._33stY3F::-webkit-media-controls-start-playback-button{display:none!important}",""]),t.locals={StreamPlayer:"_1gZJUfw",StreamPlayer_ui:"_2jlIyxK",hidden:"_17DR8Wz",container:"KNlHF8r",adSkin:"xDBHr4L","hide-native-play-button":"_33stY3F"}},7724:(e,t,i)=>{var r=i(1768),n=i(3289);"string"===typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);var o={injectType:"singletonStyleTag",attributes:{"data-ya-player-style":"data-ya-player-style"},insert:"head",singleton:!0};r(n,o);e.exports=n.locals||{}},1768:(e,t,i)=>{"use strict";function r(e){for(var t=-1,i=0;i<p.length;i++)if(p[i].identifier===e){t=i;break}return t}function n(e,t){for(var i={},n=[],o=0;o<e.length;o++){var a=e[o],s=t.base?a[0]+t.base:a[0],d=i[s]||0,c="".concat(s," ").concat(d);i[s]=d+1;var u=r(c),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==u?(p[u].references++,p[u].updater(h)):p.push({identifier:c,updater:l(h,t),references:1}),n.push(c)}return n}function o(e){var t=document.createElement("style"),r=e.attributes||{};if("undefined"===typeof r.nonce){var n=i.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"===typeof e.insert)e.insert(t);else{var o=h(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}function a(e,t,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,n);else{var o=document.createTextNode(n),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function s(e,t,i){var r=i.css,n=i.media,o=i.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&"undefined"!==typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function l(e,t){var i,r,n;if(t.singleton){var l=v++;i=g||(g=o(t)),r=a.bind(null,i,l,!1),n=a.bind(null,i,l,!0)}else i=o(t),r=s.bind(null,i,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}var d,c,u=function(){return"undefined"===typeof d&&(d=Boolean(window&&document&&document.all&&!window.atob)),d},h=function(){var e={};return function(t){if("undefined"===typeof e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(r){i=null}e[t]=i}return e[t]}}(),p=[],f=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")}),g=null,v=0;e.exports=function(e,t){(t=t||{}).singleton||"boolean"===typeof t.singleton||(t.singleton=u());var i=n(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<i.length;o++){var a=r(i[o]);p[a].references--}for(var s=n(e,t),l=0;l<i.length;l++){var d=r(i[l]);0===p[d].references&&(p[d].updater(),p.splice(d,1))}i=s}}}},4939:(e,t)=>{"use strict";t.A=function(e,t,i){for(var r=e.length+t.length,n=new Array(r),o=0,a=0,s=0;s<r;){var l=o>=e.length,d=a>=t.length;!l&&(d||i(e[o],t[a])<0)?(n[s]=e[o],o++):(n[s]=t[a],a++),s++}return n}},9940:(e,t)=>{"use strict";function i(e,t){try{return t(e)}catch(i){return e}}t.parse=function(e,t){if("string"!==typeof e)throw new TypeError("argument str must be a string");for(var n={},a=t||{},s=e.split(o),l=a.decode||r,d=0;d<s.length;d++){var c=s[d],u=c.indexOf("=");if(!(u<0)){var h=c.substr(0,u).trim(),p=c.substr(++u,c.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),void 0==n[h]&&(n[h]=i(p,l))}}return n},t.serialize=function(e,t,i){var r=i||{},o=r.encode||n;if("function"!==typeof o)throw new TypeError("option encode is invalid");if(!a.test(e))throw new TypeError("argument name is invalid");var s=o(t);if(s&&!a.test(s))throw new TypeError("argument val is invalid");var l=e+"="+s;if(null!=r.maxAge){var d=r.maxAge-0;if(isNaN(d))throw new Error("maxAge should be a Number");l+="; Max-Age="+Math.floor(d)}if(r.domain){if(!a.test(r.domain))throw new TypeError("option domain is invalid");l+="; Domain="+r.domain}if(r.path){if(!a.test(r.path))throw new TypeError("option path is invalid");l+="; Path="+r.path}if(r.expires){if("function"!==typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");l+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(l+="; HttpOnly"),r.secure&&(l+="; Secure"),r.sameSite)switch("string"===typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}return l};var r=decodeURIComponent,n=encodeURIComponent,o=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},6462:e=>{function t(e,t){var i,r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"===typeof btoa){var o=(i=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),a=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[r].concat(a).concat([o]).join("\n")}return[r].join("\n")}e.exports=function(e){var i=[];return i.toString=function(){return this.map((function(i){var r=t(i,e);return i[2]?"@media "+i[2]+"{"+r+"}":r})).join("")},i.i=function(e,t){"string"===typeof e&&(e=[[null,e,""]]);for(var r={},n=0;n<this.length;n++){var o=this[n][0];"number"===typeof o&&(r[o]=!0)}for(n=0;n<e.length;n++){var a=e[n];"number"===typeof a[0]&&r[a[0]]||(t&&!a[2]?a[2]=t:t&&(a[2]="("+a[2]+") and ("+t+")"),i.push(a))}},i}},1413:e=>{"use strict";var t=Array.isArray,i=Object.keys,r=Object.prototype.hasOwnProperty;e.exports=function e(n,o){if(n===o)return!0;if(n&&o&&"object"==typeof n&&"object"==typeof o){var a,s,l,d=t(n),c=t(o);if(d&&c){if((s=n.length)!=o.length)return!1;for(a=s;0!==a--;)if(!e(n[a],o[a]))return!1;return!0}if(d!=c)return!1;var u=n instanceof Date,h=o instanceof Date;if(u!=h)return!1;if(u&&h)return n.getTime()==o.getTime();var p=n instanceof RegExp,f=o instanceof RegExp;if(p!=f)return!1;if(p&&f)return n.toString()==o.toString();var g=i(n);if((s=g.length)!==i(o).length)return!1;for(a=s;0!==a--;)if(!r.call(o,g[a]))return!1;for(a=s;0!==a--;)if(!e(n[l=g[a]],o[l]))return!1;return!0}return n!==n&&o!==o}},3628:e=>{function t(){var e,t,i,r,n=document.createElement("canvas");try{e=n.getContext("webgl")||n.getContext("experimental-webgl")}catch(o){}return e&&(t=e.getExtension("WEBGL_debug_renderer_info"),i=e.getParameter(t.UNMASKED_VENDOR_WEBGL),r=e.getParameter(t.UNMASKED_RENDERER_WEBGL)),{debugInfo:t,vendor:i,renderer:r}}e.exports=t,e.exports.getGpu=t},56:e=>{e.exports=function(e){e||(e=window);var t=e.navigator.userAgent,i=t.indexOf("MSIE ");if(i>0)return parseInt(t.substring(i+5,t.indexOf(".",i)),10);if(t.indexOf("Trident/")>0){var r=t.indexOf("rv:");return parseInt(t.substring(r+3,t.indexOf(".",r)),10)}var n=t.indexOf("Edge/");return n>0&&parseInt(t.substring(n+5,t.indexOf(".",n)),10)}},3579:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ErrorDetails:()=>n,ErrorTypes:()=>r});const r={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},n={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},2490:(e,t,i)=>{"use strict";function r(){const e=function(){if("undefined"!==typeof window)return window.MediaSource||window.WebKitMediaSource}(),t=window.SourceBuffer||window.WebKitSourceBuffer,i=e&&"function"===typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove;return!!i&&!!r}i.r(t),i.d(t,{isSupported:()=>r})},7042:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TALB:"album",TBPM:"bpm",TCOM:"composer",TCON:"genre",TCOP:"copyright",TDEN:"encoding-time",TDLY:"playlist-delay",TDOR:"original-release-time",TDRC:"recording-time",TDRL:"release-time",TDTG:"tagging-time",TENC:"encoder",TEXT:"writer",TFLT:"file-type",TIPL:"involved-people",TIT1:"content-group",TIT2:"title",TIT3:"subtitle",TKEY:"initial-key",TLAN:"language",TLEN:"length",TMCL:"credits",TMED:"media-type",TMOO:"mood",TOAL:"original-album",TOFN:"original-filename",TOLY:"original-writer",TOPE:"original-artist",TOWN:"owner",TPE1:"artist",TPE2:"band",TPE3:"conductor",TPE4:"remixer",TPOS:"set-part",TPRO:"produced-notice",TPUB:"publisher",TRCK:"track",TRSN:"radio-name",TRSO:"radio-owner",TSOA:"album-sort",TSOP:"performer-sort",TSOT:"title-sort",TSRC:"isrc",TSSE:"encoder-settings",TSST:"set-subtitle",TXXX:"user-defined-text-information",TYER:"year",WCOM:"url-commercial",WCOP:"url-legal",WOAF:"url-file",WOAR:"url-artist",WOAS:"url-source",WORS:"url-radio",WPAY:"url-payment",WPUB:"url-publisher",WAF:"url-file",WAR:"url-artist",WAS:"url-source",WCM:"url-commercial",WCP:"url-copyright",WPB:"url-publisher",COMM:"comments",USLT:"lyrics",APIC:"image",PIC:"image",IPLS:"involved-people-list",OWNE:"ownership"},t.FrameTypeValueMap={TXXX:"array",COMM:"array",USLT:"array"}},7060:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop / Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast  Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Rock/Pop"]},9522:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["other","file-icon","icon","cover-front","cover-back","leaflet","media","artist-lead","artist","conductor","band","composer","lyricist-writer","recording-location","during-recording","during-performance","screen","fish","illustration","logo-band","logo-publisher"]},9388:function(e,t,i){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},n=this&&this.__rest||function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&(i[r[n]]=e[r[n]])}return i};Object.defineProperty(t,"__esModule",{value:!0});var o=i(6609);t.parseV1Tag=o.default;var a=i(7140);t.parseV2Tag=a.default,i(8613).default(),t.parse=function(e){var t=o.default(e),i=a.default(e);if(!i&&!t)return!1;var s={version:!1},l=i||s,d=l.version,c=n(l,["version"]),u=t||s,h=u.version,p=n(u,["version"]),f=r({version:{v1:h,v2:d}},p,c);return p.comments&&(f.comments=[{value:p.comments}].concat(c&&c.comments?c.comments:[])),f}},6609:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(7060),n=i(1077);t.default=function(e){if(!e||e.length<128)return!1;e=e.slice(e.length-128);var t={version:{major:1,minor:0}};if("TAG"!==n.readBytesToUTF8(e,3))return!1;var i=/(^[\s0]+|[\s0]+$)/;return t.title=n.readBytesToUTF8(e.slice(3),30).replace(i,""),t.artist=n.readBytesToUTF8(e.slice(33),30).replace(i,""),t.album=n.readBytesToUTF8(e.slice(63),30).replace(i,""),t.year=n.readBytesToUTF8(e.slice(93),4).replace(i,""),0===e[125]?(t.comments=n.readBytesToUTF8(e.slice(97),28).replace(i,""),t.version.minor=1,t.track=e[126]):t.comments=n.readBytesToUTF8(e.slice(97),30).replace(i,""),t.genre=r.default[e[127]]||"",t}},7140:(e,t,i)=>{"use strict";function r(e){return 2097152*(127&e[0])+16384*(127&e[1])+128*(127&e[2])+(127&e[3])}function n(e){return e.length<4?0:16777216*e[0]+65536*e[1]+256*e[2]+e[3]}function o(e,t,i){var r={id:null,tag:null,value:null},n={id:d.readBytesToUTF8(e,4),type:null,size:i,flags:[e[8],e[9]]};if(n.type=n.id[0],r.id=n.id,0!==n.flags[1])return r;if(!(n.id in a.default))return r;r.tag=a.default[n.id];var o=0,c=0,u=0,h=0;if("T"===n.type){if(o=e[10],"TXXX"===n.id){c=11,u=d.getEndpointOfBytes(e,o,c)-c;var p={description:d.readBytesToString(e.slice(c),o,u),value:""};c+=u+1,c=d.skipPaddingZeros(e,c),p.value=d.readBytesToString(e.slice(c),o),r.value=p}else if(r.value=d.readBytesToString(e.slice(11),o),"TCON"===n.id&&null!==r.value)if("("===r.value[0]){var f=r.value.match(/\(\d+\)/g);f&&(r.value=f.map((function(e){return s.default[+e.slice(1,-1)]})).join(","))}else{var g=parseInt(r.value,10);isNaN(g)||(r.value=s.default[g])}}else if("W"===n.type)"WXXX"===n.id&&0===e[10]?r.value=d.readBytesToISO8859(e.slice(11)):r.value=d.readBytesToISO8859(e.slice(10));else if("COMM"===n.id||"USLT"===n.id){o=e[10],c=14,u=0;var v=d.readBytesToISO8859(e.slice(11),3);u=d.getEndpointOfBytes(e,o,c)-c;var m=d.readBytesToString(e.slice(c),o,u);c=d.skipPaddingZeros(e,c+u+1),r.value={language:v,description:m,value:d.readBytesToString(e.slice(c),o)}}else if("APIC"===n.id){o=e[10];var A={type:null,mime:null,description:null,data:null};for(c=11,u=d.getEndpointOfBytes(e,0,c)-c,A.mime=d.readBytesToString(e.slice(c),0,u),A.type=l.default[e[c+u+1]]||"other",c+=u+2,u=0,h=c;;h++)if(0===e[h]){u=h-c;break}A.description=0===u?null:d.readBytesToString(e.slice(c),o,u),c=d.skipPaddingZeros(e,c+u+1),A.data=e.slice(c),r.value=A}else if("IPLS"===n.id)o=e[10],r.value=d.readBytesToString(e.slice(11),o);else if("OWNE"===n.id){o=e[10],c=11,u=d.getEndpointOfBytes(e,o,c);var E=d.readBytesToISO8859(e.slice(c),u);c+=u+1;var y=d.readBytesToISO8859(e.slice(c),8);c+=8,r.value={pricePayed:E,dateOfPurch:y,seller:d.readBytesToString(e.slice(c),o)}}return r}Object.defineProperty(t,"__esModule",{value:!0});var a=i(7042),s=i(7060),l=i(9522),d=i(1077);t.default=function(e){if(!e||e.length<20)return!1;var t=function(e){if(!e||e.length<10)return!1;if("ID3"!==d.readBytesToUTF8(e,3))return!1;var t=e[5];return{version:{major:2,minor:e[3],revision:e[4],flags:{unsync:0!==(128&t),xheader:0!==(64&t),experimental:0!==(32&t)}}}}(e.slice(0,10));if(!t)return!1;var i=t.version.flags;if(i.unsync)throw new Error("no support for unsynchronisation");var s=10;i.xheader&&(s+=r(e.slice(10,14)));var l=r(e.slice(6,10));return function(e,t){var i=0,r=t.version;for(;i<e.length;){var s=n(e.slice(i+4));if(0===s)break;var l=e.slice(i,i+10+s);if(!l.length)break;var d=o(l,r.minor,s);d.tag&&("array"===a.FrameTypeValueMap[d.id]?t[d.tag]?t[d.tag].push(d.value):t[d.tag]=[d.value]:t[d.tag]=d.value),i+=l.length}}(e.slice(s,l+s),t),t},t.calcTagSize=r,t.calcFrameSize=n},8613:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){"function"!==typeof Uint8Array||Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice})}},1077:(e,t)=>{"use strict";function i(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);var i=0;239===e[0]&&187===e[1]&&191===e[2]&&(i=3);for(var r=[],n=0;i<t;n++){var a=e[i++],s=void 0,l=void 0,d=void 0;if(0===a)break;a<128?r[n]=o(a):a>=194&&a<224?(s=e[i++],r[n]=o(((31&a)<<6)+(63&s))):a>=224&&a<240?(s=e[i++],l=e[i++],r[n]=o(((15&a)<<12)+((63&s)<<6)+(63&l))):a>=240&&a<245&&(d=((7&a)<<18)+((63&(s=e[i++]))<<12)+((63&(l=e[i++]))<<6)+(63&e[i++])-65536,r[n]=o(55296+(d>>10),56320+(1023&d)))}return r.join("")}function r(e,t,i){i=null==i||i<0?e.length:Math.min(i,e.length);var r=0,n=1,a=0;254===e[0]&&255===e[1]?(t=!0,r=2):255===e[0]&&254===e[1]&&(t=!1,r=2),t&&(n=0,a=1);for(var s,l,d,c,u=[],h=0;r<i&&(s=e[r+n],l=e[r+a],r+=2,0!==(d=(s<<8)+l));h++)s<216||s>=224?u[h]=o(d):(c=(e[r+n]<<8)+e[r+a],r+=2,u[h]=o(d,c));return u.join("")}function n(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);for(var i=[],r=0;r<t;r++)i.push(o(e[r]));return i.join("")}Object.defineProperty(t,"__esModule",{value:!0});var o=String.fromCharCode;t.readBytesToUTF8=i,t.readBytesToUTF16=r,t.readBytesToISO8859=n,t.readBytesToString=function(e,t,o){return 0===t?n(e,o):3===t?i(e,o):1===t||2===t?r(e,void 0,o):null},t.getEndpointOfBytes=function(e,t,i){void 0===i&&(i=0);for(var r=0===t?function(t){return 0===e[t]}:function(t){return 0===e[t]&&0===e[t+1]},n=i;n<e.length&&!r(n);n++);return n},t.skipPaddingZeros=function(e,t){for(var i=t;0===e[i];i++)t++;return t}},2743:(e,t,i)=>{"use strict";function r(){return(r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();t.hasCookies=function(){var e=new c;try{e.setItem("__test","1");var t=e.getItem("__test");return e.removeItem("__test"),"1"===t}catch(i){return!1}};var a,s=i(9940),l=(a=s)&&a.__esModule?a:{default:a},d="lS_",c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.cookieOptions=r({path:"/"},t),d=t.prefix||d}return o(e,[{key:"getItem",value:function(e){var t=l.default.parse(document.cookie);return t&&t.hasOwnProperty(d+e)?t[d+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=l.default.serialize(d+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=r({},this.cookieOptions,{maxAge:-1});return document.cookie=l.default.serialize(d+e,"",t),null}},{key:"clear",value:function(){var e=l.default.parse(document.cookie);for(var t in e)0===t.indexOf(d)&&this.removeItem(t.substr(d.length));return null}}]),e}();t.default=c},6908:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return i(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=r},1836:(e,t,i)=>{"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var n=r(i(766)),o=r(i(2743)),a=r(i(6908)),s=null;s=(0,n.default)("localStorage")?window.localStorage:(0,n.default)("sessionStorage")?window.sessionStorage:(0,n.default)("cookieStorage")?new o.default:new a.default,t.Ay=s,n.default,o.default,a.default},766:(e,t,i)=>{"use strict";function r(e){try{var t=window[e];return t.setItem("__test","1"),t.removeItem("__test"),!0}catch(i){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return r("localStorage");if("session"===t)return r("sessionStorage");if("cookie"===t)return(0,n.hasCookies)();if("memory"===t)return!0;throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")};var n=i(2743)},5051:(e,t)=>{"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};t.a=function(e){function t(){s===a&&(s=a.slice())}function r(e){if("function"!==typeof e)throw new Error("Expected listener to be a function.");var i=!0;return t(),s.push(e),function(){if(i){i=!1,t();var r=s.indexOf(e);s.splice(r,1)}}}function n(){for(var e=a=s,t=0;t<e.length;t++)e[t]()}function o(){e(n)}if("function"!==typeof e)throw new Error("Expected batch to be a function.");var a=[],s=a;return function(e){return function(){function t(){var e=n.dispatch.apply(n,arguments);return o(),e}var n=e.apply(void 0,arguments),a=n.subscribe;return i({},n,{dispatch:t,subscribe:r,subscribeImmediate:a})}}}},7186:e=>{e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i]);return e})},9979:e=>{"use strict";e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=t[i]);return e})},4972:e=>{e.exports={zendexConfig:{staticApi:"static.dzeninfra.ru",strmApi:"cdn.dzen.ru",gogolApi:"log.dzen.ru",s3:"s3.dzeninfra.ru",avatars:"avatars.dzeninfra.ru",mediascopeApi:"ms.dzen.ru"}}},3289:(e,t,i)=>{(t=e.exports=i(6462)(!1)).push([e.id,"video._20Eh5WL::-webkit-media-controls{display:none!important}video._1ll4Zna::-webkit-media-controls-current-time-display,video._1ll4Zna::-webkit-media-controls-time-remaining-display{visibility:hidden!important}video._3D52tih::-webkit-media-controls-timeline{visibility:hidden!important}video._2yNfXKt::-webkit-media-controls-toggle-closed-captions-button{display:none}",""]),t.locals={video_hiddenControls:"_20Eh5WL",videoHiddenControls:"_20Eh5WL",video_hiddenTime:"_1ll4Zna",videoHiddenTime:"_1ll4Zna",video_hiddenTimeline:"_3D52tih",videoHiddenTimeline:"_3D52tih",video_hiddenSubtitlesBtn:"_2yNfXKt",videoHiddenSubtitlesBtn:"_2yNfXKt"}}},i={};e.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},e.d=(t,i)=>{for(var r in i)e.o(i,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.nc=void 0,(()=>{"use strict";function t(e){e&&"function"===typeof e.catch&&e.catch(e=>{})}function i(e,t){try{return e()}catch(i){"function"===typeof t&&t(i)}}function r(e){const t=e.document;let i=t.getElementsByTagName("head")[0];return i||(i=t.createElement("head"),t.documentElement.appendChild(i)),i}function n(e){return"function"===typeof e||"Function"===Ts(e)}function o(e){void 0===e&&(e=window);try{return(e.navigator||{}).userAgent||""}catch(t){return""}}function a(e){if(void 0===e)return Is.DEFAULT;const t=function(e){switch(e){case Cs.DEFAULT_ERROR:return Is.DEFAULT;case Cs.BROADCAST_AD_BLOCK_INIT_ERROR:case Cs.AD_TYPE_IS_NOT_RECOGNIZED:case Cs.AD_IS_ALREADY_PLAYING:case Cs.MULTIROLL_INIT_ERROR:case Cs.PLAY_AD_VIEWERS_ERROR:return Is.ADS;case Cs.INVALID_METADATA:case Cs.NO_STREAMS:return Is.CONFIG;case Cs.YANDEX_RPC_ERROR:case Cs.ON_TICK_ERROR:case Cs.SAGA_ERROR:case Cs.SHAKA_FILTER_ERROR:case Cs.SHAKA_CONFIGURE_ERROR:case Cs.SHAKA_LOAD_SOURCE_ERROR:case Cs.REFRESH_SUBTITLES_ERROR:case Cs.NO_HLS_JS_INSTANCE:case Cs.REACT_COMPONENT_DID_CATCH_ERROR_INFO:case Cs.RECOVER_TASK_ERROR:case Cs.PRELOAD_SOURCE_FAILED:case Cs.MEDIA_ERR_ABORTED:return Is.EXCEPTION;case Cs.UNSUPPORTED_MEDIA_TYPE:case Cs.NATIVE_HLS_NOT_SUPPORTED_ERROR:case Cs.HLS_JS_NOT_SUPPORTED_ERROR:case Cs.MEDIA_ERR_SRC_NOT_SUPPORTED:case Cs.MEDIA_ERR_CUSTOM:case Cs.MEDIA_ERR_DECODE:case Cs.REPRESENTATION_CHANGE:return Is.MEDIA;case Cs.SCRIPT_INIT_ERROR:case Cs.MPD_SHAKA_INIT_ERROR:case Cs.META_INFO_REQUEST_FAILED:case Cs.STRM_ABD_INVALID_RESPONSE:return Is.NETWORK_PLAYER;case Cs.MEDIA_ERR_NETWORK:return Is.NETWORK_MEDIA;case Cs.MPD_WIDEVINE_CERT_LOAD_ERROR:case Cs.FAIRPLAY_CERT_LOAD_ERROR:case Cs.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR:case Cs.FAIRPLAY_CREATE_KEY_SESSION_ERROR:case Cs.FAIRPLAY_SPC_LOAD_ERROR:case Cs.FAIRPLAY_CREATE_KEY_ERROR:case Cs.FAIRPLAY_INVALID_CONTENT_ID:case Cs.DRM_PROXY_ERROR:case Cs.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:case Cs.MEDIA_ERR_ENCRYPTED:case Cs.FAIRPLAY_NOT_SUPPORTED:case Cs.NO_DRM:return Is.DRM;case Cs.REGIONAL_LIMITATION_MANIFEST:case Cs.REGIONAL_LIMITATION_LEVEL:case Cs.REGIONAL_LIMITATION_SEGMENT:return Is.REGIONAL;case Cs.SIGNATURE_EXPIRED_MANIFEST:case Cs.SIGNATURE_EXPIRED_LEVEL:case Cs.SIGNATURE_EXPIRED_SEGMENT:return Is.ACCESS;case Cs.NO_CODECS:return Is.NO_CODECS;case Cs.NO_PLAYABLE_STREAMS:return Is.CANNOT_PLAY;case Cs.NO_MSE:return Is.UNSUPPORTED_ENV;case Cs.INVALID_STREAM_URL:return Is.INVALID_STREAM_URL}return Is.DEFAULT}(e);if(t!==Is.DEFAULT)return t;switch(e){case Os.BUFFER_FULL_ERROR:case Os.BUFFER_NUDGE_ON_STALL:case Os.BUFFER_STALLED_ERROR:case Os.SHAKA_VIDEO_ERROR_3016:case Os.FRAG_PARSING_ERROR:case Os.BUFFER_SEEK_OVER_HOLE:case Os.BUFFER_APPENDING_ERROR:case Os.PIPELINE_ERROR_DECODE:case Os.DECODER_ERROR_NOT_SUPPORTED:case Os.BUFFER_APPEND_ERROR:case Os.SHAKA_MEDIA_SOURCE_OPERATION_THREW_3015:case Os.MEDIA_ELEMENT_ERROR_FORMAT_ERROR:case Os.REMUX_ALLOC_ERROR:case Os.BUFFER_ADD_CODEC_ERROR:case Os.DEMUXER_ERROR_COULD_NOT_OPEN:case Os.NS_ERROR_DOM_INVALID_STATE_ERR:case Os.SHAKA_DASH_INVALID_XML_4001:case Os.SHAKA_QUOTA_EXCEEDED_ERROR_3017:case Os.CHUNK_DEMUXER_ERROR_APPEND_FAILED:case Os.FAILED_TO_INIT_DECODER:case Os.PIPELINE_ERROR_INITIALIZATION_FAILED:case Os.NS_ERROR_FAILURE:case Os.SHAKA_MEDIA_SOURCE_OPERATION_FAILED_3014:case Os.REQUEST_FAILED:case Os.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED:case Os.PIPELINE_ERROR_COULD_NOT_RENDER:case Os.NS_ERROR_DOM_MEDIA_METADATA_ERR:case Os.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE:case Os.NS_ERROR_DOM_MEDIA_FATAL_ERR:case Os.SHAKA_RESTRICTIONS_CANNOT_BE_MET_4012:case Os.MANIFEST_PARSING_ERROR:return Is.MEDIA;case Os.FRAG_LOAD_ERROR:case Os.SHAKA_BAD_HTTP_STATUS_1001_MANIFEST:case Os.SHAKA_HTTP_ERROR_1002_SEGMENT:case Os.MANIFEST_LOAD_ERROR:case Os.LEVEL_LOAD_ERROR:case Os.SHAKA_HTTP_ERROR_1002_MANIFEST:case Os.SHAKA_BAD_HTTP_STATUS_1001_SEGMENT:case Os.SHAKA_UNSUPPORTED_SCHEME_1000:case Os.AUDIO_TRACK_LOAD_ERROR:return Is.NETWORK_MEDIA;case Os.SHAKA_TIMEOUT_1003_SEGMENT:case Os.FRAG_LOAD_TIME_OUT:case Os.MANIFEST_LOAD_TIME_OUT:case Os.LEVEL_LOAD_TIME_OUT:case Os.SHAKA_TIMEOUT_1003_MANIFEST:case Os.SHAKA_TIMEOUT_1003_LICENSE:case Os.AUDIO_TRACK_LOAD_TIME_OUT:return Is.NETWORK_TIMEOUT;case Os.INTERNAL_EXCEPTION:case Os.SHAKA_OPERATION_ABORTED_7001:case Os.ON_PLAYER_INIT_ERROR_INTERNAL:case Os.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case Os.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case Os.LOAD_SKIN_ERROR:case Os.INSERT_INTO_WITH_SECURE_FRAME:case Os.ERROR_SCREEN_LOAD_ERROR:return Is.EXCEPTION;case Os.UNABLE_TO_LOAD_PLAYER_IFRAME:case Os.ON_PLAYER_INIT_ERROR:case Os.LOADER_INIT_ERROR:case Os.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT:case Os.FAILED_TO_DOWNLOAD_DEBUG_INFO:case Os.SHAKA_REQUEST_FILTER_ERROR_1006:return Is.NETWORK_PLAYER;case Os.PLAYER_CONTAINER_NOT_FOUND:case Os.KEY_LOAD_ERROR:case Os.FEATURE_HANDLER_ERROR:case Os.SHAKA_NO_LICENSE_SERVER_GIVEN_6012:case Os.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER:case Os.INVALID_CONFIG_LANG_IN_CREATE_PLAYER:case Os.INVALID_CONFIG_IN_CREATE_PLAYER:case Os.INVALID_CONFIG_IN_SET_SOURCE:case Os.INVALID_CONFIG_IN_SOURCE_UPDATE:case Os.ELEMENT_NOT_IN_DOM:return Is.CONFIG;case Os.SHAKA_FAILED_TO_CREATE_CDM_6002:case Os.SHAKA_HTTP_ERROR_1002_LICENSE:case Os.SHAKA_LICENSE_REQUEST_FAILED_6007:case Os.SHAKA_FAILED_TO_GENERATE_LICENSE_REQUEST_6006:case Os.SHAKA_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001:case Os.SHAKA_FAILED_TO_ATTACH_TO_VIDEO_6003:case Os.SHAKA_LICENSE_RESPONSE_REJECTED_6008:case Os.SHAKA_INVALID_SERVER_CERTIFICATE_6004:case Os.SHAKA_EXPIRED_6014:case Os.SHAKA_BAD_HTTP_STATUS_1001_LICENSE:return Is.DRM;case Os.SHAKA_CONTENT_UNSUPPORTED_BY_BROWSER_4032:return Is.NO_CODECS}return Is.DEFAULT}function s(e,t){if(void 0===t&&(t=!1),e===Cs.NO_CODECS&&_s&&bs>6)return{title:"NO_CODECS_TITLE",message:"NO_CODECS_MESSAGE",helpLink:"https://dzen.ru/help/troubleshooting/",helpLinkButtonText:"NO_CODECS_HELP_LINK_TITLE"};const i=a(e);return t&&function(e){return[Is.NETWORK_PLAYER,Is.NETWORK_MEDIA,Is.NETWORK_TIMEOUT,Is.DRM,Is.ADS].includes(e)}(i)?{title:"ADBLOCK_DETECTED_TITLE",message:"ADBLOCK_DETECTED_MESSAGE",helpLink:"https://dzen.ru/help/troubleshooting/",helpLinkButtonText:"ERROR_SCREEN_DEFAULT_HELP_LINK"}:function(e){return{title:ks[e],message:Ds[e],helpLink:ws[e],helpLinkButtonText:Ns[e]||"ERROR_SCREEN_DEFAULT_HELP_LINK"}}(i)}function l(e,t,i){return e>i?i:e<t?t:e}function d(e){return"string"===typeof e}function c(e,t){const i=e.style;for(const r in t)if(t.hasOwnProperty(r)){i[Us(r)]=t[r]}}function u(e){if(!e||!e.toString)return!1;const t=e.toString();return/\[native code\]/.test(t)||/\/\* source code not available \*\//.test(t)}function h(e,t){let i=e[t];if(!u(i)){const n=i;try{delete e[t];const r=e[t];"function"===typeof r&&(i=r),e[t]=n}catch(r){}}return i}function p(){}function f(e,t,i,r){const n=function(e){let t=!1,i=!1,r=!1;return!0===e?t=!0:"object"===typeof e&&(t=Boolean(e.capture),i=Boolean(e.passive),r=Boolean(e.once)),{capture:t,passive:i,once:r}}(r),o=qs?n:n.capture,a=n.once&&!Ks?function(e){s(),i.call(this,e)}:i,s=()=>{Ys(e,t,a,o)};return Ws(e,t,a,o),s}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function v(e){if("function"===typeof Object.keys)return Object.keys(e);{const t=[];for(const i in e)g(e,i)&&t.push(i);return t}}function m(e){const t=[...e],i=t.pop();if(!i||0===t.length)throw new Error("memoizeSingle need at least 2 functions as arg");return{preparers:t,resolver:i}}function A(e,t,i){for(const r in e)g(e,r)&&t.call(i,e[r],r,e)}function E(e){return d(e.className)?e.className:e.namespaceURI===Js.svg&&e.getAttribute("class")||""}function y(e,t){d(e.className)?e.className=t:e.namespaceURI===Js.svg&&e.setAttributeNS("","class",t)}function S(e,t){void 0===t&&(t=""),0!==e.className.length?el(e)?rl(e,t):function(e,t){let i=E(e).split(" ").concat(t.split(" "));i=function(e){const t={};for(let i=0;i<e.length;i++)t[e[i]]=i;return v(t)}(Xs(i,(function(e){return""!==e}))),y(e,i.join(" "))}(e,t):e.className=t}function T(e,t){void 0===t&&(t=!0);const i=nl(e);if(!i)return t;return!e[i]}function R(e,t){const i=function(e){const t=nl(e);if(t)return t.replace(/hidden/i,"visibilitychange")}(e);return i?f(e,i,()=>{t(T(e))}):p}function P(e,t){let{content:i,size:r}=void 0===t?{}:t;const n=e.ownerDocument.createElement("iframe");n.scrolling="no",n.setAttribute("allowfullscreen",""),n.style.display="block",r&&(n.height=r.height,n.width=r.width),e.appendChild(n);const o=n.contentDocument;return o.open(),i&&o.write(i),o.close(),o.body.style.margin="0",n.style.borderWidth="0",n}function _(e){if(!e)return;const{parentElement:t}=e;t&&t.removeChild(e)}function b(e){return void 0===e&&(e=window),void 0===ll&&(ll=function(e){void 0===e&&(e=window);return e.JSON&&u(e.JSON.stringify)&&u(e.JSON.parse)}(e)?e.JSON:{stringify:cl("stringify"),parse:cl("parse")}),ll}function I(e){const t=typeof e;return Boolean(e)&&("object"===t||"function"===t)}function C(e){return b().stringify(e,function(){const e=[],t=function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(i,r)=>{if(void 0!==e)try{e.set(i,r)}catch(n){t.push({path:r,value:i})}else t.push({path:r,value:i})},get:i=>{const r=sl(t,e=>e.value===i);return void 0!==e&&void 0===r?e.get(i):r?r.path:void 0}}}();return(i,r)=>{if(n(r))return d(r.name)?r.name:"[Function]";if(!I(r))return r;const o=t.get(r);if(o)return"[Circular "+o+"]";for(;e.length>0&&e[e.length-1].value[i]!==r;)e.pop();const a=(e.length>0?e[e.length-1].path:"")+(i?"/"+i:"~");return e.push({path:a,value:r}),t.set(r,a),r}}())}function O(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];El(e)&&e.forEach(e=>{"function"===typeof e&&e(...i)})}function w(){return(Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function k(e,t){!function(e){return"function"===typeof e.dispatch}(e)?e(t):e.dispatch(t)}function D(e,t){e.forEach(e=>{k(e,t)})}function N(e){return 0===xl.length&&(Vl=window.setInterval(()=>{xl.forEach(e=>e())},250)),xl.push(e),()=>{const t=xl.indexOf(e);t>-1&&xl.splice(t,1),0===xl.length&&clearInterval(Vl)}}function L(e){return e}function M(e){return Math.max(e,0)}function V(e){return M(Fl(e))}function x(e){return M(function(e){return Math.floor(e)}(e))}function F(){return(F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function U(e){let t=function(){let i;return t=()=>i,i=e.apply(this,arguments),i};return function(){return t.apply(this,arguments)}}function B(e){return"number"===typeof e&&isFinite(e)}function H(e){void 0===e&&(e=Il);const t=e();return()=>Math.max(0,e()-t)}function G(e){return function(e){return Boolean(e.PointerEvent)}(e)&&function(e){const t=e.navigator||{},{msMaxTouchPoints:i,maxTouchPoints:r}=t;return i||r||0}(e)>0&&!function(e){void 0===e&&(e=window);return Hs(e)>11}(e)}function j(e,t){if(!n(e.matchMedia))return!1;const i=e.matchMedia(t);return I(i)&&Boolean(i.matches)}function W(e){return void 0===e&&(e=window),G(e)||function(e){return j(e,nd)}(e)||function(e){return j(e,od)}(e)||function(e){const{DocumentTouch:t}=e;return Boolean(t)&&e.document instanceof t}(e)||function(e){return"ontouchstart"in e}(e)}function Y(e){void 0===e&&(e=window);const t=e.navigator.userAgent.toLowerCase();return/ipad|iphone|ipod/.test(t)&&!e.MSStream&&!function(e){void 0===e&&(e=window);return e.navigator.userAgent.includes("UCBrowser")}(e)}function K(e){if(!e)return[];const t=[];for(let i=0;i<e.length;i++)t.push(e[i]);return t}function z(e){return K(e).map(e=>{let{screenX:t,screenY:i}=e;return{screenX:t,screenY:i}})}function q(e,t,i){function r(e){let{touches:t}=e;return I(t)&&t.length===u}function n(){return g>0}function o(){n()&&(window.clearTimeout(g),g=0,s=[])}function a(e){o(),h=!1}let s,{threshold:l=cd,delay:d=ud,handleContextmenu:c=!1,touchesCount:u=1}=void 0===i?{}:i,h=!1,g=0;const v=f(e,"touchstart",(function(e){r(e)&&(s=z(e.touches),o(),g=window.setTimeout(()=>{n()&&t()},d),h=!0)}),{passive:!0}),m=f(e,"touchend",a,{passive:!0}),A=f(e,"touchcancel",a,{passive:!0}),E=f(e,"touchmove",(function(e){n()&&(r(e)?function(e){if(e.length!==s.length)return!0;for(let t=0;t<e.length;t++){if(Math.abs(s[t].screenX-e[t].screenX)>l)return!0;if(Math.abs(s[t].screenY-e[t].screenY)>l)return!0}return!1}(z(e.touches))&&o():o())}),{passive:!0}),y=c?f(e,"contextmenu",(function(e){!n()&&h||(o(),t(e))}),{passive:!1}):p;return()=>{o(),v(),m(),A(),E(),y()}}function X(e){void 0===e&&(e=window);const{userAgent:t=""}=e.navigator,i=t.includes("Android"),r=function(e){void 0===e&&(e=window);return/Windows Phone/i.test(e.navigator.userAgent)}(e),n=/com\.yandex\.mobile\.metrica\.ads\.sdk.*?Android/.test(t);return i&&!r||n}function Q(){}function J(){return(J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Z(e){let{event:t}=e;const i=t.touches[0]||t.changedTouches[0];return{clientX:i?i.clientX:-1,clientY:i?i.clientY:-1}}function $(e,t){return e.map(e=>({adViewer:e,additionalData:{},adType:t}))}function ee(){return(ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function te(){return(te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ie(e){return new Promise((t,i)=>{!function e(t){const{method:i,url:r,async:n=!0,data:o,responseType:a="text",onBeforeSend:s=p,onRetry:l=p,checkStatus:d=(e=>Dd===e),headers:c={},xhrConstructor:u=XMLHttpRequest,retries:h=0,timeout:f=0,withCredentials:g,onAbort:v,onSetup:m}=t;if(!u)return;const E=t.onSuccess?U(t.onSuccess):p,y=t.onError?U(t.onError):p;let S,T=!1,R=0,P=e=>{T=!0,P=p,S=e,_(new Error("Abort request")),"function"===typeof v&&v(e)};const _=i=>{b.onerror=null,b.onreadystatechange=null,R&&clearTimeout(R);if(R&&4!==b.readyState||T)try{b.abort()}catch(i){}if(!T)if(h>0){const r=l(i,b);if("boolean"!==typeof r||Boolean(r)||P(),T)return;e(ee({},t,{onSetup:e=>{let{abort:t}=e;P=e=>t(e),T&&t(S)},retries:h-1}))}else P=p,y(i,b)},b=new u;try{b.open(i,r,n)}catch(I){return void _(I)}if(b.responseType=a,b.withCredentials=Boolean(g),A(c,(e,t)=>{try{b.setRequestHeader(t,e)}catch(I){}}),f>0&&isFinite(f)&&(R=window.setTimeout(()=>{_(new Error("Request timeout, "+r))},f)),b.onerror=_,b.onreadystatechange=()=>{if(4===b.readyState){const{status:e}=b;d(e)?(P=p,clearTimeout(R),E(b)):_(new Error("Invalid request status "+e+", "+r))}},("function"!==typeof m||(m({abort:e=>P(e)}),!T))&&(s(b,t),!T))try{b.send(o)}catch(I){_(I)}}(te({},e,{onSuccess:t,onError:i}))})}function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e){var t=function(e,t){if("object"!=re(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==re(t)?t:String(t)}function oe(e,t,i){return(t=ne(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ae(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(i),!0).forEach((function(t){oe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ae(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function le(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}function de(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function ce(e,t,i){function r(){p===h&&(p=h.slice())}function n(){if(f)throw new Error(le(3));return u}function o(e){if("function"!==typeof e)throw new Error(le(4));if(f)throw new Error(le(5));var t=!0;return r(),p.push(e),function(){if(t){if(f)throw new Error(le(6));t=!1,r();var i=p.indexOf(e);p.splice(i,1),h=null}}}function a(e){if(!de(e))throw new Error(le(7));if("undefined"===typeof e.type)throw new Error(le(8));if(f)throw new Error(le(9));try{f=!0,u=c(u,e)}finally{f=!1}for(var t=h=p,i=0;i<t.length;i++){(0,t[i])()}return e}function s(e){if("function"!==typeof e)throw new Error(le(10));c=e,a({type:Md.REPLACE})}function l(){var e,t=o;return(e={subscribe:function(e){function i(){e.next&&e.next(n())}if("object"!==typeof e||null===e)throw new Error(le(11));return i(),{unsubscribe:t(i)}}})[Nd]=function(){return this},e}var d;if("function"===typeof t&&"function"===typeof i||"function"===typeof i&&"function"===typeof arguments[3])throw new Error(le(0));if("function"===typeof t&&"undefined"===typeof i&&(i=t,t=void 0),"undefined"!==typeof i){if("function"!==typeof i)throw new Error(le(1));return i(ce)(e,t)}if("function"!==typeof e)throw new Error(le(2));var c=e,u=t,h=[],p=h,f=!1;return a({type:Md.INIT}),(d={dispatch:a,subscribe:o,getState:n,replaceReducer:s})[Nd]=l,d}function ue(e){for(var t=Object.keys(e),i={},r=0;r<t.length;r++){var n=t[r];0,"function"===typeof e[n]&&(i[n]=e[n])}var o,a=Object.keys(i);try{!function(e){Object.keys(e).forEach((function(t){var i=e[t];if("undefined"===typeof i(void 0,{type:Md.INIT}))throw new Error(le(12));if("undefined"===typeof i(void 0,{type:Md.PROBE_UNKNOWN_ACTION()}))throw new Error(le(13))}))}(i)}catch(s){o=s}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,n={},s=0;s<a.length;s++){var l=a[s],d=i[l],c=e[l],u=d(c,t);if("undefined"===typeof u){t&&t.type;throw new Error(le(14))}n[l]=u,r=r||u!==c}return(r=r||a.length!==Object.keys(e).length)?n:e}}function he(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function pe(){return(pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function fe(e,t){var i=e.indexOf(t);i>=0&&e.splice(i,1)}function ge(e,t,i){void 0===t&&(t=cc),void 0===i&&(i="iterator");var r={meta:{name:i},next:e,throw:t,return:uc,isSagaIterator:!0};return"undefined"!==typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}function ve(e,t){var i=t.sagaStack;console.error(e),console.error(i)}function me(e,t){var i=Object.keys(e),r=i.length;var n,o=0,a=Zd(e)?hc(r):{},s={};return i.forEach((function(e){var i=function(i,s){n||(s||vc(i)?(t.cancel(),t(i,s)):(a[e]=i,++o===r&&(n=!0,t(a))))};i.cancel=sc,s[e]=i})),t.cancel=function(){n||(n=!0,i.forEach((function(e){return s[e].cancel()})))},s}function Ae(e){return{name:e.name||"anonymous",location:Ee(e)}}function Ee(e){return e[zd]}function ye(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function Se(e,t){void 0===e&&(e=10);var i=new Array(e),r=0,n=0,o=0,a=function(t){i[n]=t,n=(n+1)%e,r++},s=function(){if(0!=r){var t=i[o];return i[o]=null,r--,o=(o+1)%e,t}},l=function(){for(var e=[];r;)e.push(s());return e};return{isEmpty:function(){return 0==r},put:function(s){var d;if(r<e)a(s);else switch(t){case 1:throw new Error("Channel's Buffer overflow!");case 3:i[n]=s,o=n=(n+1)%e;break;case 4:d=2*e,i=l(),r=i.length,n=i.length,o=0,i.length=d,e=d,a(s)}},take:s,flush:l}}function Te(e,t){return void 0===e&&(e="*"),tc(e)?(Xd(t)&&console.warn("take(pattern) takes one argument but two were provided. Consider passing an array for listening to several action types"),Ac("TAKE",{pattern:e})):ic(i=e)&&i[Hd]&&Xd(t)&&tc(t)?Ac("TAKE",{channel:e,pattern:t}):ic(e)?(Xd(t)&&console.warn("take(channel) takes one argument but two were provided. Second argument is ignored."),Ac("TAKE",{channel:e})):void 0;var i}function Re(e,t){return qd(t)&&(t=e,e=void 0),Ac("PUT",{channel:e,action:t})}function Pe(e){var t=Ac("ALL",e);return t.combinator=!0,t}function _e(e,t){var i,r=null;return Qd(e)?i=e:(Zd(e)?(r=e[0],i=e[1]):(r=e.context,i=e.fn),r&&Jd(i)&&Qd(r[i])&&(i=r[i])),{context:r,fn:i,args:t}}function be(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Ac("CALL",_e(e,i))}function Ie(e,t,i){void 0===i&&(i=[]);return Ac("CALL",_e([e,t],i))}function Ce(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Ac("FORK",_e(e,i))}function Oe(e){return void 0===e&&(e=jd),Ac("CANCEL",e)}function we(e){void 0===e&&(e=lc);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Ac("SELECT",{selector:e,args:i})}function ke(){var e={};return e.promise=new Promise((function(t,i){e.resolve=t,e.reject=i})),e}function De(e){try{Me(),e()}finally{Ve()}}function Ne(e){Tc.push(e),Rc||(Me(),xe())}function Le(e){try{return Me(),e()}finally{xe()}}function Me(){Rc++}function Ve(){Rc--}function xe(){var e;for(Ve();!Rc&&void 0!==(e=Tc.shift());)De(e)}function Fe(e){var t="*"===e?Cc:Jd(e)?bc:Zd(e)?Pc:rc(e)?bc:Qd(e)?_c:nc(e)?Ic:null;if(null===t)throw new Error("invalid pattern: "+e);return t(e)}function Ue(e){void 0===e&&(e=mc());var t=!1,i=[];return{take:function(r){t&&e.isEmpty()?r(Oc):e.isEmpty()?(i.push(r),r.cancel=function(){fe(i,r)}):r(e.take())},put:function(r){if(!t){if(0===i.length)return e.put(r);i.shift()(r)}},flush:function(i){t&&e.isEmpty()?i(Oc):i(e.flush())},close:function(){if(!t){t=!0;var e=i;i=[];for(var r=0,n=e.length;r<n;r++){(0,e[r])(Oc)}}}}}function Be(){var e,t,i,r,n,o,a=(t=!1,r=i=[],n=function(){r===i&&(r=i.slice())},o=function(){t=!0;var e=i=r;r=[],e.forEach((function(e){e(Oc)}))},(e={})[Hd]=!0,e.put=function(e){if(!t)if(wc(e))o();else for(var n=i=r,a=0,s=n.length;a<s;a++){var l=n[a];l[Bd](e)&&(l.cancel(),l(e))}},e.take=function(e,i){var o,a;void 0===i&&(i=Cc),t?e(Oc):(e[Bd]=i,n(),r.push(e),e.cancel=(o=function(){n(),fe(r,e)},a=!1,function(){a||(a=!0,o())}))},e.close=o,e),s=a.put;return a.put=function(e){e[Gd]?s(e):Ne((function(){s(e)}))},a}function He(e,t){var i=e[xd];Qd(i)&&(t.cancel=i),e.then(t,(function(e){t(e,!0)}))}function Ge(e){e.isRunning()&&e.cancel()}function je(e,t){return e+"?"+t}function We(e){var t=e.name,i=e.location;return i?t+"  "+je(i.fileName,i.lineNumber):t}function Ye(e){var t,i,r,n=(t=function(e){return e.cancelledTasks},i=e,(r=[]).concat.apply(r,i.map(t)));return n.length?["Tasks cancelled due to error:"].concat(n).join("\n"):""}function Ke(e,t,i,r,n,o,a){function s(t,i){if(i){if(u=2,Vc({meta:n,cancelledTasks:p}),v.isRoot){var r=Fc();xc(),e.onError(t,{sagaStack:r})}c=t,h&&h.reject(t)}else t===Yd?u=1:1!==u&&(u=3),d=t,h&&h.resolve(t);v.cont(t,i),v.joiners.forEach((function(e){e.cb(t,i)})),v.joiners=null}var l;void 0===a&&(a=sc);var d,c,u=0,h=null,p=[],f=Object.create(i),g=function(e,t,i){function r(e){t(),o(),i(e,!0)}function n(t){s.push(t),t.cont=function(n,o){l||(fe(s,t),t.cont=sc,o?r(n):(t===e&&(a=n),s.length||(l=!0,i(a))))}}function o(){l||(l=!0,s.forEach((function(e){e.cont=sc,e.cancel()})),s=[])}var a,s=[],l=!1;return n(e),{addTask:n,cancelAll:o,abort:r,getTasks:function(){return s}}}(t,(function(){p.push.apply(p,g.getTasks().map((function(e){return e.meta.name})))}),s),v=((l={})[Wd]=!0,l.id=r,l.meta=n,l.isRoot=o,l.context=f,l.joiners=[],l.queue=g,l.cancel=function(){0===u&&(u=1,g.cancelAll(),s(Yd,!1))},l.cont=a,l.end=s,l.setContext=function(e){dc(f,e)},l.toPromise=function(){return h||(h=yc(),2===u?h.reject(c):0!==u&&h.resolve(d)),h.promise},l.isRunning=function(){return 0===u},l.isCancelled=function(){return 1===u||0===u&&1===t.status},l.isAborted=function(){return 2===u},l.result=function(){return d},l.error=function(){return c},l);return v}function ze(e,t,i,r,n,o,a){function s(e,i){try{var n;i?(n=t.throw(e),xc()):gc(e)?(c.status=1,s.cancel(),n=Qd(t.return)?t.return(Yd):{done:!0,value:Yd}):n=fc(e)?Qd(t.return)?t.return():{done:!0}:t.next(e),n.done?(1!==c.status&&(c.status=3),c.cont(n.value)):l(n.value,r,s)}catch(o){if(1===c.status)throw o;c.status=2,c.cont(o,!0)}}function l(t,i,r,n){function o(i,n){a||(a=!0,r.cancel=sc,e.sagaMonitor&&(n?e.sagaMonitor.effectRejected(s,i):e.sagaMonitor.effectResolved(s,i)),n&&function(e){Lc=e}(t),r(i,n))}void 0===n&&(n="");var a,s=Dc();e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:s,parentEffectId:i,label:n,effect:t}),o.cancel=sc,r.cancel=function(){a||(a=!0,o.cancel(),o.cancel=sc,e.sagaMonitor&&e.sagaMonitor.effectCancelled(s))},d(t,s,o)}var d=e.finalizeRunEffect((function(t,i,r){if($d(t))He(t,r);else if(ec(t))ze(e,t,u.context,i,n,!1,r);else if(t&&t[Ud]){(0,Nc[t.type])(e,t.payload,r,h)}else r(t)}));s.cancel=sc;var c={meta:n,cancel:function(){0===c.status&&(c.status=1,s(Yd))},status:0},u=Ke(e,c,i,r,n,o,a),h={task:u,digestEffect:l};return a&&(a.cancel=u.cancel),s(),u}function qe(e,t){var i=e.channel,r=void 0===i?Be():i,n=e.dispatch,o=e.getState,a=e.context,s=void 0===a?{}:a,l=e.sagaMonitor,d=e.effectMiddlewares,c=e.onError,u=void 0===c?ve:c;for(var h=arguments.length,p=new Array(h>2?h-2:0),f=2;f<h;f++)p[f-2]=arguments[f];var g=t.apply(void 0,p);var v,m=Dc();if(l&&(l.rootSagaStarted=l.rootSagaStarted||sc,l.effectTriggered=l.effectTriggered||sc,l.effectResolved=l.effectResolved||sc,l.effectRejected=l.effectRejected||sc,l.effectCancelled=l.effectCancelled||sc,l.actionDispatched=l.actionDispatched||sc,l.rootSagaStarted({effectId:m,saga:t,args:p})),d){var A=ye.apply(void 0,d);v=function(e){return function(t,i,r){return A((function(t){return e(t,i,r)}))(t)}}}else v=lc;var E={channel:r,dispatch:pc(n),getState:o,sagaMonitor:l,onError:u,finalizeRunEffect:v};return Le((function(){var e=ze(E,g,s,m,Ae(t),!0,void 0);return l&&l.effectResolved(m,e),e}))}function Xe(e){return ic(e)?"channel":rc(e)?String(e):Qd(e)?e.name:String(e)}function Qe(e,t,i){function r(t,i){if(s===Hc)return Bc(t);if(i&&!o)throw s=Hc,i;n&&n(t);var r=i?e[o](i):e[s]();return s=r.nextState,a=r.effect,n=r.stateUpdater,o=r.errorState,s===Hc?Bc(t):a}var n,o,a,s=t;return ge(r,(function(e){return r(null,e)}),i)}function Je(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];var o,a={done:!1,value:Te(e)},s=function(e){return{done:!1,value:Ce.apply(void 0,[t].concat(r,[e]))}},l=function(e){return o=e};return Qe({q1:function(){return{nextState:"q2",effect:a,stateUpdater:l}},q2:function(){return{nextState:"q1",effect:s(o)}}},"q1","takeEvery("+Xe(e)+", "+t.name+")")}function Ze(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];var o,a,s={done:!1,value:Te(e)},l=function(e){return{done:!1,value:Ce.apply(void 0,[t].concat(r,[e]))}},d=function(e){return{done:!1,value:Oe(e)}},c=function(e){return o=e},u=function(e){return a=e};return Qe({q1:function(){return{nextState:"q2",effect:s,stateUpdater:u}},q2:function(){return o?{nextState:"q3",effect:d(o)}:{nextState:"q1",effect:l(a),stateUpdater:c}},q3:function(){return{nextState:"q1",effect:l(a),stateUpdater:c}}},"q1","takeLatest("+Xe(e)+", "+t.name+")")}function $e(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];var o,a={done:!1,value:Te(e)},s=function(e){return{done:!1,value:be.apply(void 0,[t].concat(r,[e]))}},l=function(e){return o=e};return Qe({q1:function(){return{nextState:"q2",effect:a,stateUpdater:l}},q2:function(){return{nextState:"q1",effect:s(o)}}},"q1","takeLeading("+Xe(e)+", "+t.name+")")}function et(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return Ce.apply(void 0,[Je,e,t].concat(r))}function tt(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return Ce.apply(void 0,[Ze,e,t].concat(r))}function it(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return Ce.apply(void 0,[$e,e,t].concat(r))}function rt(e,t){return e.volume===t.volume&&e.muted===t.muted}function nt(e){return!!Wc[e]}function ot(e,t,i){function r(){var e=t.apply(void 0,arguments);return i?{type:a,payload:e,error:e instanceof Error,meta:i.apply(void 0,arguments)}:{type:a,payload:e,error:e instanceof Error}}function n(){return l(s,!1).apply(void 0,arguments)}"function"===typeof e&&(i=t,t=e,e=void 0),"function"!==typeof t&&(t=zc),"function"!==typeof i&&(i=void 0);var o="string"===typeof e&&/^[0-9A-Z_]+$/.test(e);o?(!function(e){if(Yc.checkExisting&&nt(e))throw new TypeError("Duplicate action type: ".concat(e))}(e),Wc[e]=!0):++Kc;var a=o?e:"[".concat(Kc,"]").concat(e?" "+e:""),s=void 0,l=function(e,t){return function(){var i=r.apply(void 0,arguments);return i.error||(i.error=t),Array.isArray(e)?e.map((function(e){return e(i)})):e?e(i):i}};return n.asError=function(){return l(s,!0).apply(void 0,arguments)},n.getType=function(){return a},n.toString=function(){return a},n.raw=r,n.assignTo=function(e){return s=Xc(e),n},n.assigned=function(){return!!s},n.bound=function(){return!1},n.dispatched=n.assigned,n.bindTo=function(e){var t=l(Xc(e));return t.asError=l(Xc(e)),t.raw=r,t.getType=n.getType,t.toString=n.toString,t.assignTo=function(){return t},t.bindTo=function(){return t},t.assigned=function(){return!1},t.bound=function(){return!0},t.dispatched=t.bound,t},n}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function st(e){return e&&e.getType?e.toString():e}function lt(){function e(e){return!!o[st(e)]}function t(e,i){return Array.isArray(e)?e.forEach((function(e){t(e,i)})):o[st(e)]=i,l}function i(e){return Array.isArray(e)?e.forEach(i):delete o[st(e)],l}function r(e){return Object.keys(e).forEach((function(t){return s[t]=e[t]})),l}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;if(!t||"string"!==typeof t.type)return e;if(t.type.startsWith("@@redux/"))return e;var i=o[t.type]||s.fallback;return i?s.payload?i(e,t.payload,t.meta):i(e,t):e}var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,s={payload:!0,fallback:null},l=at(n,{has:e,on:t,off:i,options:r});if("function"===typeof o){var d=o;o={},d(t,i)}return e(Qc)||t(Qc,(function(e,t){return s.payload?t.reduce(n,e):t.payload.reduce(n,e)})),l}function dt(e){return e&&e.type===Jc?(e.payload.type=Jc,e.payload):e}function ct(e,t){const i=e.height||0;return(t.height||0)-i}function ut(e,t){return{reason:e,details:t,getElapsedTime:H()}}function*ht(e){const{ad:{adInfo:t}}=yield we();t||(yield be([e,e.updateVideoControllerNativeControlsVisibility]))}function*pt(e){const t=function(e){const{ad:{nextAdInfo:t},controller:{videoType:i}}=e;if(void 0!==t&&("postroll"!==t.adBreakType||i===Bh.VOD))return jl(t.remainingTime)}(yield we());yield be(e.callbacks.onNextAdRemainingTimeChange,t)}function ft(e){let{payload:{cueId:t,start:i,end:r}}=e;return function*(){const{ad:{originalBroadcastAdCues:e}}=yield we(),n=jh(e),o=n[t]||{start:i,end:r};void 0!==i&&(o.start=i),void 0!==r&&(o.end=r),n[t]=o,yield Re(su(n))}()}function gt(e){return Boolean(e&&e.adType===Kh.inroll)}function vt(){return(vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function mt(e){Xh.href=e;let t=Xh.pathname||"";"/"!==t.charAt(0)&&(t="/"+t);const i=(Xh.search||"")+(Xh.hash||""),r=e.lastIndexOf(i),n=-1===r?e:e.slice(0,r);if(Qh.test(e)){const t=mt(e.replace(Qh,"https:"));return Xh.href=e,vt({},t,{originalPath:n,protocol:e.slice(0,e.indexOf(":")+1),href:Xh.href})}const o=Xh.protocol&&/^[a-z\-]+:/i.test(Xh.protocol)?Xh.protocol:"";return{originalPath:n,href:Xh.href,protocol:o,host:Xh.host,hostname:Xh.hostname,port:Xh.port,pathname:t,search:Xh.search,hash:Xh.hash}}function At(e,t){if(void 0===t&&(t=!1),t){const t=e.originalPath,i="/"===e.pathname&&"/"!==t[t.length-1];return e.originalPath+(i?"/":"")+e.search+e.hash}const i="443"===e.port||"80"===e.port?e.hostname:e.host;return e.protocol+"//"+i+e.pathname+e.search+e.hash}function Et(e){const t={},i=e.replace(/^[?#]+/,"").replace(/#.*$/,"").split("&");for(let r=0;r<i.length;r++){const e=i[r].indexOf("=");let n,o;if(-1===e?(n=Jh(i[r]),o=""):(n=Jh(i[r].slice(0,e)),o=i[r].slice(e+1)),n){const e=Boolean(/(\[\])$/.exec(n));n=n.replace(/\[\]$/,""),e?void 0===t[n]?t[n]=[Jh(o)]:t[n]=[].concat(t[n],Jh(o)):t[n]=Jh(o)}}return t}function yt(e){const t=[];for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];El(r)?t.push(Zh(i,r)):void 0!==r&&t.push(i+"="+encodeURIComponent(r))}return"?"+t.join("&")}function St(e,t,i){if(void 0===i)return e;const r=mt(e),n=Et(r.search);return n[t]=i,At(vt({},r,{search:yt(n)}))}function Tt(e,t,i){let{override:r=!0,saveOriginalPath:n=!1}=void 0===i?{}:i;const o=mt(e),a=Et(o.search);A(t,(e,t)=>{(void 0===a[t]||r)&&(a[t]=e)});return At(vt({},o,{search:yt(a)}),n)}function Rt(e){return mt(e).pathname.split("/").pop()||""}function Pt(e){const t=Rt(e).split(".");return t.length>1?t.pop():""}function _t(e){const{hostname:t}=mt(e);for(const i of ep)if(t.includes(i))return!0;return!1}function bt(e){const t=function(e){if(!_t(e))return"";const{pathname:t}=mt(e);return t.slice(1).split("/")[1]||""}(e);return{channel:t,metaInfoUrl:"https://strm.yandex.net/kal/"+t+"/break/last?start_ts={{video-timestamp}}"}}function*It(e,t,i){yield Ec(zh);const r=yield we(),{ad:{adInfo:n},controller:{stream:o}}=r,a=function(e){const{controller:{stream:t}}=e;if(t)return void 0!==t.metaInfoUrl?t.metaInfoUrl:_t(t.url)?bt(t.url).metaInfoUrl:void 0}(r);if(!n||!gt(n)||n.params.startTimestamp!==e.params.startTimestamp||!o||!a)return;const{startProgramDateTime:s,startVideoTime:l,startTimestamp:c}=n.params,u=Kl(s,l),h=Kl(u,tp),p=Gl(Math.round(1e3*(u+(Date.now()/1e3-c)))),f=function(e,t,i){return e.replace(new RegExp("{{"+t+"}}","gm"),encodeURIComponent(i))}(a,"video-timestamp",String(p));let g;try{g=yield t({method:"GET",url:f})}catch(y){return i.callbacks.onError(new jc({code:Cs.META_INFO_REQUEST_FAILED,details:{url:f},fatal:!1})),void(yield Re(lu({end:h,cueId:n.params.cueId})))}const v=function(e){try{return d(e)?JSON.parse(e):void 0}catch(t){return}}(g.responseText);if(!I(v))return;const{cutoff:m,cue_id:A}=v;if(A!==n.params.cueId)return;const E=B(m)?Xl(Kl(p,m),1e3):h;yield Re(lu({end:E,cueId:A})),yield It(e,t,i)}function Ct(e,t){let{payload:i}=t;return function*(){const{ad:{adInfo:t}}=yield we();yield Re(nu(i)),t&&i&&t.adType!==i.adType?(yield be(e.callbacks.onAdStateChange,{state:Wh.NOT_PLAYING,type:t.adType,adParams:{}}),yield be(e.callbacks.onAdStateChange,{state:Wh.PLAYING,type:i.adType,adParams:{}})):t&&!i?yield be(e.callbacks.onAdStateChange,{state:Wh.NOT_PLAYING,type:t.adType,adParams:{}}):!t&&i&&(yield be(e.callbacks.onAdStateChange,{state:Wh.PLAYING,type:i.adType,adParams:{}})),void 0!==i&&gt(i)&&(yield It(i,ie,e))}()}function Ot(e,t){const{ad:{originalBroadcastAdCues:i}}=e,r=i[t];if(r){const{start:e}=r;if(void 0===e)return;const{end:t=e+np}=r;return{start:jl(e),end:jl(t)}}}function wt(e){const{ad:{originalBroadcastAdCues:t,adInfo:i}}=e;return gt(i)?i.params.cueId:v(t).find(t=>function(e,t){const{controller:{currentTime:i,programDateTime:r}}=e;if(void 0===r)return!1;const n=r/1e3+i,o=Ot(e,t);if(!o)return!1;const{start:a,end:s}=o;return a<=n&&n<=s}(e,t))}function*kt(e){const t=yield we(),{ad:{adInfo:i,originalBroadcastAdCueId:r},controller:{watchedTime:n}}=t,o=wt(t);if(o&&gt(i)){const r=Ot(t,o);if(r){const{startProgramDateTime:t,startVideoTime:n,startTimestamp:o}=i.params,a=r.end+ip,s=zl(Xl(Date.now(),1e3),o),l=Kl(t,n);if(a<Kl(s,l)){const t={utc:Kl(l,s),videoTime:B(n)?Kl(n,s):void 0};return void e.stopAd({stopAdReason:rp.CutOff,data:{loadPositionAfterAd:t}})}}}if(o===r)return;yield Re(ou(o));let a;void 0!==o?op=n:a=zl(n,op),yield be(e.callbacks.onOriginalBroadcastAdStateChange,{cueId:o,originalBroadcastAdDuration:a})}function Dt(e){let{controller:{playerConfig:t}}=e;return Boolean((null==t?void 0:t.isDelayUntilNextEpisodeEnabled)&&(null==t?void 0:t.episodes)&&t.episodes.length>0)}function Nt(e,t){var i;let{controller:{playerConfig:r,currentTimeLowGranularity:n}}=e;const o=Math.ceil((t||0)+n),a=null==r||null==(i=r.episodes)||null==(i=i.find(e=>{let{timeStartInSeconds:t}=e;const i=Number(t);return 0!==i&&i-o>=0&&i-o<=Number(r.maxDelayUntilNextEpisode||0)}))?void 0:i.timeStartInSeconds;return void 0!==a?Number(a):a}function Lt(){return(Lt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function*Mt(e){const t=yield we(),{controller:{currentTimeLowGranularity:i,duration:r,videoType:n,watchedTime:o},ad:{adConfig:a,delayedNextAdInfo:s,delayedMidrollAdViewers:l,delayedAdStartPosition:d,delayedAdStartWatchedTime:c}}=t;if(isNaN(r))return;if(!e.shouldPlayAd())return;const u=e.getMultiroll(),h={watchedTime:o,sourceWatchedTime:o,currentTime:i,duration:r,videoType:n||Bh.VOD},p=yield u.midroll.loadViewers(h),f=u.getNextAdInfo(h),g=yield we(Dt),v=d&&i<=d,m=c&&o<=c;if(g&&!v&&!m&&void 0!==f&&void 0===l){const e=yield we(Nt,null==f?void 0:f.remainingTime);yield Re(Eu(e))}const A=void 0!==l&&void 0!==s;if(g&&A&&d&&d-i<=5&&(yield Re(yu(o+(v?d-i:5))),yield Re(Eu(void 0))),r-i<=20)return yield Re(vu(void 0)),void(yield Re(Su()));g&&A&&(d||c)&&(d&&v?yield Re(vu(Lt({},s,{remainingTime:d-i}))):c&&m&&(yield Re(vu(Lt({},s,{remainingTime:c-o}))))),g&&(d||c)?void 0!==f&&(yield Re(mu(f))):yield Re(vu(f));if(g&&void 0!==l&&((d||c)&&(i===d||!!c&&o>=c)))return yield e.playAdViewers(Kh.midroll,$(l,Kh.midroll),{},a,!0),void(yield Re(Su()));p.length<=0||(g&&(v||m)?yield Re(Au(p)):yield e.playAdViewers(Kh.midroll,$(p,Kh.midroll),{},a))}async function Vt(e){await fetch(e,{method:"GET",mode:"no-cors",credentials:"omit",signal:AbortSignal.timeout(ap)})}function xt(){return(xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Ft(e){const t=lp[e];if(t)return t;sp.href=e;let i=sp.pathname||"";"/"!==i.charAt(0)&&(i="/"+i);const r={href:sp.href,protocol:sp.protocol,host:sp.host,hostname:sp.hostname,port:sp.port,pathname:i,search:sp.search,hash:sp.hash,baseDomain:(sp.hostname||"").split(".").slice(-2).join(".")};return lp[e]=r,xt({},r)}function Ut(e,t,i){if(void 0===t)return e;if(void 0===i)return e;const r=encodeURIComponent(t)+"="+encodeURIComponent(i);return sp.href=e,sp.search=sp.search?sp.search+"&"+r:"?"+r,sp.href}function Bt(e,t,i){if(void 0===t)return e;if(void 0===i)return e;const r=encodeURIComponent(t)+"="+encodeURIComponent(i);return sp.href=e,sp.hash=sp.hash?sp.hash+"&"+r:"#"+r,sp.href}function Ht(e,t,i){return e=function(e,t){if(!e.includes("#"))return e;sp.href=e;const i=jt(sp.hash.slice(1),t);return sp.hash=i?"#"+i:"",sp.href}(e,t),void 0===i?e:Bt(e,t,i)}function Gt(e,t){if(!e.includes("?"))return e;sp.href=e;const i=jt(sp.search.slice(1),t);return sp.search=i?"?"+i:"",sp.href}function jt(e,t){return e.split("&").filter(e=>e!==t&&0!==e.indexOf(t+"=")).join("&")}function Wt(e){if(!_t(e))return;const{protocol:t,host:i}=Ft(e);return t+"//"+i+"/"+dp(i)}function Yt(e,t){const i=e.getRecoverHelper();i&&i.planTask(()=>e.recoverStream(),t)}function Kt(e,t){return void 0===t&&(t=cp),function*(){const i=yield we(),{controller:{stream:r}}=i;if(!r)return;const n=function(e){const t=Wt(e);if(!t)return;return St(t,"r",""+Date.now()+Math.round(1e3*Math.random()))}(r.url);if(!n)return;let o=!1;for(;!1===o;){yield be(()=>Zl(t).promise);try{yield be(Vt,n),o=!0}catch(a){}}yield Re(Wu(!0)),yield Yt(e,up)}()}function*zt(e){const t=yield we(),{skin:{hiddenControls:i}}=t;yield be([e,e.setHiddenControls],i)}function*qt(e){const{controller:{autoplay:i}}=yield we();i&&(yield Pe([Re(Ru(!1)),be(()=>t(e.play()))]))}function Xt(e){try{return JSON.stringify(e,function(){const e=[],t=function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(i,r)=>{if(void 0!==e)try{e.set(i,r)}catch(n){t.push({path:r,value:i})}else t.push({path:r,value:i})},get:i=>{const r=sl(t,e=>e.value===i);return void 0!==e&&void 0===r?e.get(i):r?r.path:void 0}}}();return(i,r)=>{if(n(r))return d(r.name)?r.name:"[Function]";if(!I(r))return r;if(o=r,"[object Window]"===Object.prototype.toString.call(o))return"[object Window]";var o;if(function(e){return d(e.tagName)}(r))return"[DOMNode "+r.tagName+"]";const a=t.get(r);if(a)return"[Circular "+a+"]";for(;e.length>0&&e[e.length-1].value[i]!==r;)e.pop();const s=(e.length>0?e[e.length-1].path:"")+(i?"/"+i:"~");return e.push({path:s,value:r}),t.set(r,s),r}}())}catch({message:t,stack:i}){return JSON.stringify({__stringifyError:{message:t,stack:i}})}}function Qt(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=t.map(Jt),n="YA PLAYER: "+(new Date).toString()+" "+r.join(" ");return n}function Jt(e){return e&&"object"===typeof e?JSON.stringify(e,Object.getOwnPropertyNames(e)):e}function Zt(e,t){let{name:i,lang:r}=t;const n=e.find(e=>e.name===i);return n||(r?e.find(e=>e.lang===r):void 0)}function*$t(e){const{controller:{textTrackValue:t,textTracks:i,userTextTrackName:r,userTextTrackLang:n}}=yield we();if(t)return void(yield be([e,e.setTextTrack],t));const o=Zt(i,{name:r,lang:n})||function(e){if(0===e.length)return;const t=function(e,t){if("string"!==typeof t)return;const i=t.split("-")[0].toLowerCase();for(let r=0;r<e.length;r++){const t=e[r];if(t.name.toLowerCase()===i)return t}}(e,navigator.language);return void 0!==t?t:e[0]}(i);void 0===o?pp.error("No text tracks to enable"):yield be([e,e.setTextTrack],o.value)}function ei(e){return void 0!==e.ad.adInfo}function ti(e,t){let{payload:i}=t;return function*(){const{controller:{playingState:t,watchedTime:r}}=yield we();if(t===i||t===$l.END&&i===$l.PAUSE)return;if(i===$l.BUFFERING)return void(yield Re(Lu($l.BUFFERING)));if(t===$l.BUFFERING&&i===$l.PAUSE&&0===r||(yield Re(Pu(Vh.started))),i!==$l.END)return void(yield Re(Lu(i)));const n=yield we(),{ad:{adInfo:o}}=n;ei(n)?pp.log("putPlayingState("+$l.END+") has not been dispatched because ad("+(o&&o.adType)+") is playing"):yield function*(e){if(!e.shouldPlayAd())return;const t=e.getMultiroll(),i=yield t.postroll.loadViewers({});i.length>0&&(yield e.playAdViewers(Kh.postroll,$(i,Kh.postroll),{},{})),yield Re(Lu($l.END)),e.stop()}(e)}()}function ii(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onAdblockDetected,i)}()}function ri(e,t){let{payload:i}=t;return function*(){yield Ie(e,e.callbacks.onAudioTracksChange,[i])}()}function ni(e){const{audioTrackValue:t,audioTracks:i}=e.controller;return i.find(e=>{let{value:i}=e;return i===t})}function*oi(e,t){const i=yield we();yield be(e.callbacks.onAudioTrackChange,ni(i))}function ai(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onBufferingRangesChange,i)}()}function si(e){return jl("number"!==typeof(t=Math.floor(2*e)/2)||isNaN(t)||!isFinite(t)?0:t);var t}function li(e){const{controller:{currentTime:t,bufferingRanges:i},skin:{skinDVRStartTime:r,skinDVRDuration:n}}=e;if(0===i.length)return!1;return n===1/0||t>r+n-fp}function di(e){const{controller:{videoType:t}}=e;return t!==Bh.VOD&&li(e)}function*ci(e){const t=yield we(),{controller:{videoType:i,playbackRate:r,encoderState:n}}=t;i!==Bh.VOD&&n===xh.Attached&&(ei(t)||(r>1.03?li(t)&&e.setPlaybackRate(1):!function(e){const{controller:{currentTime:t,dvrStartTime:i,dvrDuration:r}}=e;return t<i||t>i+r}(t)&&function(e){const{controller:{videoType:t}}=e;if(t!==Bh.LIVE)return!1;const{controller:{currentTime:i},skin:{skinDVRStartTime:r}}=e;return r+(0===i?0:fp)>i}(t)&&e.setPlaybackRate(1)))}function ui(e){let{ad:{adInfo:t}}=e;return void 0!==t&&mp.includes(t.adType)}function*hi(){const{controller:{currentTime:e,playingState:t,watchedTime:i,playbackRate:r,sourceId:n}}=yield we();if(Ep!==n&&(Ap=void 0,Ep=n),void 0!==Ap){const t=function(e,t){const i=e>=0&&e<=t+.5?e:t;return jl(Math.max(0,i))}(Xl(zl(e,Ap.videoTime),r),Xl(Gl(Ap.getElapsedTime()),1e3));yield Re(Sh(Kl(i,t)))}const o=yield we(ui);Ap=t!==$l.PLAY||o?void 0:{getElapsedTime:H(),videoTime:e}}function pi(e,t){let{payload:i}=t;return function*(){yield hi(),yield ci(e),yield Ie(e,e.callbacks.onCurrentTimeChange,[i]),yield Re(Vu(si(i)))}()}function*fi(){const{controller:{encoderState:e}}=yield we();e===xh.Attached&&(yield Re(Iu()))}function*gi(e,t){const{error:i}=t.payload;if(void 0===i)return;const{code:r,isFatal:n,details:o}=i;n?(pp.error(r,o),yield be(e.setFullscreen,!1)):pp.warn(r,o),yield be(e.callbacks.onError,i)}function vi(e){let{payload:t}=e;return function*(){const{controller:{videoTrackValue:e}}=yield we();yield Re(rh({videoTrackValue:e,isAbrEnabled:t}))}()}function mi(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onFullScreenChange,i)}()}function Ai(e,t){let{payload:i}=t;return function*(){const{controller:{isOnline:t}}=yield we();t?yp.includes(i.source)&&(yield be(e.callbacks.onBandwidthEstimateChange,i)):yield be(e.callbacks.onBandwidthEstimateChange,{value:Ul(0),source:"default"})}()}function Ei(e,t){let{payload:i}=t;return function*(){i||(yield Ai(e,{payload:{value:Ul(0),source:"default"}})),yield be(e.callbacks.onNetworkStatusChange,{isOnline:i})}()}function yi(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onPlaybackRateChange,i)}()}function Si(e,t){const i=[],r=[];return((e,t,i)=>{for(let r=0;r<e.length;r++)t.call(i,e[r],r,e)})(e,(n,o)=>{t(n,o,e)?i.push(n):r.push(n)}),[i,r]}function Ti(e){return"https://"+e+"/"+dp(e)+"?r="+function(e){let t="";for(let i=0;i<e;i++)t+=(16*Ol()|0).toString(16);return t}(12)}function Ri(e){return Ti(Ft(e).hostname)}function Pi(e){return e.map(e=>e&&e.name||"").filter(e=>{return Tp.includes(Pt(e))&&(t=mt(e).hostname,(i=_p)===t.substring(t.length-i.length));var t,i})}function _i(e,t,i){return void 0===i&&(i=0),sl(e,e=>{let{start:r,end:n}=e;return r-i<=t&&t<=n+i})}function bi(e,t){const i=_i(e,t);return void 0===i?void 0:zl(i.end,t)}function Ii(e){const{currentTime:t,bufferingRanges:i}=e.controller;return bi(i,t)}function*Ci(e){const t=yield we(),{bufferingRanges:i,stream:r}=t.controller;if(0===i.length)return;if(!function(e){return(Ii(e)||0)<bp}(t))return;if(e.getConnectionQuality()!==Sp.OK)return;if(ei(t))return;if(!r)return;const n=Wt(r.url);if(!n)return;const{resourceTimings:o}=e.getSyncDebugInfo(),a=function(e){const t=Pi(e);if(0===t.length)return[];const[i,r]=Si(t,e=>Rt(e).includes("audio")),n=r[r.length-1],o=i[i.length-1],a=[];return n&&a.push(Ri(n)),o&&a.push(Ri(o)),a}(o),{controller:{isOnline:s}}=yield we();if(!s)return;const l=St(n,"r",Date.now().toString()),d=a.map(e=>St(e,"r",Date.now().toString()));if(a.length<=0)return;const c=Vt(l),u={reason:"ChunkServerIsNotAvailable",delay:new Promise(e=>{c.then(()=>{Promise.all(d.map(Vt)).catch(e)}).catch(Q)}),rawData:0};yield Yt(e,u)}function*Oi(e){const{controller:{playingState:t},ad:{inStreamPlayingState:i}}=yield we();t===$l.BUFFERING&&(yield Ci(e),yield function*(e){const t=yield we(),{controller:{isOnline:i}}=t;if(!i){const t={reason:"recoverStreamIfIsOffline",delay:0,rawData:0};yield Yt(e,t)}}(e)),yield hi(),void 0===i||i===$l.END?yield be(e.callbacks.onStateChange,t):yield be(e.callbacks.onStateChange,i)}function wi(e,t){let{payload:i}=t;return function*(){if(!i)return;yield be(e.callbacks.onResourcesIdle),e.callbacks.logEvent({event:Cp.ResourcesIdle,params:{}}),yield Ec(5e3);const t=(0,Ip.getGpu)();e.callbacks.logEvent({event:Cp.ClientInfo,params:{gpu:{renderer:t.renderer,vendor:t.vendor}}})}()}function ki(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onStartStageChange,i)}()}function Di(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onChangeStream,i)}()}function Ni(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onStreamsWithSupportInfoChange,i)}()}function Li(e,t){let{payload:i}=t;return function*(){yield Ie(e,e.callbacks.onTextTracksChange,[i])}()}function Mi(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onVideoSizeChange,i)}()}function Vi(){return(Vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function xi(e){const{videoTrackValue:t,videoTracks:i,isAbrEnabled:r}=e.controller,n=i.find(e=>{let{value:i}=e;return i===t});if(n)return Vi({},n,{auto:r})}function*Fi(e,t){yield Ec(0),yield be(e.callbacks.onVideoTrackChange,yield we(xi))}function Ui(e,t){let{payload:i}=t;return function*(){yield Ie(e,e.callbacks.onVideoTracksChange,[i])}()}function Bi(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onVideoTypeChange,i)}()}function Hi(e,t){let{payload:{volume:i,muted:r,changeReason:n}}=t;return function*(){yield be(e.callbacks.onVolumeChange,{volume:i,muted:r,changeReason:n})}()}function*Gi(e){const t=yield we(),{skin:{nativeControlsVisibility:i},controller:{textTrackEnabled:r,nativeTextTrackVisible:n,isPip:o}}=t,a=void 0===n||n||o||Boolean(i&&r);yield be([e,e.toggleNativeSubtitles],a)}function ji(e,t,i){void 0===i&&(i=wp());let r=t;return function*(){var t;if(0===arguments.length)return;const{payload:n}=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],o=i(n,r)||Number.isNaN(n)&&Number.isNaN(r);o||(r=n,yield*e(...arguments))}}function*Wi(e){const{controller:{duration:t,playingState:i,watchedTime:r}}=yield we();if(isNaN(t)||0===r||i!==$l.PAUSE)return;if(!e.shouldPlayAd())return;if(yield we(ei))return;const n=H();for(;;){const t=jl(n()/1e3),i=yield e.getMultiroll().postPauseroll.loadViewers({pausedTime:t});if(0!==i.length)return void e.planAdViewers($(i,Kh.postPauseroll));yield Ec(kp)}}function Yi(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onHideControls,i)}()}function Ki(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onShowSkipAdButton,i)}()}function zi(e,t){let{payload:i}=t;return function*(){yield be(e.callbacks.onShowAdSkin,i)}()}function qi(e,t){const i=function(e,t){let{controller:{volume:i,muted:r,isAbrEnabled:n,videoTrackValue:o}}=t;return[et(Cu,ji(Hi,{volume:i,muted:r},rt),e),et(Cu,ji(zt,{volume:i,muted:r},rt),e),et(Lu,ji(zt),e),et(vh,ji(zt),e),et(Nu,ji(Bi),e),et(Oh,ti,e),et(Lu,ji(Oi,Uh.playingState),e),et(gu,ji(Oi,Dh.inStreamPlayingState),e),et(Mu,ji(pi),e),et(bu,fi),et(Iu,qt,e),et(Fu,ji(Di),e),et(Gu,ji(Ni),e),et(Wu,ji(Ei),e),et(ih,ji(vi,n)),et(rh,ji(Fi,{videoTrackValue:o,isAbrEnabled:n}),e),et(nh,ji(Ui),e),et(ah,ji(oi),e),et(sh,ji(ri),e),et(dh,ji(Li),e),et(gh,$t,e),et(vh,ji(mi),e),et($u,gi,e),et(au,ji(ii),e),et(Ph,ji(Yi),e),et(_h,ji(Ki),e),et(bh,ji(zi),e),et(Zu,ji(ai),e),et(Pu,ji(ki),e),et(Ju,yi,e),et(Du,ji(Mi),e),et(fu,ji(Ai),e),et(ch,Gi,e),et(mh,Gi,e),et(uh,Gi,e),et(vh,ji(Gi),e),it([Sh,Lu],Mt,e),tt(Lu,Wi,e),et(lu,ft),et(hu,kt,e),et(su,kt,e),et(ru,ji(Ct),e),et(nu,ji(ht),e),et(vu,ji(pt),e),et(Th,ji(wi),e),it(tu,Kt,e)]}(e,t);return function*(){yield Pe(i)}}function Xi(){return(Xi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Qi(e,t,i){return function(e,t){return e===t||!(!Number.isNaN(e)||!Number.isNaN(t))}(e[t],i)?e:Xi({},e,{[t]:i})}function Ji(e){return function(t,i){return Qi(t,e,i)}}function Zi(){return(Zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function $i(e,t){return v(t).reduce((e,i)=>Qi(e,i,t[i]),e)}function er(){return(er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function tr(e){return ue({controller:(r=e.controller,lt({},r).on(Tu,Ji("engine")).on(Yu,Ji("fragmentDuration")).on(zu,Ji("dvrStartTime")).on(qu,Ji("dvrDuration")).on(Pu,Ji("startStage")).on(Ku,Ji("programDateTime")).on(fu,Ji("lastKnownBandwidthEstimate")).on(Cu,$i).on(Ou,Ji("autoplayImpossible")).on(wu,Ji("userVolume")).on(ku,Ji("duration")).on(Du,$i).on(Nu,Ji("videoType")).on(Ru,Ji("autoplay")).on(_u,Ji("preload")).on(Lu,Ji("playingState")).on(Mu,Ji("currentTime")).on(Vu,Ji("currentTimeLowGranularity")).on(xu,Ji("from")).on(Fu,Ji("stream")).on(Uu,Ji("sourceParams")).on(Bu,e=>er({},e,{sourceId:e.sourceId+1})).on(Hu,Ji("streams")).on(Gu,Ji("streamsWithSupportInfo")).on(ju,Ji("startPosition")).on(Zu,Ji("bufferingRanges")).on(bu,Ji("encoderState")).on(th,(e,t)=>Qi(Qi(e,"isAbrEnabled",e.isAbrEnabled&&t),"isAbrSupported",t)).on(ih,(e,t)=>Qi(e,"isAbrEnabled",t&&e.isAbrSupported)).on(rh,(e,t)=>{let{videoTrackValue:i,isAbrEnabled:r}=t;return $i(e,{videoTrackValue:i,isAbrEnabled:r&&e.isAbrSupported})}).on(oh,(e,t)=>{let{name:i,height:r}=t;return $i(e,{userVideoTrackName:i,userVideoTrackHeight:r})}).on(nh,Ji("videoTracks")).on(ah,Ji("audioTrackValue")).on(sh,Ji("audioTracks")).on(lh,(e,t)=>{let{name:i,lang:r}=t;return Qi(Qi(e,"userAudioTrackName",i),"userAudioTrackLang",r)}).on(ch,Ji("textTrackEnabled")).on(uh,Ji("nativeTextTrackVisible")).on(hh,Ji("feed")).on(ph,Ji("textTrackValue")).on(dh,Ji("textTracks")).on(fh,(e,t)=>{let{enabled:i,name:r,lang:n}=t;return $i(e,{userTextTrackEnabled:i,userTextTrackName:r,userTextTrackLang:n})}).on(vh,Ji("isFullscreen")).on(mh,Ji("isPip")).on(Ah,Ji("isVisible")).on(Eh,Ji("isDocumentVisible")).on($u,(e,t)=>!t||function(e){return!v(e).length}(t)||t.error&&t.error.isFatal?er({},e,{errorInfo:t}):e).on(eh,Ji("lastRecoverPosition")).on(Wu,Ji("isOnline")).on(yh,Ji("preview")).on(Sh,Ji("watchedTime")).on(Ju,Ji("playbackRate")).on(Ch,Ji("videoElementStyle")).on(wh,Ji("preloadDetails")).on(kh,(e,t)=>er({},e,{playerConfig:e.playerConfig?er({},e.playerConfig,{episodes:t}):e.playerConfig}))),ad:(i=e.ad,lt({},i).on(gu,Ji("inStreamPlayingState")).on(iu,Ji("adConfig")).on(nu,Ji("adInfo")).on(vu,Ji("nextAdInfo")).on(mu,Ji("delayedNextAdInfo")).on(Au,Ji("delayedMidrollAdViewers")).on(Eu,Ji("delayedAdStartPosition")).on(yu,Ji("delayedAdStartWatchedTime")).on(ou,Ji("originalBroadcastAdCueId")).on(su,Ji("originalBroadcastAdCues")).on(au,Ji("adblockDetected")).on(cu,Ji("hasPreroll")).on(uu,Ji("adSyncInit")).on(pu,Ji("nativeAdControlsVisibility")).on(Su,e=>Zi({},e,{delayedAdStartPosition:void 0,delayedAdStartWatchedTime:void 0,delayedMidrollAdViewers:void 0,delayedNextAdInfo:void 0})).on(du,(e,t)=>{const i=jh(e.originalBroadcastAdCues);return delete i[t],Zi({},e,{originalBroadcastAdCues:i})})),skin:(t=e.skin,lt({},t).on(Rh,Ji("hiddenControls")).on(Ph,Ji("hideControls")).on(_h,Ji("showSkipAdButton")).on(bh,Ji("showAdSkin")).on(Ih,Ji("nativeControlsVisibility")).on(Xu,Ji("skinDVRStartTime")).on(Qu,Ji("skinDVRDuration")).on(Dp,Ji("useNativeSubtitles")))});var t,i,r}function ir(e,t){const i=Uc(),r=function(e){let t=null;return he(e,(0,Np.a)(e=>{t||(t=Promise.resolve().then(()=>{t=null,e()}))}))}((window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||he)(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return function(){var i=e.apply(void 0,arguments),r=function(){throw new Error(le(15))},n={getState:i.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(n)}));return r=he.apply(void 0,o)(i.dispatch),se(se({},i),{},{dispatch:r})}}}(i))),n=ce(tr(t),r),o=qi(e,t);return i.run((function*(){for(;;)try{yield be(o)}catch(t){0,e.callbacks.onError(new jc(t,{code:Cs.SAGA_ERROR,isFatal:!1}))}})),n}function rr(e){const{textTrackValue:t,textTracks:i}=e.controller;return i.find(e=>{let{value:i}=e;return i===t})}function nr(e){let{controller:{videoType:t,currentTime:i},skin:{skinDVRStartTime:r,skinDVRDuration:n}}=e;return function(e){let{videoType:t,currentTime:i,dvrStartTime:r,dvrDuration:n}=e;return void 0===t||t===Bh.VOD?Mp:n===1/0||i>r+n-fp?xp:t!==Bh.LIVE?Mp:r+(0===i?0:10)>i?Vp:Mp}({videoType:t,currentTime:i,dvrStartTime:r,dvrDuration:n})}function or(e){return(t=e.supportInfo).supported&&void 0!==t.engine;var t}function ar(e){return!(t=e.supportInfo).supported&&void 0!==t.noSupportReason;var t}function sr(){return(sr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function lr(e){const t=function(e){return e.filter(ar).map(e=>{let{supportInfo:t}=e;return t.noSupportReason})}(e),i={details:{streams:e},isFatal:!0};if(Zp(t,e=>e===rf.INVALID_STREAM_URL))return new jc(sr({},i,{code:Cs.INVALID_STREAM_URL}));if(Zp(t,e=>e===rf.NO_SUPPORTED_DRM))return new jc(sr({},i,{code:Cs.NO_DRM}));if(Zp(t,e=>e===rf.NO_CODECS))return new jc(sr({},i,{code:Cs.NO_CODECS}));const r=Zp(t,e=>e===rf.NO_MSE);return new jc(sr({},i,r?tf?{code:Cs.NO_PLAYABLE_STREAMS}:{code:Cs.NO_MSE}:{code:Cs.NO_PLAYABLE_STREAMS}))}function dr(e,t){void 0===t&&(t=df);const{hostname:i}=mt(e),r=function(e){const{hostname:t}=mt(e),i=t.split(".");return i.length<=2?t:i.slice(-2).join(".")}(e),n=t.includes(i)||t.includes(r);return n}function cr(e){return e.preferNative||Af||sd?Qp.NATIVE:Qp.HLS}function ur(e,t){return-1!==function(e,t,i,r){void 0===i&&(i=0);void 0===r&&(r=Tf);for(let n=i;n<e.length;n++)if(r(e[n],t))return n;return-1}(e,t)}function hr(e){const t=Object.values;if("function"===typeof t)return t(e);{const t=[];for(const i in e)g(e,i)&&t.push(e[i]);return t}}function pr(e,t){void 0===t&&(t=window);const i=o(t),r=new RegExp("\\b"+e+"/((?:\\d+)(?:\\.\\d+)*)\\b","i"),n=i.match(r);if(n)return n[1].split(".").map(e=>parseInt(e,10))}function fr(){return(fr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function gr(e){if(!ff(e))return!1;const t=Y(e);if(t&&function(e){void 0===e&&(e=window);return/YandexSearch|YaSearchBrowser|YaApp_iOS|YaApp_Android/i.test(o(e))}(e))return!1;const i=function(e){return pr("YaBrowser",e)}(e);if(void 0===i)return!1;const[r,n,a,s]=i;if(r<18)return!0;if(18===r){if(n>4)return!1;if(t&&a<3)return!0;if(X(e)&&(a<1||!s||s<=526))return!0}return!1}async function vr(){const e=[],t=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]}];return await Promise.all(Of.map(async i=>{try{await window.navigator.requestMediaKeySystemAccess(i,t),e.push(i)}catch(r){}})),e}function mr(){const e=[];return Of.forEach(t=>{window.MSMediaKeys.isTypeSupported(t)&&e.push(t)}),e}function Ar(e){let{video:t}=e;const i=[];return Of.forEach(e=>{t.canPlayType("video/mp4",e)&&i.push(e)}),i}function Er(){const e=[];return[If,Cf].forEach(t=>{window.WebKitMediaKeys.isTypeSupported(t,"video/mp4")&&e.push(t)}),e}async function yr(e){void 0===wf&&(wf=async function(e){return _f&&!(Pf||Rf||gf)?{supportedDrmSystems:[],detectionMethod:kf.YandexBrowserLinux}:gr()?{supportedDrmSystems:[],detectionMethod:kf.OldYandexBrowser}:window.WebKitMediaKeys?{supportedDrmSystems:Er(),detectionMethod:kf.WebKitMediaKeys}:"function"===typeof window.navigator.requestMediaKeySystemAccess?{supportedDrmSystems:await vr(),detectionMethod:kf.requestMediaKeySystemAccess}:"function"===typeof window.MSMediaKeys?{supportedDrmSystems:mr(),detectionMethod:kf.MSMediaKeys}:e.video.webkitGenerateKeyRequest?{supportedDrmSystems:Ar(e),detectionMethod:kf.GenerateKeyRequest}:{supportedDrmSystems:[],detectionMethod:kf.NotAvailable}}(e));const t=await wf;return fr({},t,{supportedDrmSystems:[...t.supportedDrmSystems]})}function Sr(){return Vf.canPlayType('video/mp4;codecs="avc1.4D481F"')?{supported:!0,engine:Qp.MP4}:of}async function Tr(e){const{stream:t,video:i,preferNative:r}=e,{drmConfig:n,url:o}=t;if(!(e=>function(e){const t=e.trim();return"//"===t.substr(0,2)||"http://"===t.substr(0,7)||"https://"===t.substr(0,8)}(e)&&dr(e))(o))return lf;const a=(e=>"mpd"===Pt(e.toLocaleLowerCase()))(o),s=(e=>"m3u8"===Pt(e.toLocaleLowerCase()))(o);if((e=>"mp4"===Pt(e.toLocaleLowerCase()))(o)||cf(o))return Sr();if(!a&&!s)return sf;const l=a?Ff||(Ff=await mf().then(()=>xf).catch(()=>nf)):await async function(e){try{0,void 0===Sf&&(Sf=await mf());return Sf.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')?tf?{supported:!0,engine:cr(e)}:yf:tf?Ef:of}catch(t){return tf?Ef:nf}}({stream:t,preferNative:r});if(!l.supported)return l;if(void 0===n||!I(n))return l;return await async function(e,t){const{servers:i={}}=e,r=v(i);if(0===r.length)return!1;const n=await Mf({video:t});return Zp(r,e=>ur(n,e))}(n,i)?l:af}function Rr(e){const{mpd:t,m3u8:i,mss:r}=function(e){return{mpd:e.filter(e=>{let{stream:t}=e;return"mpd"===Pt(t.url)}),m3u8:e.filter(e=>{let{stream:t}=e;return"m3u8"===Pt(t.url)}),mss:e.filter(e=>{let{stream:t}=e;return!["mpd","m3u8"].includes(Pt(t.url))})}}(e),n=[...t,...r,...i];return n.find(e=>{let{stream:t}=e;return I(t.drmConfig)})||n[0]}function Pr(e){const t=e.filter(or);if(0===t.length)return;if(Bf.isSmartTV())return Rr(t);const i=t.find(e=>{let{stream:t}=e;return void 0!==t.drmConfig&&I(t.drmConfig)});if(i)return i;const r=t.find(e=>{let{supportInfo:t}=e;return t.engine===Qp.NATIVE}),n=t.find(e=>{let{supportInfo:t}=e;return t.engine===Qp.MPD}),o=Hf>=15&&!Gf&&!((gd||jf)&&(e=>{let t=!1;e&&(t=Zp(ep,t=>e.startsWith("https://"+t+"/live/")||e.startsWith("https://"+t+"/kal/")));return t})(null==n?void 0:n.stream.url));if(sd&&!o&&r)return r;if(n)return n;const a=t.find(e=>{let{supportInfo:t}=e;return t.engine!==Qp.MP4});return a||t[0]}async function _r(e){if(0===e.streams.length)return{status:"error",error:new jc({code:Cs.NO_STREAMS,details:{},isFatal:!0}),streamsWithSupportInfo:[]};const t=await function(e){let{streams:t,video:i,preferNative:r}=e;return Promise.all(t.map(async e=>({stream:e,supportInfo:await Tr({stream:e,video:i,preferNative:r})})))}(e),i=Pr(t);return i?{status:"success",supportedStream:i,streamsWithSupportInfo:t}:{status:"error",error:lr(t),streamsWithSupportInfo:t}}function br(e,t){for(let i=0;i<e.length;++i){const{start:r,end:n}=e[i];if(r<=Kl(t,jl(.1))&&t<=n)return jl(Math.max(n-t,0))}return jl(0)}function Ir(e,t){return{total:br(e.total,t),audio:br(e.audio,t),video:br(e.video,t)}}function Cr(e){return St(e,"t",String(Date.now()))}async function Or(e,t){const i=Wt(e);return async function(e,t){try{return await ie({url:e,withCredentials:t,method:"GET",checkStatus:e=>0!==e,retries:3}),!1}catch(i){return!0}}(i||St(Cr(e),"abd","1"),!d(i)&&t)}function wr(){return(wr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function kr(e){const{additionalParams:t=Bp}=e;if(!I(e.adConfig))return;const{partnerId:i,adBreaks:r}=e.adConfig;return i||r?wr({},e.adConfig,{additionalParams:t}):void 0}function Dr(e){const t=mt(e),i=Et(t.search),r=(()=>{const e=void 0!==i.start,t=void 0!==i.end;return e||t?"?"+(e?"start="+i.start:"")+(t?(e?"&":"")+"end="+i.end:""):""})();return t.originalPath+r}function Nr(e,t){return t&&"boolean"===typeof t.withCredentials?t.withCredentials:!!_t(e.url)||Hp.withCredentials}function Lr(e){const{stream:t,sourceParams:i}=e,r=mt(t.url),n=Et(r.search);return JSON.stringify([r.pathname,n.start,n.end,null==i?void 0:i.startPosition])}function Mr(e){void 0===e&&(e=window);try{return I(e.sessionStorage)}catch(t){return!1}}function Vr(e){return e[0]}function xr(e){return Array.isArray(e)}function Fr(e){const t=Yf.getItem("playerapi-numbers-session-storage-key"),r=i(()=>JSON.parse(t||""));return function(e,t){const i=e.find(e=>!!xr(e)&&Vr(e)===t);return void 0===i?void 0:jl(i[1])}(Array.isArray(r)?r:[],e)}function Ur(e,t){const r=Yf.getItem("playerapi-numbers-session-storage-key"),n=i(()=>JSON.parse(r||"")),o=Array.isArray(n)?n:[];Yf.setItem("playerapi-numbers-session-storage-key",JSON.stringify(function(e,t,i){const r=function(e,t){return[e,t]}(t,i),n=e.findIndex(e=>!!xr(e)&&Vr(e)===t);for(0===n?e[0]=r:(n>0&&e.splice(n,1),e.splice(0,0,r));10<e.length;)e.pop();return e}(o,e,t)))}function Br(e){const t=e;return t.Ya||(t.Ya={}),t.Ya.streamPlayer||(t.Ya.streamPlayer={}),t.Ya.streamPlayer}function Hr(e){return Wr(e),qf.flags[e]}function Gr(e){return"true"===e||"1"===e||"false"!==e&&"0"!==e&&void 0}function jr(e){const t=Gr(Hr(e));if("undefined"===typeof t){return Gr(Xf[e])}return t}function Wr(e){if(qf.flagsInited)return;const t=new Error(e?"Unexpected usage of player's flag "+e+" before any flag configuration":"Unexpected usage of player's getFlagsJson before any flag configuration");setTimeout(()=>{throw t})}async function Yr(){jr("web_gogol_fetch_keepalive")&&async function(){if("boolean"===typeof navigator.onLine&&!navigator.onLine)new Promise(e=>{const t=()=>{window.removeEventListener("online",t),e()};window.addEventListener("online",t)})}()}async function Kr(e){let{url:t,data:i,contentType:r,mode:n,keepalive:o}=e;if(Qf()){const e={method:"POST",body:i,keepalive:null==o||o,priority:"low",mode:n,credentials:"omit"};void 0!==r&&(e.headers={"Content-Type":r});return!!(await fetch(t,e).catch(e=>(console.error(e),{ok:!1}))).ok||(!jr("web_gogol_fetch_retry_once")||(await Yr(),fetch(t,e).catch(e=>{console.error(e)}),!0))}return!0}async function zr(e){let{url:t,data:i,contentType:r}=e;if(await Yr(),jr("web_gogol_fetch_keepalive")){if(await Kr({url:t,data:i,contentType:r}))return}((e,t)=>{if("function"!==typeof navigator.sendBeacon)return!1;try{return navigator.sendBeacon(e,t)}catch(i){return!1}})(t,r?new Blob([i],{type:r}):i)||await Kr({url:t,data:i,contentType:r,mode:"no-cors",keepalive:!1})}function qr(e,t){try{e.details||(e.details={}),e.details.stage=t}catch(i){}}function Xr(e,t){return ff(e)?function(e){void 0===e&&(e=window);const t=o(e).match(/YaBrowser\/([\d.]+)/),i=t&&t[1]||"";return i?parseFloat(i):-1}(e)<18.6?"pip":"x-yandex-pip":"disablePictureInPicture"in t?"disablePictureInPicture":void 0}function Qr(e,t,i){const r=Xr(e,i);r&&(t?i.removeAttribute(r):i.setAttribute(r,"true"))}function Jr(){return(Jr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Zr(e){if(isNaN(e.value))return;const t={bandwidthEstimate:Ul(Math.floor(e.value)),time:Tl(),source:e.source};pf.setItem("videolayer-bandwidth-estimate",JSON.stringify(t))}function $r(e){if(e&&e.location){const{location:t}=e;return"function"===typeof t.toString?t.toString():t.href||""}return""}function en(e,t){return e.responseEnd-t.responseEnd}function tn(){if("undefined"===typeof window.performance)return{value:Ul(NaN),source:"timing-api"};const e=pg.reduce((e,t)=>(0,ug.A)(e,function(e){try{return e.performance.getEntriesByType("resource").filter(e=>{let{duration:t,responseEnd:i,transferSize:r}=e;return t>0&&i>0&&r>1024})}catch(t){return[]}}(t),en),[]).filter(e=>{let{name:t}=e;return Jf.test(t)});if(0===e.length)return{value:Ul(NaN),source:"timing-api"};const t=new mg;return e.forEach(e=>{let{transferSize:i,duration:r}=e;return t.sample(Gl(r),i)}),t.getBandwidthEstimate({value:Ul(NaN),source:"timing-api"})}function rn(e){const{controller:{lastKnownBandwidthEstimate:t,playerConfig:i}}=e;if(isFinite(t.value))return t;if(null!=i&&i.slowConnection)return{value:dg,source:"default-slow"};const r=function(){try{const e=pf.getItem("videolayer-bandwidth-estimate");if(!e)return Ul(NaN);const{bandwidthEstimate:t,time:i}=JSON.parse(e);return Tl()-i<cg?t:Ul(NaN)}catch(e){return Ul(NaN)}}();if(!isNaN(r)&&r>0)return{value:r,source:"cache"};const n=tn();if(!isNaN(n.value)&&n.value>0)return n;const o=Hl(function(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:i={}}=t;if("number"===typeof i.downlink)return i.downlink;if("number"===typeof i.downlinkMax)return i.downlinkMax;if("string"===typeof i.type||"number"===typeof i.type)switch(i.type){case sg.BLUETOOTH:return 3;case ag.CELL_2G:return.384;case ag.CELL_3G:case sg.CELLULAR:return 2;case sg.WIMAX:return 37;case sg.NONE:return 0;case ag.ETHERNET:case sg.ETHERNET:case ag.WIFI:case sg.WIFI:case sg.MIXED:return 10;case ag.UNKNOWN:case sg.UNKNOWN:case sg.OTHER:}return-1}(window));return-1===o?{value:lg,source:"network-api"}:{value:ql(ql(o,1e3),1e3),source:"network-api"}}function nn(e,t){void 0===e&&(e="a"),void 0===t&&(t="z");const i=function(e,t){let i=e+Ol()*(t+1-e);return i=Math.floor(i),i}(e.charCodeAt(0),t.charCodeAt(0));return String.fromCharCode(i)}function on(){return(on=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function an(e){const{dropCacheOnRetry:t=!1,onBeforeLoad:i=p,retries:n=0}=e;if(e.checkLoad&&e.checkLoad())return void(e.onLoad&&e.onLoad());let o=i,a=0;return t&&n>0&&(o=e=>{if(i(e),a>0){const t=-1===e.src.indexOf("?")?"?":"&",i=function(e){const t=[];for(let i=0;i<e;i++)t.push(nn());return t.join("")}(4);e.src+=t+i}a++}),function e(t){const{src:i,win:n=window,charset:o=Eg,async:a=!0,retries:s=0,onRetry:l=p,retryDelay:d=0,checkLoad:c=yg,onBeforeLoad:u=p,onLoad:h=p,onError:f=p}=t,g=n.document.createElement("script"),v=r=>{s>0?(l(r),e(on({},t,{src:i,retries:s-1}))):f(r),_(g)};g.type="text/javascript",g.async=a,g.onload=()=>c(g)?h():v(new Error("checkLoad for "+i+" failed")),g.onerror=e=>{try{n.setTimeout(()=>{v(e)},d)}catch(e){}},g.src=i,g.charset=o,u(g),r(n).appendChild(g)}(on({},e,{onBeforeLoad:o}))}function sn(){return(sn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ln(){return(ln=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function dn(e){return new Promise((t,i)=>{!function(e){const{win:t=window,src:i,retries:r=0,onError:n=p}=e,o=new ml({id:Ag.LOAD_SCRIPT_ERROR,message:"Failed to load script ["+i+"]",details:{src:i,isSelfWindow:t===window,onBeforeLoad:Boolean(e.onBeforeLoad),retries:r}});an(sn({},e,{win:t,onError:()=>n(o)}))}(ln({},e,{onLoad:t,onError:i}))})}function cn(){bg(),u(window.VTTCue)||(Ig?window.VTTCue=Ig:Ig=window.VTTCue)}function un(e){let{win:t=window,src:i,checkLoad:r,onBeforeLoad:n=Q,onLoad:o=Q,withCredentials:a=!1}=e;Rg["ll1.0-1238"]=Rg["ll1.0-1238"]||{};const s=Rg["ll1.0-1238"];return s[i]||(s[i]=dn({checkLoad:r,win:t,src:i,retries:3,dropCacheOnRetry:!0,onBeforeLoad:e=>{a||(e.crossOrigin="anonymous"),n()}}).then(o),s[i].catch(()=>delete s[i])),s[i]}function hn(){return un({src:Pg,checkLoad:()=>"undefined"!==typeof Hls})}function pn(){return un({src:_g,checkLoad:()=>"undefined"!==typeof shaka}).then(cn)}function fn(e,t,i){if(e.length<1)return;let[r]=e,n=t(r);for(let o=1;o<e.length;o++){const a=e[o],s=t(a);i(s,n)<0&&(r=a,n=s)}return r}function gn(e,t){return fn(e,t,(e,t)=>t-e)}function vn(e,t){return fn(e,t,(e,t)=>e-t)}function mn(e){return I(e.video)&&B(e.video.width)&&B(e.video.height)}function An(e){return e.video.height>=Cg}function En(e,t){let{maxWidth:i=Yl(1/0),maxHeight:r=Yl(1/0),width:n=Yl(1/0),height:o=Yl(1/0)}=t;const a=e.filter(mn).filter(An);if(a.length<=1)return e;const s=function(e,t){let{width:i,height:r}=e;return t>i/r?{width:i,height:Xl(i,t)}:{width:ql(r,t),height:r}}({width:n,height:o},a[0].video.width/a[0].video.height),l=[],d=s.width*s.height,c=vn(a.slice().reverse(),e=>{let{video:{width:t,height:i}}=e;return Math.abs(d-t*i)});for(let u=0;u<a.length&&(a[u].video.width<i&&a[u].video.height<r&&l.push(a[u]),c!==a[u]);u++);return l.length<1?[a[0]]:l}function yn(e){const t=[],i=Object.create(null),r=Object.create(null);return e.forEach(e=>{const{video:n,audio:o}=e;n&&n.height&&n.width&&n.originalId&&o&&o.bandwidth?(void 0===i[n.originalId]&&(i[n.originalId]=[],r[n.originalId]=n),i[n.originalId].push(e)):t.push(e)}),A(i,(e,i)=>{const n=r[i];if(function(e){let{width:t,height:i}=e;const r=Math.max(t,i),n=Math.min(t,i);if(r<=0)return 0;let o=Og[0];for(let a=0;a<Og.length;a++){const e=Og[a],t=wg[e];if(r>=1.3*Math.floor(16*t/9)||n>=1.3*t)return o;o=e}return Og[Og.length-1]}({width:Yl(n.width),height:Yl(n.height)})<=360)t.push(...e);else{const i=gn(e,e=>{var t;return(null==(t=e.audio)?void 0:t.bandwidth)||0});t.push(i)}}),t}function Sn(e){return void 0!==e&&null!==e.getManifest()}function Tn(e){if(Sn(e))try{var t;const i=e.getVariantTracks(),r=i.find(Vg),n=null==(t=e.getConfiguration().abr)?void 0:t.enabled,o=e.getMediaElement();if(!o||!n)return r;const{videoWidth:a=0,videoHeight:s=0}=o;return i.find(e=>e.width===a&&e.height===s&&e.originalAudioId===(null==r?void 0:r.originalAudioId))||r}catch(i){return}}function Rn(e,t){return e.getAll().find(e=>e.pathname===t)}function Pn(e){return/\/init-?.*\.mp4/.test(e)}function _n(e){const t=e.getNetworkingEngine();t&&(t.unregisterScheme("http"),t.unregisterScheme("https"))}function bn(e){if(void 0===e)return;const t=e.getManifest();if(!t)return;const i=e.getMediaElement();if(!i)return;const{currentTime:r}=i,{periods:n=[]}=t;for(let o=0;o<n.length-1;o++)if(n[o].startTime<r&&r<n[o+1].startTime)return n[o];return n[n.length-1]}function In(e){const t=Tn(e);if(!t)return;const i=bn(e);return i?i.variants.find(e=>t.id===e.id):void 0}function Cn(e,t){const i=In(e);if(!i||!i.video)return null;try{const e=i.video.findSegmentPosition(t);return B(e)?i.video.getSegmentReference(e):null}catch(r){return null}}function On(e,t){let i=jl(0);if(!Sn(e))return i;if(void 0===t){const r=e.getMediaElement();if(!r)return i;t=jl(r.currentTime)}const r=Cn(e,t);if(r){const{startTime:e,endTime:t}=r;i=zl(t,e)}return i}function wn(e,t){Pf&&jg<81&&jg>77&&jl(e.duration)-t<Wg&&(t=zl(jl(e.duration),Wg)),e.currentTime=t}function kn(e){if(!Sn(e))return;if(!e.isLive())return Bh.VOD;const t=function(e){const t=In(e);if(t&&t.video)return t.video.presentationTimeOffset}(e);return void 0!==t?0===t?Bh.LIVE:Bh.EVENT:void 0}function Dn(e,t){if(void 0===e)return;if(kn(e)===Bh.LIVE)return jl(0);if(void 0===t)return;const i=t.documentElement.getAttribute("publishTime");if(!i)return;const r=Date.parse(i);return isNaN(r)?void 0:jl(r/1e3)}function Nn(e){return e?function(e){let t="",i=0;const r=e.length;let n=0,o=0,a=0;for(;i<r;)switch(n=e[i++],n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(n);break;case 12:case 13:o=e[i++],t+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=e[i++],a=e[i++],t+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&a)<<0)}return t}(new Uint8Array(Array.from(e))):""}function Ln(e,t){if(void 0!==shaka&&e===shaka.net.NetworkingEngine.RequestType.MANIFEST&&t.data)return function(e){if(!e)return null;try{const t=(new DOMParser).parseFromString(e,"application/xml");return null===t.querySelector("parsererror")?t:null}catch(t){return null}}(Nn(new Uint8Array(t.data)))||void 0}async function Mn(e){let{shakaPlayer:t,streamUrl:i,startPosition:r}=e,n=!1;t.addEventListener("unloading",()=>{n=!0});const o=B(null==r?void 0:r.utc),a=o||null==r?void 0:r.videoTime,s=t.load(i,B(a)?a:void 0);if(!o)return void await s;const l=null==r?void 0:r.utc,d=new Yg(t);if(await s,n)throw new Error("loadShakaSource aborted");const c=d.getManifestXml()||await d.waitForManifestXml();if(n)throw new Error("loadShakaSource aborted");const u=Dn(t,c),h=void 0===u?null==r?void 0:r.videoTime:0===u?null==r?void 0:r.utc:Math.max(zl(l,u),0);if(void 0===h)return;const p=t.getMediaElement();(function(e){if(!Sn(e))return!1;const t=e.getMediaElement();return!!t&&(Number(t.readyState)>0&&Number(t.duration)>0)})(t)||await new Promise((e,i)=>{f(p,"loadeddata",e,{once:!0}),t.addEventListener("unloading",i)}),wn(p,jl(h))}function Vn(){return(Vn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function xn(e){const{error:t}=e;return new Xg(t)}function Fn(e){const t=mt(e).pathname;return 0===t.indexOf("/vod/")||0===t.indexOf("/live/")||0===t.indexOf("/kal/")}function Un(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.status:void 0}function Bn(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.readyState:void 0}function Hn(e){if(void 0===e)return;const{level:t,start:i,duration:r,url:n,relurl:o,sn:a,programDateTime:s,deltaPTS:l,dropped:d,endDTS:c,endPTS:u,startDTS:h,startPTS:p}=e;return{level:t,start:i,duration:r,url:n,relurl:o,sn:a,programDateTime:s,deltaPTS:l,dropped:d,endDTS:c,endPTS:u,startDTS:h,startPTS:p}}function Gn(){return(Gn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function jn(e){try{return JSON.parse(Xt(Gn({},e,{networkDetails:void 0,frag:Hn(e.frag)})))}catch(t){return{message:i(()=>t.message)||"Cannot serialize hlsJsError"}}}function Wn(){return(Wn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Yn(e){let{details:t,networkDetails:i}=e;if(451===(i?i.status:NaN))switch(t){case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:return Cs.REGIONAL_LIMITATION_MANIFEST;case Hls.ErrorDetails.LEVEL_LOAD_ERROR:return Cs.REGIONAL_LIMITATION_LEVEL;case Hls.ErrorDetails.FRAG_LOAD_ERROR:return Cs.REGIONAL_LIMITATION_SEGMENT;default:return}}function Kn(e){let{details:t,networkDetails:i}=e;const r=i?i.status:NaN;if($g.includes(r))switch(t){case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:return Cs.SIGNATURE_EXPIRED_MANIFEST;case Hls.ErrorDetails.LEVEL_LOAD_ERROR:return Cs.SIGNATURE_EXPIRED_LEVEL;case Hls.ErrorDetails.FRAG_LOAD_ERROR:return Cs.SIGNATURE_EXPIRED_SEGMENT;default:return}}function zn(e){return void 0!==Yn(e)}function qn(e){return void 0!==Kn(e)}function Xn(e){const{details:t,fatal:i}=e;return t?!nv.includes(t)&&(!(!zn(e)&&!qn(e))||Boolean(i)):Boolean(i)}function Qn(e,t){return void 0===e.err||void 0===e.err.message?"MISSED_STACK__"+t:e.err.message}function Jn(e){if(void 0===e)return;const{details:t}=e;if(t===Hls.ErrorDetails.BUFFER_STALLED_ERROR)return;const i=Xn(e)&&!Zn(e),r=Yn(e)||Kn(e)||t||Cs.DEFAULT_ERROR,{err:{stack:n=new Error(Qn(e,r)).stack}={stack:void 0}}=e;return new jc({code:r,isFatal:i,details:Wn({},jn(e),{networkErrorStatus:Un(e),xhrReadyState:Bn(e)}),stack:n})}function Zn(e){return!zn(e)&&!qn(e)&&(!!e.details&&tv.includes(e.details))}function $n(e){const{details:t}=e;return!!t&&rv.includes(t)}function eo(e){const t=e.split("x");if(t.length<2)return;const i={rows:parseInt(t[0],10),columns:parseInt(t[1],10)};return isNaN(i.rows)||isNaN(i.columns)?void 0:i}function to(e,t){const{rows:i,columns:r}=e;if(!i||!r)return null;const{width:n,height:o}=t;return{width:Yl(n/r),height:Yl(o/i)}}function io(e,t){return 0===e.rows||0===e.columns?jl(0):jl(t/(e.rows*e.columns))}function ro(e,t){if(0===Object.keys(e).length)return;const{uri:i,duration:r,resolution:n,tiles:o}=e;if([i,r,n,o].some(e=>!e))return void(t&&t("NonValidHLSThumbnailTileSessionData"));const a=eo(o),s=function(e){if(""===e)return;const[t,i]=e.split("x"),r={width:Yl(parseInt(t,10)),height:Yl(parseInt(i,10))};return isNaN(r.width)||isNaN(r.height)?void 0:r}(n),l=jl(parseFloat(r));if(void 0===a||void 0===s||isNaN(l))return void(t&&t("MapTileSessionDataParseError"));return{tiles:a,uriTemplate:i,spriteDuration:l,resolution:s,tileSize:to(a,s),tileDuration:io(a,l)}}function no(e,t,i){const r=t===ov.LOWRES?av:sv,{VALUE:n=""}=e[r.tiles]||{},{VALUE:o=""}=e[r.duration]||{},{VALUE:a=""}=e[r.resolution]||{},{VALUE:s=""}=e[r.uri]||{},l=[n,o,a,s];if(!l.every(e=>""===e)){if(!l.some(e=>""===e))return{tiles:n,duration:o,resolution:a,uri:s};i&&i("NonValidHLSSessionData")}}function oo(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function ao(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function so(e){let{width:t,height:i,bitrate:r}=e;return t+"x"+i+"@"+r}function lo(e){return e+"p"}function co(e){let{width:t,height:i}=e;const r=!B(i)||i<=0;if(!B(t)||t<=0||r)return r?"":lo(Yl(i));const n=Math.max(t,i),o=Math.min(t,i);let a=lv[0];for(let s=0;s<lv.length;s++){if(lv[s]===o)return lo(lv[s]);if(n>=dv*Math.floor(16*lv[s]/9)||o>=dv*lv[s])return lo(a);a=lv[s]}return lo(lv[lv.length-1])}function uo(e,t){const{attrs:i={},width:r,height:n}=e;if(!B(n))return"";const o=co(e);if(!B(r))return o;const a=so({width:r,height:n,bitrate:Ul(i["AVERAGE-BANDWIDTH"]?parseInt(i["AVERAGE-BANDWIDTH"],10):e.bitrate)}),s=t.get(a);return void 0===s?o:s}function ho(e,t){if(void 0===e)return;const{height:i,width:r,url:n,bitrate:o}=e;return Array.isArray(n)?{name:uo(e,t),value:n[0],width:r,height:i,bitrate:o?Xl(Ul(o),1e3):jp}:void 0}function po(e,t){const i=function(e,t,i){const r={};return e.filter(e=>Boolean(i(e))).forEach(e=>{const n=t(e);(!r[n]||i(r[n])<i(e))&&(r[n]=e)}),hr(r)}(e,e=>{let{height:t}=e;return t},e=>{let{bitrate:t}=e;return t}),r=[];return i.forEach(e=>{const i=ho(e,t);i&&r.push(i)}),r}function fo(e,t){let{name:i,lang:r}=t;const n=i?e.find(e=>e.name===i):void 0;return n||(r?e.find(e=>e.lang===r):void 0)}function go(e,t){let{name:i,height:r}=t;const n=i?e.find(e=>e.name===i):void 0;if(n)return n;if(void 0===r)return;return vn(e.filter(e=>{let{height:t}=e;return void 0!==t}),e=>{let{height:t}=e;return Math.abs(t-r)})}function vo(e,i){const{paused:r}=e,n=i();return r||t(e.play()),n}function mo(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}function Ao(e){return void 0!==e&&B(e)&&e>=0}function Eo(e){const{type:t}=e;return t===Bh.VOD||!1===e.live?Bh.VOD:t===Bh.EVENT?Bh.EVENT:Bh.LIVE}function yo(e){const t=function(e){let t;void 0===e&&(e=window);try{t=e.devicePixelRatio}catch(i){}return t||1}();return{width:(e.width||e.clientWidth||e.offsetWidth)*t,height:(e.height||e.clientHeight||e.offsetHeight)*t}}function So(e){const t=e.match(hv);if(t)return{width:Yl(parseInt(t[1],10)),height:Yl(parseInt(t[2],10)),bitrate:Bl(parseInt(t[3],10))}}function To(e,t){v(t).forEach(i=>{const r=t[i];null===r?e.removeAttribute(i):e.setAttribute(i,r)})}function Ro(e,t,i){void 0===t&&(t=wp());let r=i;return function(i){if(!t(r,i))return r=i,e(i)}}function Po(e){let{skin:{hiddenControls:t}}=e;return!t.includes(ed.TIMELINE)}function _o(e,t){void 0===t&&(t={});let i=0;const r=[],n=(t,n)=>{r.push(f(e,t,n,mv)),clearTimeout(i)},o=()=>O(r),a=new Promise((r,o)=>{const a=t=>{e.paused&&o(t)},s=e.play();if(a(vv.VideoTagPaused),n("durationchange",()=>a(vv.VideoTagPausedAfterDurationChange)),n("error",()=>a(vv.VideoTagPausedAfterError)),n("pause",()=>o(vv.PauseEvent)),n("playing",()=>{r(vv.PlayingEvent)}),s)t.useProgressEvent&&n("progress",()=>{r(vv.ProgressEvent)}),s.then(()=>r(vv.PromiseResolve)).catch(e=>o(function(e){return e?vv.PromiseReject+"["+e.code+"]["+e.name+"]["+e.message+"]":vv.PromiseReject}(e)));else{const{timeoutForNonPromisePlay:e}=t;"number"===typeof e&&e>0&&(i=window.setTimeout(()=>{o(vv.Timeout)},t.timeoutForNonPromisePlay))}});return a.then(o,o),a}function bo(e){let{kind:t}=e;return"subtitles"===t}function Io(e){const t=[];for(let i=0;i<e.length;i++)bo(e[i])&&t.push(e[i]);return t}function Co(e){return e?"showing":"hidden"}function Oo(e,t){let{paused:i}=e;return i?$l.PAUSE:t?$l.BUFFERING:$l.PLAY}function wo(){return(wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ko(e){if("function"===typeof e.getVideoPlaybackQuality){const t=e.getVideoPlaybackQuality();return{droppedVideoFrames:t.droppedVideoFrames,corruptedVideoFrames:t.corruptedVideoFrames,totalVideoFrames:t.totalVideoFrames}}const t=e;return"number"===typeof t.webkitDroppedFrameCount&&"number"===typeof t.webkitDecodedFrameCount?wo({},Rv,{droppedVideoFrames:t.webkitDroppedFrameCount,totalVideoFrames:t.webkitDecodedFrameCount}):Rv}function Do(){return(Do=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function No(){return(No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Lo(e,t){if(void 0===t)return e;return void 0!==function(e){const t=function(e,t){return sp.href=e,((sp.hash||"").slice(1).split("&").map(e=>e.split("=")).map(e=>{let[t,i]=e;return[t,void 0===i?"":i]}).find(e=>{let[i]=e;return i===t})||[])[1]}(e,"t");return void 0===t?t:jl(Number(t))}(e)?Ht(e,"t",t):Bt(e,"t",String(t))}function Mo(e){if(Fv(e.message))return Cs[e.message];if(Fv(e.code))return Cs[e.code];const t=qg[e.code];return Fv(t)?Cs[t]:Cs.DEFAULT_ERROR}function Vo(e){if(void 0===e)return;const{id:t,label:i,language:r}=e;return{name:i||r,value:t,lang:r||""}}function xo(e){const t=K(e.audioTracks).find(e=>e.enabled);return t?Vo(t):void 0}function Fo(e){return"subtitles"===e.kind&&"StreamPlayerJs TextTrack"!==e.label}function Uo(e,t){if(void 0===e)return;const{id:i,label:r,language:n}=e;return{name:r||n,value:"undefined"!==typeof i&&""!==i?i:"index:"+t,lang:n||""}}function Bo(e){const t=[];return K(e).forEach(e=>{const i=Vo(e);i&&t.push(i)}),t}function Ho(e){const t=[];return K(e).forEach((e,i)=>{if(!Fo(e))return;const r=Uo(e,i);r&&t.push(r)}),t}function Go(){return(Go=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function jo(e,t){return t.code!==e.util.Error.Code.BAD_HTTP_STATUS?0:t.data[1]||0}function Wo(){return(Wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Yo(e){return{error:String(e.error)||"",isFatal:Boolean(e.isFatal)}}function Ko(e,t){if(!t)return;const i=t,{code:r,severity:n,category:o,data:a}=i;let s="shaka."+function(e,t){let i;for(i in e.util.Error.Code)if(e.util.Error.Code.hasOwnProperty(i)&&t.code===e.util.Error.Code[i])return i;return"ERROR"}(e,i)+"_"+r,l=a,d=n===e.util.Error.Severity.CRITICAL;switch(o){case e.util.Error.Category.NETWORK:l.networkErrorStatus=jo(e,i);const t=function(e,t){if(t.code!==e.util.Error.Code.BAD_HTTP_STATUS)return;if(451!==jo(e,t))return;switch(t.data[t.data.length-1]){case e.net.NetworkingEngine.RequestType.MANIFEST:return Cs.REGIONAL_LIMITATION_MANIFEST;case e.net.NetworkingEngine.RequestType.SEGMENT:return Cs.REGIONAL_LIMITATION_SEGMENT;default:return}}(e,i)||function(e,t){if(t.code!==e.util.Error.Code.BAD_HTTP_STATUS)return;const i=jo(e,t);if(!$g.includes(i))return;switch(t.data[t.data.length-1]){case e.net.NetworkingEngine.RequestType.MANIFEST:return Cs.SIGNATURE_EXPIRED_MANIFEST;case e.net.NetworkingEngine.RequestType.SEGMENT:return Cs.SIGNATURE_EXPIRED_SEGMENT;default:return}}(e,i);void 0===t?s+=function(e,t){switch(t.code){case e.util.Error.Code.BAD_HTTP_STATUS:case e.util.Error.Code.HTTP_ERROR:case e.util.Error.Code.TIMEOUT:const i=function(e,t){const{RequestType:i}=e.net.NetworkingEngine;switch(t){case i.APP:return"APP";case i.LICENSE:return"LICENSE";case i.MANIFEST:return"MANIFEST";case i.SEGMENT:return"SEGMENT";case i.TIMING:return"TIMING";default:return}}(e,t.data[t.data.length-1]);return void 0===i?"_UNKNOWN":"_"+i;default:return""}}(e,i):(d=!0,s=t);break;case e.util.Error.Category.DRM:const n=a[0];if(!n||!(e=>{if(!e.data)return!1;return 418===e.data[1]})(n))break;const o=function(e){return new jc({isFatal:e.isFatal,code:e.error===Yv.EXPIRED_SIGNATURE?Cs.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:Cs.DRM_PROXY_ERROR,details:{drmProxyError:e.error}})}((e=>{try{return function(e){if("string"===typeof e)try{return Yo(JSON.parse(e))}catch(t){return Wo({},Kv,{error:e})}return"object"===typeof e?Yo(e):Kv}(e.data[2])}catch(t){return Kv}})(n));s=o.code,l=o.details,d=d||o.isFatal;break;case e.util.Error.Category.PLAYER:if(r===e.util.Error.Code.LOAD_INTERRUPTED)return;break;case e.util.Error.Category.CAST:case e.util.Error.Category.STORAGE:}return new jc({code:s,isFatal:d,details:l,message:t.message,stack:t.stack})}function zo(e){return!!I(e)&&(!!B(e.severity)&&(!!B(e.category)&&(!!B(e.code)&&!!El(e.data))))}function qo(e,t){return function(e,t){const i=t===ov.HIGHRES?Xv:Qv,r=e.querySelector(i.version);if(!r||"2"!==r.getAttribute("value"))return;const n=e.querySelector(i.tiles),o=e.querySelector(i.uriTemplate),a=e.querySelector(i.spriteDuration),s=e.querySelector(i.resolution);if(!n||!o||!a||!s)return;const l=n.getAttribute("value"),d=o.getAttribute("value"),c=jl(parseFloat(a.getAttribute("value")||"")),u=s.getAttribute("value");if(!l||!u||!d||isNaN(c))return;const h=function(e){const t=e.split("x");if(t.length<2)return;const i={width:Yl(parseInt(t[0],10)),height:Yl(parseInt(t[1],10))};return isNaN(i.width)||isNaN(i.height)?void 0:i}(u);if(!h)return;const p=eo(l);if(!p)return;const f=to(p,h),g=io(p,c);return{tiles:p,uriTemplate:d,spriteDuration:c,resolution:h,tileSize:f,tileDuration:g}}(e,t)||function(e,t){const i=K(e.querySelectorAll('AdaptationSet[mimeType="image/jpeg"]'));let r=i[0];if(!r)return;if(t===ov.LOWRES){let e;if(i.forEach(t=>{t.querySelector('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:type"][value="'+ov.LOWRES+'"]')&&(e=t)}),!e)return;r=e}const n=r.querySelector("SegmentTemplate"),o=r.querySelector("Representation"),a=r.querySelector("EssentialProperty");if(!n||!o||!a)return;const s=a.getAttribute("value"),l=n.getAttribute("media"),d=jl(parseFloat(n.getAttribute("duration")||"")),c=parseFloat(o.getAttribute("width")||""),u=parseFloat(o.getAttribute("height")||""),h={width:Yl(c),height:Yl(u)};if(!s||!l||!d||!c||!u)return;const p=eo(s);if(!p)return;const f=to(p,h),g=io(p,d);return{tiles:p,uriTemplate:l,spriteDuration:d,resolution:h,tileSize:f,tileDuration:g}}(e,t)}function Xo(e,t){const i=Math.pow(10,t);return Math.round((e+tm)*i)/i}function Qo(e,t){const i=function(e,t){let{stream:i}=e,{audio:r=jl(0),video:n=jl(0)}=t;if(!i||!im())return;const{type:o}=i;switch(o){case"audio":return Xo(r,3);case"video":return Xo(n,3);default:return}}(e,t);void 0!==i&&(e.uris=e.uris.map(e=>function(e,t){const{hostname:i}=mt(e);return i.match(rm)?Tt(e,{bufsize:String(t)}):e}(e,i)))}function Jo(e){return(e.getAttribute("id")||"")+"@"+(e.getAttribute("width")||"")+"x"+(e.getAttribute("height")||"")+";"}function Zo(e){return K(e.querySelectorAll("Representation")).map(Jo).sort()}function $o(e,t,i){void 0===e&&(e=[]);const r=e.find(e=>{var r,n;const o=(null==(r=e.video)?void 0:r.originalId)===t,a=(null==(n=e.audio)?void 0:n.originalId)===i;return o&&a});if(void 0!==r)return r.id;const n=function(e,t,i){void 0===t&&(t=e=>Boolean(e));void 0===i&&(i=e.length-1);for(let r=i;r>=0;r--)if(t(e[r],r,e))return r;return-1}(e,e=>{var i;return(null==(i=e.video)?void 0:i.originalId)===t});return-1===n?void 0:e[n].id}function ea(e,t){if(!t||!e)return;const i='AdaptationSet > Representation[id="'+t+'"]',r=e.querySelector(i);if(!r)return;const n=r.parentElement;if(!n)return;const o=n.getAttribute("lang");return o?o.toLowerCase():void 0}function ta(e,t){const{width:i,height:r,bandwidth:n}=e;if(!B(r))return"";const o=co(e);if(!B(i)||!B(n))return o;const a=so({width:i,height:r,bitrate:Ul(n)}),s=t.get(a);return void 0===s?o:s}function ia(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:i}=t;return i||void 0}function ra(e){return e&&ia(e)||window}function na(){return(na=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function oa(e){if(e in gm)return gm[e];const t=document.createElement("link");return t.rel="preload",t.as="script",gm[e]=new Promise((i,r)=>{t.onload=i,t.onerror=r,t.href=e,t.crossOrigin="anonymous",fm.appendChild(t)}).then(()=>{gm[e]=Promise.resolve()}).catch(()=>{delete gm[e],fm.removeChild(t)}),gm[e]}function aa(){return(aa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function sa(e){return"videoplayer-iframe-api-raa-cache-"+e.autoplay+"-"+e.allowMuted+"-"+e.muted}function la(e){return i(()=>{const t=JSON.parse(pf.getItem(sa(e))),{time:i,cacheVersion:r}=t,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(t,Em);return 2!==r?null:Date.now()-i<ym?n:null})||null}function da(e){const t=e.navigator;if(!t)return;const{userActivation:i}=t;if(!I(i))return;const{isActive:r,hasBeenActive:n}=i;return{isActive:r,hasBeenActive:n}}function ca(e){const t=()=>Tm.forEach(e=>window.removeEventListener(e,i)),i=i=>{"pagehide"===i.type&&i.persisted||(e(i),t())};return Tm.forEach(e=>window.addEventListener(e,i)),t}function ua(e,t){if(void 0===t&&(t=window),!t||!t[e]||!t[e].prototype)return;const{play:i}=t[e].prototype;return i&&u(i)?i:void 0}function ha(){return(ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function pa(e){let{canPlayUnMuted:t,canPlayMuted:i,detectionMethod:r}=e;return{canPlayUnMuted:t,canPlayMuted:i,requireMute:!t&&i,requireUserGesture:!t&&!i,detectionMethod:r}}function fa(e){if("boolean"===typeof e.allowedToPlay)return Promise.resolve(function(e){const t=Im(e);return e.muted=!1,e.volume=1,e.allowedToPlay?(t(),pa({canPlayUnMuted:!0,canPlayMuted:!0,detectionMethod:Pm.YaBroAllowedToPlay})):(e.muted=!0,e.volume=0,e.allowedToPlay?(t(),pa({canPlayUnMuted:!1,canPlayMuted:!0,detectionMethod:Pm.YaBroAllowedToPlay})):(t(),pa({canPlayUnMuted:!1,canPlayMuted:!1,detectionMethod:Pm.YaBroAllowedToPlay})))}(e));return fd&&dm<=9?Promise.resolve(ha({},Om,{detectionMethod:Pm.IOS9OrLess})):Es?Cm?Promise.resolve(ha({},wm,{detectionMethod:Pm.OldIE})):void 0:Promise.resolve(ha({},Om,{detectionMethod:Pm.HTML5VideoIsNotSupported}))}function ga(e){let t,i,{videoSlot:r,autoplay:n,muted:o,allowMuted:a}=e;if(!n){const e={autoplay:!1,muted:o,detectionMethod:Nm.AutoplayDisabled};return{promise:Promise.resolve(e),abort:Q}}return{promise:new Promise(async e=>{t=e;const{promise:n,stop:s}=function(e,t){let{checkSoundEnabled:i=!0}=void 0===t?{}:t;const r=fa(e),n=new Dm(e,{checkSoundEnabled:i,promise:r});return{promise:n.promise,stop:n.stop}}(r,{checkSoundEnabled:!o});i=s;const{requireMute:l,requireUserGesture:d,detectionMethod:c}=await n.catch(()=>wm);e(function(e){let{requireUserGesture:t,requireMute:i,muted:r,allowMuted:n,detectionMethod:o}=e;return t?{autoplay:!1,muted:r,autoplayImpossible:!0,detectionMethod:o}:i?r||n?{autoplay:!0,muted:!0,detectionMethod:o}:{autoplay:!1,muted:r,autoplayImpossible:!0,requireAllowMutedToAutoplay:!0,detectionMethod:o}:{autoplay:!0,muted:r,detectionMethod:o}}({requireUserGesture:d,requireMute:l,muted:o,allowMuted:a,detectionMethod:c}))}),abort:()=>{i(),t({autoplay:!0,muted:o,detectionMethod:Nm.RASAborted})}}}function va(e,t){return void 0===e?void 0===t:"auto"in e&&!0===e.auto?"auto"===t:e.value===t}function ma(e,t){const i=function(e){void 0===e&&(e=window);const{document:t={}}=e;return xm.filter(e=>{let{enabled:i}=e;return i in t})}(e);if(i.length>0)return i[0];const r=function(e,t){return void 0===e&&(e=window),void 0===t&&(t=e.HTMLVideoElement&&e.HTMLVideoElement.prototype||{}),xm.filter(e=>{let{enabled:i}=e;return i in t})}(e,t);return r.length>0?r[0]:void 0}function Aa(e,t){const i=ma(e,t);if(!i)return null;let r=e.document[i.element];return t&&t[i.element]&&(r=t),r||null}function Ea(e){void 0===e&&(e=window);try{return e.ya.videoAd.getBundleVersion()}catch(t){return"none"}}function ya(e){void 0===e&&(e=window);try{return e.ya.videoAd.getModuleVersion()}catch(t){return"none"}}function Sa(){return(Sa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Ta(){return(Ta=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Ra(){return(Ra=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}async function Pa(e,t,i,r,n,o,a){let s;var l,d;(void 0===e&&(e=window),void 0===r&&(r=!1),r&&o)?s=(d={loaderUrl:"https://ad.mail.ru/static/admanhtml/rbadman-html5.min.js",win:e,vkParams:o,yaDirectPixel:a?{url:a.url,data:a.data}:void 0},{promise:new Promise((e,t)=>{an({src:d.loaderUrl,onError:e=>{d.yaDirectPixel&&Km(d.yaDirectPixel.url,Ta({},d.yaDirectPixel.data,{eventType:"dsp_request_failed",inventory:"instream",eventUnixTime:Math.floor(Date.now()/1e3)})),t(e)},onLoad:()=>{d.yaDirectPixel&&Km(d.yaDirectPixel.url,Ta({},d.yaDirectPixel.data,{eventType:"dsp_request",inventory:"instream",eventUnixTime:Math.floor(Date.now()/1e3)}));const t=new d.win.AdmanHTML;t.init(Ta({},d.vkParams)),e(t)}})})}).promise:s=Qm({serviceName:"player",serviceVersion:n,vasLoaderUrl:Jm,config:Ra({},t,{additionalCustomRootFields:{vsid:i,contentPlayerVersion:n,testIds:null==(l=t.additionalParams)?void 0:l.slots}}),win:e,moduleName:"Multiroll",yaDirectPixel:a?{url:a.url,data:a.data}:void 0}).promise;return s.catch(p),s}function _a(){return(_a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ba(e){return e.reduce((e,t)=>Kl(e,jl(t.getAdDuration())),jl(0))}function Ia(){return(Ia=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Ca(e,t){return Gl(Math.max(e+dA,t+lA))}function Oa(e){let{cue_id:t,pts:i,offset:r,cutoff:n}=e;const o=Kl(i,r);return{start:o,isEndReceived:void 0!==n,cueId:t,end:void 0!==n?Kl(i,n):Ca(i,o),isValid:!0,invalidateReason:void 0}}function wa(){return(wa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ka(){return(ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Da(){return(Da=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Na(e){const{controller:t}=e;return{watchedTime:t.watchedTime,position:t.currentTime,duration:t.duration}}function La(e){return"ya-video-player-"+e}function Ma(){return(Ma=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Va(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}function xa(){return(xa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Fa(){return(Fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Ua(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.join("")}function Ba(){this.returnValue=!1}function Ha(){this.cancelBubble=!0}function Ga(e){return function(t){const i=function(e){return e.stopPropagation||(e.stopPropagation=Ha),e.preventDefault||(e.preventDefault=Ba),e.target||(e.target=e.srcElement),e}(t);e.call(this,i)}}function ja(e){e&&e.un()}function Wa(e,t,i){return Math.max(Math.min(t,i)-Math.max(e,0),0)}function Ya(e){const t=ol(e),i=t.width,r=t.height;let n=0;if(i>0&&r>0){const e={width:window.innerWidth,height:window.innerHeight};n=Wa(t.left,t.right,e.width)*Wa(t.top,t.bottom,e.height)/(i*r)}return n}function Ka(e){void 0===e&&(e=window);const t=o(e).match(/YaBrowser\/([\d]+)\.([\d]+)/);if(!t)return{major:-1,minor:-1};const[,i,r]=t;return{major:parseInt(i,10),minor:parseInt(r,10)}}function za(){return ff(window)&&!fd&&!gd}function qa(e,t){return xm.some(i=>{if(!e[i.element])return!1;let r=t;for(;r;){if(e[i.element]===r)return!0;r=r.parentElement}return!1})}function Xa(){return(Xa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Qa(e){setTimeout(()=>{throw e},0)}function Ja(){return(Ja=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function Za(e){let{url:t,adConfig:i,additionalParams:r}=e;t=((e,t)=>{if(!e||!t)return e;const i={"partner-id":"number"===typeof t.partnerId?String(t.partnerId):t.partnerId,"video-category-id":"number"===typeof t.category?String(t.category):t.category,"imp-id":String(t.impId),gzip:"1"};return Tt(e,i,{override:!0,saveOriginalPath:!0})})(t,i);const{from:n,vsid:o}=r,a=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(r,$A);return t=Tt(t,{from:n,vsid:o},{override:!0,saveOriginalPath:!0}),Tt(t,a,{override:!1,saveOriginalPath:!0})}function $a(){return($a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function es(e,t){if(!e.servers)return e;const i={};return function(e){return"function"===typeof Object.entries?Object.entries(e):v(e).map(t=>[t,e[t]])}(e.servers).forEach(e=>{let[r,n]=e;!function(e){const{hostname:t}=mt(e);return eE.includes(t)}(n)?i[r]=n:i[r]=St(n,"vsid",t)}),$a({},e,{servers:i})}function ts(e){const t=function(e,t){if(void 0===t&&(t=!0),sd&&t)return[];{const t=[];let r=e;for(;;)try{if(r=r.ownerDocument.defaultView.frameElement,!r)return t;t.push(r)}catch(i){return t}}}(e.documentElement).map(e=>e.ownerDocument);return t.unshift(e),t.map(e=>({location:$r(e.defaultView),referrer:e.referrer}))}function is(){return(is=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function rs(e){void 0===e&&(e={});const t={};for(const i in e){const r=e[i],n=typeof r;"string"!==n&&"number"!==n&&"boolean"!==n||(t[i]=r)}return t}function ns(){const{plugins:e}=window.navigator;return void 0===e||0===e.length?[]:CA(e,rs)}function os(){const e=window.navigator||{},t=window.performance||{},{location:i,referrer:r}=function(e){let t="",i="";if(e){ts(e).reverse().forEach(e=>{let{location:r,referrer:n}=e;t=t||r,i=i||n})}return{location:t,referrer:i}}(document);return{navigator:is({},rs(e),{connection:rs(e.connection),plugins:ns()}),performance:{memory:rs(t.memory)},playerLocation:location.href,iframeApiLocation:i,iframeApiReferrer:r}}function as(e){return[...e.hash.substr(1).split("&"),...e.search.substr(1).split("&")].reduce((e,t)=>{const[i,r]=t.split("=");return void 0!==r&&(e[i]=decodeURIComponent(r.replace(/\+/g," "))),e},{})}function ss(){return(ss=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ls(e){return n(e.toJSON)?e.toJSON():e}function ds(){return(ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function cs(e,t,i){if(void 0===i&&(i=window),!i.history)return;if(_m>-1&&_m<=15)return;const r=((e,t,i)=>{const r=ds({},as(e));r.mq_url=void 0,r.lq_url=void 0,r.hq_url=void 0,r.hd_url=void 0,r.stream_url=i?function(e,t){return e.includes("?")?t.reduce(Gt,e):e}(i,["vsid","partner-id","video-category-id","imp-id","gzip"]):"",r.additional_params="object"===typeof t.additionalParams?JSON.stringify(t.additionalParams):void 0;const{adConfig:n={}}=t;return r.partner_id=aE(n.partnerId),r.category=aE(n.category),r.imp_id=aE(n.impId),r.distr_id=aE(n.distrId),r.video_content_id=aE(n.videoContentId),r.video_content_name=aE(n.videoContentName),r.video_publisher_id=aE(n.videoPublisherId),r.video_publisher_name=aE(n.videoPublisherName),r.video_genre_id=aE(n.videoGenreId),r.video_genre_name=aE(n.videoGenreName),r.start_position=aE(t.startPosition),r.loop=aE(t.loop),r.with_credentials=aE(t.withCredentials),r.preview=aE(t.preview),r.host=e.hostname,r})(i.location,e,t),n=function(e,t,i){void 0===i&&(i={});for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e=Ut(e,r,t[r]));for(const r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e=Bt(e,r,i[r]));return e}(i.location.href.split("?")[0].split("#")[0],r);try{i.history.replaceState(void 0,"",n)}catch(o){}}function us(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:i={}}=t;return Boolean(i.saveData)}function hs(){return(hs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function ps(e){if(void 0===e&&(e=window),!e.navigator)return gE;const{connection:t={}}=e.navigator;return B(t.rtt)?t.rtt:gE}function fs(){return(fs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function gs(){return(gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function vs(){return TE?TE.getSourceId():NaN}var ms={};e.r(ms),e.d(ms,{actionTransformer:()=>dt,logger:()=>Zc});const As=document.createElement("video"),Es="function"===typeof As.load;(function(){function e(){const e=i.apply(this);return t(e),e}if(!Es)return;const i=HTMLMediaElement.prototype.play;e.__yaMuffleVideoPlayPromiseOriginalPlay=i,HTMLMediaElement.prototype.play=e})(),"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value(){const e={};return i(()=>{Object.getOwnPropertyNames(this).forEach((function(t){e[t]=this[t]}),this)}),e},configurable:!0,writable:!0});const ys={}.toString,Ss=/\[object (\w+)\]/,Ts=e=>{const t=ys.call(e);if(!t)return null;const i=t.match(Ss);if(!i)return null;const r=i[1];return r||null},Rs="https://strm.yandex.net/int/enc/srvr.xml",Ps=!Rs.includes("int/enc/srvr.xml"),_s=function(e){return void 0===e&&(e=window),o(e).toLowerCase().includes("windows")}(),bs=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase(),i=/windows nt (\d+\.\d+)/.exec(t);if(i){const e=Number(i[1]);return e>0?e:-1}return-1}();let Is=function(e){return e.DEFAULT="DEFAULT",e.MEDIA="MEDIA",e.NETWORK_MEDIA="NETWORK_MEDIA",e.NETWORK_PLAYER="NETWORK_PLAYER",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NO_CODECS="NO_CODECS",e.CANNOT_PLAY="CANNOT_PLAY",e.UNSUPPORTED_ENV="UNSUPPORTED_ENV",e.EXCEPTION="EXCEPTION",e.ADS="ADS",e.CONFIG="CONFIG",e.REGIONAL="REGIONAL",e.DRM="DRM",e.ACCESS="ACCESS",e.INVALID_STREAM_URL="INVALID_STREAM_URL",e}({}),Cs=function(e){return e.DEFAULT_ERROR="DEFAULT_ERROR",e.YANDEX_RPC_ERROR="YANDEX_RPC_ERROR",e.BROADCAST_AD_BLOCK_INIT_ERROR="BROADCAST_AD_BLOCK_INIT_ERROR",e.AD_TYPE_IS_NOT_RECOGNIZED="AD_TYPE_IS_NOT_RECOGNIZED",e.INVALID_METADATA="INVALID_METADATA",e.INVALID_STREAM_URL="INVALID_STREAM_URL",e.UNSUPPORTED_MEDIA_TYPE="UNSUPPORTED_MEDIA_TYPE",e.SCRIPT_INIT_ERROR="SCRIPT_INIT_ERROR",e.MPD_WIDEVINE_CERT_LOAD_ERROR="MPD_WIDEVINE_CERT_LOAD_ERROR",e.MPD_SHAKA_INIT_ERROR="MPD_SHAKA_INIT_ERROR",e.NATIVE_HLS_NOT_SUPPORTED_ERROR="NATIVE_HLS_NOT_SUPPORTED_ERROR",e.HLS_JS_NOT_SUPPORTED_ERROR="HLS_JS_NOT_SUPPORTED_ERROR",e.REFRESH_SUBTITLES_ERROR="REFRESH_SUBTITLES_ERROR",e.ON_TICK_ERROR="ON_TICK_ERROR",e.FAIRPLAY_NOT_SUPPORTED="FAIRPLAY_NOT_SUPPORTED",e.FAIRPLAY_CERT_LOAD_ERROR="FAIRPLAY_CERT_LOAD_ERROR",e.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR="FAIRPLAY_CREATE_MEDIA_KEYS_ERROR",e.FAIRPLAY_CREATE_KEY_SESSION_ERROR="FAIRPLAY_CREATE_KEY_SESSION_ERROR",e.FAIRPLAY_SPC_LOAD_ERROR="FAIRPLAY_SPC_LOAD_ERROR",e.FAIRPLAY_CREATE_KEY_ERROR="FAIRPLAY_CREATE_KEY_ERROR",e.FAIRPLAY_INVALID_CONTENT_ID="FAIRPLAY_INVALID_CONTENT_ID",e.DRM_PROXY_ERROR="DRM_PROXY_ERROR",e.DRM_PROXY_ERROR_SIGNATURE_EXPIRED="DRM_PROXY_ERROR_SIGNATURE_EXPIRED",e.NO_HLS_JS_INSTANCE="NO_HLS_JS_INSTANCE",e.AD_IS_ALREADY_PLAYING="AD_IS_ALREADY_PLAYING",e.META_INFO_REQUEST_FAILED="META_INFO_REQUEST_FAILED",e.MULTIROLL_INIT_ERROR="MULTIROLL_INIT_ERROR",e.REACT_COMPONENT_DID_CATCH_ERROR_INFO="REACT_COMPONENT_DID_CATCH_ERROR_INFO",e.PLAY_AD_VIEWERS_ERROR="PLAY_AD_VIEWERS_ERROR",e.SAGA_ERROR="SAGA_ERROR",e.STRM_ABD_INVALID_RESPONSE="STRM_ABD_INVALID_RESPONSE",e.REPRESENTATION_CHANGE="REPRESENTATION_CHANGE",e.RECOVER_TASK_ERROR="RECOVER_TASK_ERROR",e.PRELOAD_SOURCE_FAILED="PRELOAD_SOURCE_FAILED",e.REGIONAL_LIMITATION_MANIFEST="REGIONAL_LIMITATION_MANIFEST",e.REGIONAL_LIMITATION_LEVEL="REGIONAL_LIMITATION_LEVEL",e.REGIONAL_LIMITATION_SEGMENT="REGIONAL_LIMITATION_SEGMENT",e.SIGNATURE_EXPIRED_MANIFEST="SIGNATURE_EXPIRED_MANIFEST",e.SIGNATURE_EXPIRED_LEVEL="SIGNATURE_EXPIRED_LEVEL",e.SIGNATURE_EXPIRED_SEGMENT="SIGNATURE_EXPIRED_SEGMENT",e.NO_STREAMS="NO_STREAMS",e.NO_CODECS="NO_CODECS",e.NO_MSE="NO_MSE",e.NO_DRM="NO_DRM",e.NO_PLAYABLE_STREAMS="NO_PLAYABLE_STREAMS",e.SHAKA_FILTER_ERROR="SHAKA_FILTER_ERROR",e.SHAKA_CONFIGURE_ERROR="SHAKA_CONFIGURE_ERROR",e.SHAKA_LOAD_SOURCE_ERROR="SHAKA_LOAD_SOURCE_ERROR",e.MEDIA_ERR_CUSTOM="MEDIA_ERR_CUSTOM",e.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",e.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",e.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",e.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",e.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED",e}({}),Os=function(e){return e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.BUFFER_STALLED_ERROR="bufferStalledError",e.SHAKA_VIDEO_ERROR_3016="shaka.VIDEO_ERROR_3016",e.FRAG_PARSING_ERROR="fragParsingError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.PIPELINE_ERROR_DECODE="PIPELINE_ERROR_DECODE",e.DECODER_ERROR_NOT_SUPPORTED="DECODER_ERROR_NOT_SUPPORTED",e.SHAKA_CONTENT_UNSUPPORTED_BY_BROWSER_4032="shaka.CONTENT_UNSUPPORTED_BY_BROWSER_4032",e.BUFFER_APPEND_ERROR="bufferAppendError",e.SHAKA_MEDIA_SOURCE_OPERATION_THREW_3015="shaka.MEDIA_SOURCE_OPERATION_THREW_3015",e.MEDIA_ELEMENT_ERROR_FORMAT_ERROR="MEDIA_ELEMENT_ERROR: Format error",e.REMUX_ALLOC_ERROR="remuxAllocError",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.DEMUXER_ERROR_COULD_NOT_OPEN="DEMUXER_ERROR_COULD_NOT_OPEN",e.NS_ERROR_DOM_INVALID_STATE_ERR="NS_ERROR_DOM_INVALID_STATE_ERR",e.SHAKA_DASH_INVALID_XML_4001="shaka.DASH_INVALID_XML_4001",e.SHAKA_QUOTA_EXCEEDED_ERROR_3017="shaka.QUOTA_EXCEEDED_ERROR_3017",e.CHUNK_DEMUXER_ERROR_APPEND_FAILED="CHUNK_DEMUXER_ERROR_APPEND_FAILED",e.FAILED_TO_INIT_DECODER="Failed to init decoder",e.PIPELINE_ERROR_INITIALIZATION_FAILED="PIPELINE_ERROR_INITIALIZATION_FAILED",e.NS_ERROR_FAILURE="NS_ERROR_FAILURE",e.SHAKA_MEDIA_SOURCE_OPERATION_FAILED_3014="shaka.MEDIA_SOURCE_OPERATION_FAILED_3014",e.REQUEST_FAILED="2147500036: Request failed",e.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED="PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED",e.PIPELINE_ERROR_COULD_NOT_RENDER="PIPELINE_ERROR_COULD_NOT_RENDER",e.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE="MEDIA_ELEMENT_ERROR: Empty src attribute",e.NS_ERROR_DOM_MEDIA_METADATA_ERR="NS_ERROR_DOM_MEDIA_METADATA_ERR",e.NS_ERROR_DOM_MEDIA_FATAL_ERR="NS_ERROR_DOM_MEDIA_FATAL_ERR",e.SHAKA_RESTRICTIONS_CANNOT_BE_MET_4012="shaka.RESTRICTIONS_CANNOT_BE_MET_4012",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.FRAG_LOAD_ERROR="fragLoadError",e.SHAKA_BAD_HTTP_STATUS_1001_MANIFEST="shaka.BAD_HTTP_STATUS_1001_MANIFEST",e.SHAKA_HTTP_ERROR_1002_SEGMENT="shaka.HTTP_ERROR_1002_SEGMENT",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.LEVEL_LOAD_ERROR="levelLoadError",e.SHAKA_HTTP_ERROR_1002_MANIFEST="shaka.HTTP_ERROR_1002_MANIFEST",e.SHAKA_BAD_HTTP_STATUS_1001_SEGMENT="shaka.BAD_HTTP_STATUS_1001_SEGMENT",e.SHAKA_UNSUPPORTED_SCHEME_1000="shaka.UNSUPPORTED_SCHEME_1000",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.SHAKA_TIMEOUT_1003_SEGMENT="shaka.TIMEOUT_1003_SEGMENT",e.FRAG_LOAD_TIME_OUT="fragLoadTimeOut",e.MANIFEST_LOAD_TIME_OUT="manifestLoadTimeOut",e.LEVEL_LOAD_TIME_OUT="levelLoadTimeOut",e.SHAKA_TIMEOUT_1003_MANIFEST="shaka.TIMEOUT_1003_MANIFEST",e.SHAKA_TIMEOUT_1003_LICENSE="shaka.TIMEOUT_1003_LICENSE",e.AUDIO_TRACK_LOAD_TIME_OUT="audioTrackLoadTimeOut",e.INTERNAL_EXCEPTION="internalException",e.SHAKA_OPERATION_ABORTED_7001="shaka.OPERATION_ABORTED_7001",e.ON_PLAYER_INIT_ERROR_INTERNAL="ON_PLAYER_INIT_ERROR_INTERNAL",e.UNABLE_TO_LOAD_PLAYER_IFRAME="UNABLE_TO_LOAD_PLAYER_IFRAME",e.ON_PLAYER_INIT_ERROR="ON_PLAYER_INIT_ERROR",e.LOADER_INIT_ERROR="LoaderInitError",e.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT="UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT",e.FAILED_TO_DOWNLOAD_DEBUG_INFO="FAILED_TO_DOWNLOAD_DEBUG_INFO",e.SHAKA_REQUEST_FILTER_ERROR_1006="shaka.REQUEST_FILTER_ERROR_1006",e.PLAYER_CONTAINER_NOT_FOUND="PLAYER_CONTAINER_NOT_FOUND",e.KEY_LOAD_ERROR="keyLoadError",e.FEATURE_HANDLER_ERROR="FEATURE_HANDLER_ERROR",e.SHAKA_NO_LICENSE_SERVER_GIVEN_6012="shaka.NO_LICENSE_SERVER_GIVEN_6012",e.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER="InvalidConfigElementInCreatePlayer",e.INVALID_CONFIG_LANG_IN_CREATE_PLAYER="InvalidConfigLangInCreatePlayer",e.INVALID_CONFIG_IN_CREATE_PLAYER="InvalidConfigInCreatePlayer",e.INVALID_CONFIG_IN_SET_SOURCE="InvalidConfigInSetSource",e.INVALID_CONFIG_IN_SOURCE_UPDATE="InvalidConfigInSourceUpdate",e.SHAKA_FAILED_TO_CREATE_CDM_6002="shaka.FAILED_TO_CREATE_CDM_6002",e.SHAKA_HTTP_ERROR_1002_LICENSE="shaka.HTTP_ERROR_1002_LICENSE",e.SHAKA_LICENSE_REQUEST_FAILED_6007="shaka.LICENSE_REQUEST_FAILED_6007",e.SHAKA_FAILED_TO_GENERATE_LICENSE_REQUEST_6006="shaka.FAILED_TO_GENERATE_LICENSE_REQUEST_6006",e.SHAKA_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001="shaka.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001",e.SHAKA_FAILED_TO_ATTACH_TO_VIDEO_6003="shaka.FAILED_TO_ATTACH_TO_VIDEO_6003",e.SHAKA_LICENSE_RESPONSE_REJECTED_6008="shaka.LICENSE_RESPONSE_REJECTED_6008",e.SHAKA_INVALID_SERVER_CERTIFICATE_6004="shaka.INVALID_SERVER_CERTIFICATE_6004",e.SHAKA_EXPIRED_6014="shaka.EXPIRED_6014",e.SHAKA_BAD_HTTP_STATUS_1001_LICENSE="shaka.BAD_HTTP_STATUS_1001_LICENSE",e.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.LOAD_SKIN_ERROR="LOAD_SKIN_ERROR",e.INSERT_INTO_WITH_SECURE_FRAME="INSERT_INTO_WITH_SECURE_FRAME",e.ELEMENT_NOT_IN_DOM="ELEMENT_NOT_IN_DOM",e.ERROR_SCREEN_LOAD_ERROR="ERROR_SCREEN_LOAD_ERROR",e}({});const ws={[Is.MEDIA]:"https://dzen.ru/help/troubleshooting/",[Is.NETWORK_MEDIA]:"https://dzen.ru/help/troubleshooting/",[Is.NETWORK_PLAYER]:"https://dzen.ru/help/troubleshooting/",[Is.NETWORK_TIMEOUT]:"https://dzen.ru/help/troubleshooting/",[Is.NO_CODECS]:"https://yandex.ru/search/?text=\u043a\u043e\u0434\u0435\u043a\u0438",[Is.UNSUPPORTED_ENV]:"https://yandex.ru/soft/browsers/",[Is.EXCEPTION]:"https://dzen.ru/help/troubleshooting/",[Is.DRM]:"https://dzen.ru/help/troubleshooting/",[Is.INVALID_STREAM_URL]:null},ks={[Is.DEFAULT]:"DEFAULT_ERROR_CATEGORY_TITLE",[Is.MEDIA]:"MEDIA_ERROR_CATEGORY_TITLE",[Is.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_TITLE",[Is.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_TITLE",[Is.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_TITLE",[Is.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_TITLE",[Is.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_TITLE",[Is.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_TITLE",[Is.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_TITLE",[Is.CONFIG]:"CONFIG_ERROR_CATEGORY_TITLE",[Is.REGIONAL]:"REGIONAL_ERROR_CATEGORY_TITLE",[Is.DRM]:"DRM_ERROR_CATEGORY_TITLE",[Is.ACCESS]:"ACCESS_ERROR_CATEGORY_TITLE",[Is.INVALID_STREAM_URL]:"CONFIG_ERROR_CATEGORY_TITLE"},Ds={[Is.DEFAULT]:"DEFAULT_ERROR_CATEGORY_MESSAGE",[Is.MEDIA]:"MEDIA_ERROR_CATEGORY_MESSAGE",[Is.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_MESSAGE",[Is.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_MESSAGE",[Is.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_MESSAGE",[Is.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_MESSAGE",[Is.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_MESSAGE",[Is.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_MESSAGE",[Is.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_MESSAGE",[Is.CONFIG]:"CONFIG_ERROR_CATEGORY_MESSAGE",[Is.DRM]:"DRM_ERROR_CATEGORY_MESSAGE",[Is.ACCESS]:"ACCESS_ERROR_CATEGORY_MESSAGE",[Is.INVALID_STREAM_URL]:"INVALID_STREAM_URL_ERROR_CATEGORY_MESSAGE"},Ns={[Is.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_HELP_LINK",[Is.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_HELP_LINK"};let Ls;const Ms=function(e){return void 0===e&&(e=window),Ls||(Ls=e.document.createElement("div")),Ls}(window),Vs=(e,t)=>{const i="undefined"!==typeof Ms.style[e];if(i&&t&&d(t))try{Ms.style.cssText=e+": "+t+";";const i=Boolean(Ms.style.cssText);return Ms.style.cssText="",i}catch(r){return!1}return i},xs=["","webkit","moz","o","ms"],Fs={},Us=function(e){return void 0===e&&(e=""),Fs[e]||function(e){const t=""+e[0].toUpperCase()+e.slice(1);for(let i=0;i<xs.length;i++){const r=xs[i],n=r?""+r+t:e;if(Vs(n))return Fs[e]=n}return Fs[e]=e}(e)},Bs=e(56),Hs=function(e){void 0===e&&(e=window);const t=Bs(e);return"boolean"===typeof t?-1:t},Gs=function(e){return void 0===e&&(e=window),-1!==Hs(e)}(),js=function(e){return void 0===e&&(e=window),o(e).includes("SamsungBrowser")}();let Ws=function(e,t,i){e.attachEvent("on"+t,i)},Ys=function(e,t,i){e.detachEvent("on"+t,i)};h(document,"addEventListener")&&h(document,"removeEventListener")&&(Ws=function(e,t,i,r){const n=e&&h(e,"addEventListener");n&&n.call(e,t,i,r)},Ys=function(e,t,i,r){const n=e&&h(e,"removeEventListener");n&&n.call(e,t,i,r)});let Ks=!1,zs=!1,qs=!1;try{if(function(e){void 0===e&&(e=window);const t=e.Object;try{const e={};return t.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(i){return!1}}()){const e=document.createElement("div"),t={};Object.defineProperty(t,"once",{get:()=>Ks=!0}),Object.defineProperty(t,"passive",{get:()=>zs=!0}),Object.defineProperty(t,"capture",{get:()=>qs=!0}),Ws(e,"click",p,t)}}catch(kE){}const Xs=(e,t,i)=>{const r=[];for(let n=0;n<e.length;n++){const o=e[n];t.call(i,o,n,e)&&r.push(o)}return r},Qs=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const{resolver:r,preparers:n}=m(t);let o,a=null,s=null;return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(a&&a.every((e,i)=>t[i]===e))return o;const l=n.map(e=>e(...t));if(s&&s.every((e,t)=>l[t]===e))return a=t,o;const d=r(...l);return a=t,s=l,o=d,d}},Js={xml:"http://www.w3.org/XML/1998/namespace",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},Zs={};A({xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type"},(function(e,t){const i=e.split(":"),r=Js[i[0]];r&&(Zs[t]=r)}));const $s="classList"in document.documentElement,el=Qs(e=>e.classList&&e.classList.add,u),tl=(Qs(e=>e.classList&&e.classList.remove,u),Qs(e=>e.classList&&e.classList.toggle,u),(()=>{const e=document.createElement("p");return!!$s&&(e.classList.add("c1","c2"),!!e.classList.contains("c2")&&(e.classList.toggle("c3",!1),!e.classList.contains("c3")))})()),il=((()=>{const e=document.createElement("p");!!$s&&(e.classList.toggle("a",!1),e.classList.contains("a"))})(),e=>e.split(" ").filter(e=>Boolean(e))),rl=tl?(e,t)=>{const i=il(t);e.classList.add(...i)}:(e,t)=>{const i=il(t);for(let r=0;r<i.length;r++)e.classList.add(i[r])},nl=e=>"hidden"in e?"hidden":"webkitHidden"in e?"webkitHidden":void 0,ol=e=>{try{const{left:t,right:i,top:r,bottom:n}=e.getBoundingClientRect();return{left:t,right:i,top:r,bottom:n,width:i-t,height:n-r}}catch(t){return{left:0,width:0,top:0,height:0,right:0,bottom:0}}},al=[].find,sl=u(al)?(e,t)=>al.call(e,t):(e,t)=>{for(let i=0;i<e.length;i++){const r=e[i];if(t(r,i,e))return r}};let ll;const dl=function(e){void 0===e&&(e=document.body);const t=function(e){const t=P(e);return t.width="0",t.height="0",t.style.position="absolute",t}(e);return{JSON:t.contentWindow.JSON,clean:()=>function(e){e.src="",_(e)}(t)}},cl=e=>t=>{const{JSON:i,clean:r}=dl();try{return i[e](t)}finally{r()}},ul="DEFAULT_ERROR_MESSAGE",hl=0,pl="",fl="?:?:?",gl=!0,vl=e(7186);class ml extends Error{constructor(e,t){void 0===t&&(t={});const i="object"===typeof e?e:{message:String(e||ul)};super(),vl(this,ml.prototype),this.message=t.message||i.message||ul,this.code=t.code||i.code||i.id||hl,this.isFatal=Boolean(function(e){const[t]=Xs(e,e=>void 0!==e);return t}([t.isFatal,i.isFatal,gl])),this.details=t.details||i.details||pl;const r=t.stack||i.stack||function(e){const{url:t,line:i,col:r,fileName:n,columnNumber:o,lineNumber:a}=e;return(t||n||"?")+":"+(i||a||"?")+":"+(r||o||"?")}(i);let n=r===fl?this.stack:r;if(n&&n!==fl)this.stack=n;else if(!this.stack)try{throw new Error(this.message)}catch(o){this.stack=n=o.stack||fl}this.toString=()=>C(this.toJSON()),this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:this.details,stack:n})}}const Al=h(Array,"isArray"),El=Boolean(Al)?e=>Al.call(Array,e):e=>"Array"===Ts(e),yl=function(e,t){void 0===e&&(e=document);const i=e.currentScript;if(i)return i;{const i=e.getElementsByTagName("script"),r=[];for(let e=0;e<i.length;e++)r.push(i[e]);if("function"===typeof t){const e=r.filter(t);return e[e.length-1]}return r[r.length-1]}}(),Sl=(yl&&yl.src,!u(Math.random)||Math.random()===Math.random()),Tl=Date&&n(Date.now)?()=>Date.now():()=>(new Date).getTime(),Rl="undefined"===typeof window?void 0:window.performance,Pl=Rl&&n(Rl.now),_l=Rl&&Rl.timing&&Rl.timing.navigationStart?Rl.timing.navigationStart:Tl();let bl=0;const Il=Pl?()=>Rl.now():()=>(()=>{const e=Tl()-_l;return bl=Math.max(e,bl),bl})();let Cl=Date.now()*Il()%2147483647;const Ol=Sl?function(){return Cl=16807*Cl%2147483647,(Cl-1)/2147483646}:function(){return Math.random()},wl=p,kl=p,Dl=p;(e=>{let{win:t,propertyName:i}=e})({propertyName:"YANDEX_DESTROYABLE_GLOBAL_CALLBACK_PROPERTY_NAME",win:window});class Nl{constructor(){this._isDestroyed=!1,this.destroyHandlers=[]}get destroyReason(){return this._destroyReason}get isDestroyed(){return this._isDestroyed}static addErrorHandler(e){Nl.errorHandlers.push(e)}onDestroy(e){this._addDestroyHandler(e)}addDestroyListener(e){this._addDestroyHandler(e)}addDestroyHandler(e){this._addDestroyHandler(e)}destroy(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r]=t;if(!this._isDestroyed){this._isDestroyed=!0,this._destroyReason=r;try{O(this.destroyHandlers,...t)}catch(kE){O(Nl.errorHandlers,kE)}this.destroyHandlers.length=0}}getIsDestroyed(){return this._isDestroyed}ignoreAfterDestroy(e){var t=this;let i=e;return function(){t.isDestroyed&&(i=p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];i.apply(t,r)}}_addDestroyHandler(e){this._isDestroyed?e(this._destroyReason):this.destroyHandlers.push(e)}}Nl.errorHandlers=[];class Ll{constructor(){this.on=[],this.once=[]}add(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.on.push(...t),()=>this.remove(...t)}addOne(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.once.push(...t),()=>this.remove(...t)}promise(){return new Promise(e=>this.addOne(e))}dispatch(e){const{once:t}=this;this.once=[],D(this.on,e),D(t,e)}removeAll(){this.on.length=0,this.once.length=0}remove(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.on=this.on.filter(e=>t.indexOf(e)<0),this.once=this.once.filter(e=>t.indexOf(e)<0)}}class Ml extends Ll{constructor(e,t){void 0===t&&(t=(e,t)=>e===t),super(),this.checkToEqualFunction=t,this.value=e}getValue(){return this.value}subscribeValueCondition(e,t){return this.add(i=>{e(i)&&k(t,i)})}subscribeValueConditionOnce(e,t){const i=this.subscribeValueCondition(e,e=>{i(),k(t,e)});return i}dispatch(e){this.checkToEqualFunction(this.value,e)||(this.value=e,super.dispatch(e))}}let Vl=0;const xl=[],Fl=L,Ul=L,Bl=L,Hl=L,Gl=L,jl=L,Wl=L,Yl=L,Kl=function(e){let t=e;for(let i=0;i<(arguments.length<=1?0:arguments.length-1);i++)t+=i+1<1||arguments.length<=i+1?void 0:arguments[i+1];return t};Kl.operator="+";const zl=function(e){let t=e;for(let i=0;i<(arguments.length<=1?0:arguments.length-1);i++)t-=i+1<1||arguments.length<=i+1?void 0:arguments[i+1];return t};zl.operator="-";const ql=function(e){let t=e;for(let i=0;i<(arguments.length<=1?0:arguments.length-1);i++)t*=i+1<1||arguments.length<=i+1?void 0:arguments[i+1];return t};ql.operator="*";const Xl=function(e){let t=e;for(let i=0;i<(arguments.length<=1?0:arguments.length-1);i++)t/=i+1<1||arguments.length<=i+1?void 0:arguments[i+1];return t};Xl.operator="/";class Ql extends Nl{constructor(e){super(),this.onResize=void 0,this.resizeObserverCallback=e=>{let[{contentRect:{width:t,height:i}}]=e;this.onResize.dispatch({width:Yl(t),height:Yl(i)})};const t=ol(e);if(this.onResize=new Ml({width:Yl(t.width),height:Yl(t.height)},(e,t)=>{let{width:i,height:r}=t;return!!(isNaN(i)||isNaN(r)||i<1||r<1)||e.width===i&&e.height===r}),this.addDestroyHandler(()=>{this.onResize.removeAll()}),"undefined"!==typeof ResizeObserver)try{const t=new ResizeObserver(this.resizeObserverCallback);t.observe(e),this.addDestroyHandler(()=>{t.disconnect()})}catch(kE){this.fallbackToCustomDetectionMethods(e)}else this.fallbackToCustomDetectionMethods(e)}getSize(){return F({},this.onResize.getValue())}fallbackToCustomDetectionMethods(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:i}=t;if(!i)return;const r=()=>{const t=ol(e);this.onResize.dispatch({width:Yl(t.width),height:Yl(t.height)})};this.addDestroyHandler(f(i,"resize",r,{passive:!0})),this.addDestroyHandler(N(r))}}const Jl=e=>(e=>e instanceof Promise||"Promise"===Ts(e)&&Boolean(i(()=>u(e.constructor))))(e)||(e=>Boolean(i(()=>n(e.then)&&n(e.catch))))(e),Zl=e=>{let t=0;return{promise:new Promise(i=>{t=window.setTimeout(i,e)}),clear(){clearTimeout(t)},timeoutId:t}};let $l=function(e){return e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end",e}({}),ed=function(e){return e.ALL="*",e.PLAY="play",e.START_SCREEN_PLAY="startScreenPlay",e.VOLUME="sound",e.VOLUME_SLIDER="volumeSlider",e.VIDEO_QUALITY_SURVEY="videoQualitySurvey",e.SETTINGS="settings",e.SETTINGS_ITEM="settingsItem",e.FULLSCREEN="fullscreen",e.TIMELINE="timeline",e.TIMELINE_PREVIEW="timelinePreview",e.LIVE="live",e.POSTER="poster",e.START_POSITION_CONFIRM="startPositionConfirm",e.TIME_DISPLAY="time",e.TITLE_DISPLAY="titleDisplay",e.REPORT="report",e.FORWARD="forward",e.BACKWARD="backward",e.LOGO="logo",e.PRELOADER="preloader",e.CONTEXT_MENU="contextMenu",e.START_SCREEN="startScreen",e.PLAYBACK_RATE="playbackRate",e.SKIPPABLE_FRAGMENTS="skippableFragments",e.EXTERNAL_PLAYBACK="externalPlayback",e.RECOMMENDATIONS="recommendations",e.CLOSE_BUTTON="closeButton",e.NEXT_AD_INFO="nextAdInfo",e.SUBTITLES_TOGGLE="subtitlesToggle",e.LOGO_WIDGET="logoWidget",e.SKIP_AD="skipAd",e.MOBILE_SEEK_BUTTONS="mobileSeekButtons",e.TITLE="title",e}({});const td=v(ed).map(e=>ed[e]),id=e=>td.every(t=>e.includes(t)),rd=["","-webkit-","-ms-","-moz-","-o-"],nd=rd.map(e=>"("+e+"any-pointer:coarse)").join(","),od=rd.map(e=>"("+e+"touch-enabled)").join(","),ad=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase();if(t.includes("android"))return!1;const i=t.replace(/\(.+?\)/gi,"").split(" ").map(e=>e.trim().split("/")[0]).filter(e=>e&&"mobile"!==e);return 4===i.length&&"mozilla"===i[0]&&"applewebkit"===i[1]&&"version"===i[2]&&"safari"===i[3]},sd=function(e){return void 0===e&&(e=window),ad(e)||Y(e)||function(e){return void 0===e&&(e=window),e.navigator.vendor.includes("Apple")&&W(e)}(e)}(),ld=sd?"":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";class dd{constructor(){this.resolve=void 0,this.reject=void 0,this.promise=void 0;let e=p,t=p;this.promise=new Promise((i,r)=>{e=i,t=r}),this.resolve=e,this.reject=t}}const cd=15,ud=1500,hd=X(),pd=function(e){void 0===e&&(e=window);const{platform:t=""}=e.navigator||{};return function(e){void 0===e&&(e=window);const{vendor:t=""}=e.navigator||{};return 0===t.indexOf("Google")}(e)&&!X(e)&&0===t.indexOf("Linux ")&&W(e)}(),fd=Y(),gd=navigator&&"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,vd=pd||hd||fd||gd;let md=function(e){return e.Space="Space",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowRight="ArrowRight",e.ArrowLeft="ArrowLeft",e.KeyF="KeyF",e.Tab="Tab",e.Escape="Escape",e.Enter="Enter",e}({});const Ad={9:md.Tab,13:md.Enter,27:md.Escape,32:md.Space,37:md.ArrowLeft,38:md.ArrowUp,39:md.ArrowRight,40:md.ArrowDown,70:md.KeyF},Ed=["keyup","keydown"],yd=["mousemove","click","dblclick","mouseenter","mouseleave","contextmenu"],Sd=["touchstart","touchend","longtouch"];class Td{constructor(){this.handlers=Object.create(null),this.onceHandlers=Object.create(null),this.maxEventListeners=10}setMaxListeners(e){!isFinite(e)||e<=0||(this.maxEventListeners=e)}on(e,t){this.getHandlers(e).push(t),this.checkSubscriptions(e)}once(e,t){this.getOnceHandlers(e).push(t),this.checkSubscriptions(e)}off(e,t){const i=this.getHandlers(e),r=this.getOnceHandlers(e);if(void 0===t)return i.length=0,void(r.length=0);this.removeHandler(t,i),this.removeHandler(t,r)}emit(e,t){const i=this.getHandlers(e),r=this.getOnceHandlers(e).slice();this.getOnceHandlers(e).length=0,i.slice().concat(r).forEach(e=>{try{e(t)}catch(kE){setTimeout(()=>{throw kE},0)}})}getHandlers(e){return void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e]}getOnceHandlers(e){return void 0===this.onceHandlers[e]&&(this.onceHandlers[e]=[]),this.onceHandlers[e]}checkSubscriptions(e){const t=this.getHandlers(e).length+this.getOnceHandlers(e).length;t>this.maxEventListeners&&console.warn("There are "+t+" subscriptions on event named "+String(e))}removeHandler(e,t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}class Rd extends Td{destroy(){this.emit("Destroy")}}class Pd extends Rd{constructor(e){super(),this.clickElement=e,this.createKeyboardEventHandler=e=>t=>{const i="code"in(r=t)&&r.code?r.code in md?r.code:void 0:Ad[r.which||r.keyCode];var r;void 0!==i&&(i!==md.Tab&&t.preventDefault(),this.emit("Event",{type:e,event:{keyName:i,preventDefault:Q}}))},this.createMouseEventHandler=e=>"contextmenu"===e?e=>this.handleContextMenuMouseEvent(e):t=>this.handleMouseEvent(e,t),this.handleMouseEvent=(e,t)=>{if(!(i=t.target)||i.ownerDocument&&i.ownerDocument.compareDocumentPosition(i)&i.DOCUMENT_POSITION_DISCONNECTED)return;var i;const{clientX:r,clientY:n}=function(e,t){const{top:i,left:r}=e.getBoundingClientRect();return{clientX:t.clientX-r,clientY:t.clientY-i}}(this.clickElement,t);this.emit("Event",{type:e,event:{clientX:r,clientY:n,preventDefault:Q}})},this.handleContextMenuMouseEvent=e=>{e.ctrlKey||e.altKey||(e.preventDefault(),this.handleMouseEvent("contextmenu",e))},this.handleLongTouch=e=>{const t=[{clientX:0,clientY:0}],i={touches:e&&"touches"in e?e.touches:t,changedTouches:e&&"changedTouches"in e?e.changedTouches:t,cancelable:!1,preventDefault:Q};this.handleTouchEvent("longtouch",i)},this.createTouchEventHandler=e=>t=>this.handleTouchEvent(e,t),this.handleTouchEvent=(e,t)=>{const{touches:i,changedTouches:r}=function(e,t){const{top:i,left:r}=e.getBoundingClientRect();return{touches:Array.from(t.touches).map(e=>{let{clientX:t,clientY:n}=e;return{clientX:t-r,clientY:n-i}}),changedTouches:Array.from(t.changedTouches).map(e=>{let{clientX:t,clientY:n}=e;return{clientX:t-r,clientY:n-i}})}}(this.clickElement,t);this.emit("Event",{type:e,event:{touches:"touchend"===e?[]:i,changedTouches:"touchstart"===e?[]:r,preventDefault:()=>{try{if(!t.cancelable)return;t.preventDefault()}catch(e){}}}})},this.setMaxListeners(11),yd.forEach(t=>{"contextmenu"===t&&vd||this.once("Destroy",f(e,t,this.createMouseEventHandler(t)))}),Sd.forEach(t=>{"longtouch"!==t?this.once("Destroy",f(e,t,this.createTouchEventHandler(t),{capture:!0,passive:!1})):this.once("Destroy",q(e,this.handleLongTouch,{touchesCount:2,handleContextmenu:!1}))}),Ed.forEach(t=>{this.once("Destroy",f(e,t,this.createKeyboardEventHandler(t)))})}}let _d=function(e){return e.Click="click",e.DoubleClick="dblclick",e.MouseMove="mousemove",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.ContextMenu="contextmenu",e}({});const bd=Gl(300),Id=Xl(bd,3/4);class Cd extends Td{static calculateEventSlop(e,t){let{event:i}=e,{event:r}=t;const n=i.touches[0]||i.changedTouches[0],o=r.touches[0]||r.changedTouches[0],a=Math.abs(n.clientX-o.clientX),s=Math.abs(n.clientY-o.clientY);return a*a+s*s}constructor(e){super(),this.timeoutId=void 0,this.firstTouchStartEvent=void 0,this.firstTouchStopEvent=void 0,this.secondTouchStartEvent=void 0,this.skipNextClick=!1,this.handleClickerEvent=e=>{if(function(e){return yd.includes(e.type)}(e)&&this.handleMouseEvent(e),function(e){return Sd.includes(e.type)}(e))switch(e.timeStamp=Gl(Date.now()),e.type){case"touchstart":this.handleTouchStart(e);break;case"touchend":this.handleTouchEnd(e);break;case"longtouch":this.dispatchEvent(J({},e,{type:_d.ContextMenu,event:J({},e.event,Z(e))}))}},this.handleTouchEnd=e=>{this.firstTouchStartEvent&&(this.firstTouchStopEvent||(this.firstTouchStopEvent=e))},this.handleTouchStart=e=>{if(this.skipNextClick=!0,this.firstTouchStartEvent||this.timeoutId){if(this.secondTouchStartEvent)return;{this.secondTouchStartEvent=e;const t=this.isConsideredDoubleTap();this.reset(),t&&this.dispatchEvent(J({},e,{type:_d.DoubleClick,event:J({},e.event,Z(e))}))}}else this.firstTouchStartEvent=e,this.timeoutId=window.setTimeout(this.handleTimeout,bd)},this.handleTimeout=()=>{const e=Boolean(this.firstTouchStartEvent&&this.firstTouchStopEvent&&!this.secondTouchStartEvent),t=this.areFirstTapsInSameBox(),i=e&&this.firstTouchStopEvent.timeStamp-this.firstTouchStartEvent.timeStamp<=Id,r=e&&t&&i,n=this.firstTouchStopEvent;this.reset(),r&&this.dispatchEvent(J({},n,{type:_d.Click,event:J({},n.event,Z(n))}))};const{eventListener:t}=e;this.once("Destroy",()=>this.reset()),t.on("Event",this.handleClickerEvent),this.once("Destroy",()=>t.off("Event",this.handleClickerEvent))}destroy(){this.emit("Destroy")}handleMouseEvent(e){this.skipNextClick?e.type===_d.Click&&(this.skipNextClick=!1):this.dispatchEvent(e)}dispatchEvent(e){-1!==e.event.clientX&&-1!==e.event.clientY&&this.emit("Event",e)}areFirstTapsInSameBox(){if(!this.firstTouchStartEvent||!this.firstTouchStopEvent)return!1;return Cd.calculateEventSlop(this.firstTouchStartEvent,this.firstTouchStopEvent)<=32}isConsideredDoubleTap(){if(!this.firstTouchStartEvent||!this.firstTouchStopEvent||!this.secondTouchStartEvent)return!1;if(!this.areFirstTapsInSameBox())return!1;if(!(Cd.calculateEventSlop(this.firstTouchStartEvent,this.secondTouchStartEvent)<=300))return!1;return!(this.secondTouchStartEvent.timeStamp-this.firstTouchStartEvent.timeStamp>bd)}reset(){window.clearTimeout(this.timeoutId),this.timeoutId=void 0,this.firstTouchStartEvent=void 0,this.firstTouchStopEvent=void 0,this.secondTouchStartEvent=void 0}}class Od extends Nl{constructor(e){super(),this.clickElement=e;const t=new Pd(this.clickElement);this.addDestroyHandler(()=>t.destroy());const i=new Cd({eventListener:t});this.addDestroyHandler(()=>i.destroy());const r=e=>{e.type===_d.DoubleClick&&e.event.preventDefault()};i.on("Event",r),this.addDestroyHandler(()=>i.off("Event",r))}}class wd{constructor(){this.resolve=void 0,this.reject=void 0,this.promise=void 0;let e=p,t=p;this.promise=new Promise((i,r)=>{e=i,t=r}),this.resolve=e,this.reject=t}}class kd{constructor(){this.stopReasonInternal=void 0,this.stopDeferred=new wd}stop(e){this.stopReasonInternal=e,this.stopDeferred.resolve(e)}get stopReason(){return this.stopReasonInternal}get stopPromise(){return this.stopDeferred.promise}}const Dd=200;var Nd="function"===typeof Symbol&&Symbol.observable||"@@observable",Ld=function(){return Math.random().toString(36).substring(7).split("").join(".")},Md={INIT:"@@redux/INIT"+Ld(),REPLACE:"@@redux/REPLACE"+Ld(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ld()}},Vd=function(e){return"@@redux-saga/"+e},xd=Vd("CANCEL_PROMISE"),Fd=Vd("CHANNEL_END"),Ud=Vd("IO"),Bd=Vd("MATCH"),Hd=Vd("MULTICAST"),Gd=Vd("SAGA_ACTION"),jd=Vd("SELF_CANCELLATION"),Wd=Vd("TASK"),Yd=Vd("TASK_CANCEL"),Kd=Vd("TERMINATE"),zd=Vd("LOCATION"),qd=function(e){return null===e||void 0===e},Xd=function(e){return null!==e&&void 0!==e},Qd=function(e){return"function"===typeof e},Jd=function(e){return"string"===typeof e},Zd=Array.isArray,$d=function(e){return e&&Qd(e.then)},ec=function(e){return e&&Qd(e.next)&&Qd(e.throw)},tc=function e(t){return t&&(Jd(t)||nc(t)||Qd(t)||Zd(t)&&t.every(e))},ic=function(e){return e&&Qd(e.take)&&Qd(e.close)},rc=function(e){return Qd(e)&&e.hasOwnProperty("toString")},nc=function(e){return Boolean(e)&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype};const oc=function(e,t){var i;void 0===t&&(t=!0);var r=new Promise((function(r){i=setTimeout(r,Math.min(2147483647,e),t)}));return r[xd]=function(){clearTimeout(i)},r};var ac=function(e){return function(){return e}}(!0),sc=function(){};var lc=function(e){return e},dc=("function"===typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator,function(e,t){pe(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach((function(i){e[i]=t[i]}))}),cc=function(e){throw e},uc=function(e){return{value:e,done:!0}},hc=function(e){return Array.apply(null,new Array(e))},pc=function(e){return function(t){return e(Object.defineProperty(t,Gd,{value:!0}))}},fc=function(e){return e===Kd},gc=function(e){return e===Yd},vc=function(e){return fc(e)||gc(e)},mc=function(e){return Se(e,4)},Ac=function(e,t){var i;return(i={})[Ud]=!0,i.combinator=!1,i.type=e,i.payload=t,i},Ec=be.bind(null,oc);const yc=ke;var Sc,Tc=[],Rc=0,Pc=function(e){return function(t){return e.some((function(e){return Fe(e)(t)}))}},_c=function(e){return function(t){return e(t)}},bc=function(e){return function(t){return t.type===String(e)}},Ic=function(e){return function(t){return t.type===e}},Cc=function(){return ac},Oc={type:Fd},wc=function(e){return e&&e.type===Fd},kc=0,Dc=function(){return++kc},Nc=((Sc={}).TAKE=function(e,t,i){var r=t.channel,n=void 0===r?e.channel:r,o=t.pattern,a=t.maybe,s=function(e){e instanceof Error?i(e,!0):!wc(e)||a?i(e):i(Kd)};try{n.take(s,Xd(o)?Fe(o):null)}catch(l){return void i(l,!0)}i.cancel=s.cancel},Sc.PUT=function(e,t,i){var r=t.channel,n=t.action,o=t.resolve;Ne((function(){var t;try{t=(r?r.put:e.dispatch)(n)}catch(kE){return void i(kE,!0)}o&&$d(t)?He(t,i):i(t)}))},Sc.ALL=function(e,t,i,r){var n=r.digestEffect,o=kc,a=Object.keys(t);if(0!==a.length){var s=me(t,i);a.forEach((function(e){n(t[e],o,s[e],e)}))}else i(Zd(t)?[]:{})},Sc.RACE=function(e,t,i,r){var n=r.digestEffect,o=kc,a=Object.keys(t),s=Zd(t)?hc(a.length):{},l={},d=!1;a.forEach((function(e){var t=function(t,r){d||(r||vc(t)?(i.cancel(),i(t,r)):(i.cancel(),d=!0,s[e]=t,i(s)))};t.cancel=sc,l[e]=t})),i.cancel=function(){d||(d=!0,a.forEach((function(e){return l[e].cancel()})))},a.forEach((function(e){d||n(t[e],o,l[e],e)}))},Sc.CALL=function(e,t,i,r){var n=t.context,o=t.fn,a=t.args,s=r.task;try{var l=o.apply(n,a);if($d(l))return void He(l,i);if(ec(l))return void ze(e,l,s.context,kc,Ae(o),!1,i);i(l)}catch(kE){i(kE,!0)}},Sc.CPS=function(e,t,i){var r=t.context,n=t.fn,o=t.args;try{var a=function(e,t){qd(e)?i(t):i(e,!0)};n.apply(r,o.concat(a)),a.cancel&&(i.cancel=a.cancel)}catch(kE){i(kE,!0)}},Sc.FORK=function(e,t,i,r){var n=t.context,o=t.fn,a=t.args,s=t.detached,l=r.task,d=function(e){var t=e.context,i=e.fn,r=e.args;try{var n=i.apply(t,r);if(ec(n))return n;var o=!1;return ge((function(e){return o?{value:e,done:!0}:(o=!0,{value:n,done:!$d(n)})}))}catch(a){return ge((function(){throw a}))}}({context:n,fn:o,args:a}),c=function(e,t){return e.isSagaIterator?{name:e.meta.name}:Ae(t)}(d,o);Le((function(){var t=ze(e,d,l.context,kc,c,s,void 0);s?i(t):t.isRunning()?(l.queue.addTask(t),i(t)):t.isAborted()?l.queue.abort(t.error()):i(t)}))},Sc.JOIN=function(e,t,i,r){var n=r.task,o=function(e,t){if(e.isRunning()){var i={task:n,cb:t};t.cancel=function(){e.isRunning()&&fe(e.joiners,i)},e.joiners.push(i)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(Zd(t)){if(0===t.length)return void i([]);var a=me(t,i);t.forEach((function(e,t){o(e,a[t])}))}else o(t,i)},Sc.CANCEL=function(e,t,i,r){var n=r.task;t===jd?Ge(n):Zd(t)?t.forEach(Ge):Ge(t),i()},Sc.SELECT=function(e,t,i){var r=t.selector,n=t.args;try{i(r.apply(void 0,[e.getState()].concat(n)))}catch(kE){i(kE,!0)}},Sc.ACTION_CHANNEL=function(e,t,i){var r=t.pattern,n=Ue(t.buffer),o=Fe(r),a=function t(i){wc(i)||e.channel.take(t,o),n.put(i)},s=n.close;n.close=function(){a.cancel(),s()},e.channel.take(a,o),i(n)},Sc.CANCELLED=function(e,t,i,r){i(r.task.isCancelled())},Sc.FLUSH=function(e,t,i){t.flush(i)},Sc.GET_CONTEXT=function(e,t,i,r){i(r.task.context[t])},Sc.SET_CONTEXT=function(e,t,i,r){var n=r.task;dc(n.context,t),i()},Sc),Lc=null,Mc=[],Vc=function(e){e.crashedEffect=Lc,Mc.push(e)},xc=function(){Lc=null,Mc.length=0},Fc=function(){var e=Mc[0],t=Mc.slice(1),i=e.crashedEffect?function(e){var t=Ee(e);return t?t.code+"  "+je(t.fileName,t.lineNumber):""}(e.crashedEffect):null;return["The above error occurred in task "+We(e.meta)+(i?" \n when executing effect "+i:"")].concat(t.map((function(e){return"    created by "+We(e.meta)})),[Ye(Mc)]).join("\n")};const Uc=function(e){function t(e){var t=e.getState,r=e.dispatch;return i=qe.bind(null,pe({},d,{context:o,channel:s,dispatch:r,getState:t,sagaMonitor:l})),function(e){return function(t){l&&l.actionDispatched&&l.actionDispatched(t);var i=e(t);return s.put(t),i}}}var i,r=void 0===e?{}:e,n=r.context,o=void 0===n?{}:n,a=r.channel,s=void 0===a?Be():a,l=r.sagaMonitor,d=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(r,["context","channel","sagaMonitor"]);return t.run=function(){return i.apply(void 0,arguments)},t.setContext=function(e){dc(o,e)},t};var Bc=function(e){return{done:!0,value:e}},Hc={};class Gc extends ml{constructor(e,t){super(e,t),this.category=void 0,this.toJSON=void 0,this.category=a(this.code),this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:i(()=>d(this.details)?this.details:JSON.stringify(this.details))||this.details,stack:this.stack,category:this.category})}}class jc extends Gc{}var Wc={},Yc={checkExisting:!0},Kc=0,zc=function(e){return e},qc=function(e){return e&&"function"===typeof e.dispatch?e.dispatch:e},Xc=function(e){return Array.isArray(e)?e.map(qc):qc(e)};const Qc=ot("Batch",(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 1===t.length&&Array.isArray(t[0])?t[0]:t}));var Jc=Qc.getType(),Zc={},$c=function(e){"function"===typeof console[e]&&(Zc[e]=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=i.pop();Array.isArray(n)&&n.type===Jc?n.forEach((function(t){console[e].apply(console,[].concat(i,[t]))})):(i.push(n),console[e].apply(console,i))})};for(var eu in console)$c(eu);const tu=ot("PING_STRM_AND_RECOVER_BY_ONLINE"),iu=ot("STORE_AD_CONFIG"),ru=ot("STORE_UPDATE_AD_INFO"),nu=ot("STORE_PUT_AD_INFO"),ou=ot("STORE_PUT_IS_ORIGINAL_BROADCAST_AD_CUE_ID"),au=ot("STORE_PUT_ADBLOCK_DETECTED"),su=ot("STORE_PUT_ORIGINAL_BROADCAST_AD_CUES"),lu=ot("STORE_REFRESH_CUE"),du=ot("STORE_REMOVE_CUE"),cu=ot("STORE_PUT_HAS_PREROLL"),uu=ot("STORE_PUT_AD_SYNC_INIT"),hu=ot("STORE_UPDATE_ORIGINAL_AD_STATE"),pu=ot("STORE_PUT_NATIVE_AD_CONTROLS_VISIBILITY"),fu=ot("STORE_PUT_LAST_KNOWN_BANDWIDTH_ESTIMATE"),gu=ot("STORE_AD_PUT_IN_STREAM_PLAYING_STATE"),vu=ot("STORE_PUT_NEXT_AD_INFO"),mu=ot("STORE_PUT_DELAYED_NEXT_AD_INFO"),Au=ot("STORE_PUT_DELAYED_MIDROLL_AD_VIEWERS"),Eu=ot("STORE_PUT_DELAY_UNTIL_POSITION"),yu=ot("STORE_PUT_DELAY_UNTIL_WATCHED_TIME"),Su=ot("CLEAR_DELAYED_AD_STATE"),Tu=ot("STORE_PUT_ENGINE"),Ru=ot("STORE_PUT_AUTOPLAY"),Pu=ot("STORE_PUT_START_STAGE"),_u=ot("STORE_PUT_PRELOAD"),bu=ot("STORE_PUT_ENCODER_STATE"),Iu=ot("STORE_ENCODER_ATTACHED"),Cu=ot("STORE_PUT_VOLUME_INFO"),Ou=ot("STORE_PUT_AUTOPLAY_IMPOSSIBLE"),wu=ot("STORE_PUT_USER_VOLUME"),ku=ot("STORE_PUT_DURATION"),Du=ot("STORE_PUT_VIDEO_SIZES"),Nu=ot("STORE_PUT_VIDEO_TYPE"),Lu=ot("STORE_PUT_PLAYING_STATE"),Mu=ot("STORE_PUT_CURRENT_TIME"),Vu=ot("STORE_PUT_CURRENT_TIME_LOW_QUALITY"),xu=ot("STORE_PUT_FROM"),Fu=ot("STORE_PUT_STREAM"),Uu=ot("STORE_PUT_SOURCE_PARAMS"),Bu=ot("STORE_UPDATE_SOURCE_ID"),Hu=ot("STORE_PUT_STREAMS"),Gu=ot("STORE_PUT_STREAMS_WITH_SUPPORT_INFO"),ju=ot("STORE_PUT_START_POSITION"),Wu=ot("STORE_PUT_IS_ONLINE"),Yu=ot("STORE_PUT_FRAGMENT_DURATION"),Ku=ot("STORE_PUT_PROGRAM_DATE_TIME"),zu=ot("STORE_PUT_DVR_START_TIME"),qu=ot("STORE_PUT_DVR_DURATION"),Xu=ot("STORE_PUT_SKIN_DVR_START_TIME"),Qu=ot("STORE_PUT_SKIN_DVR_DURATION"),Ju=ot("STORE_PUT_PLAYBACK_RATE"),Zu=ot("STORE_PUT_BUFFERING_RANGES"),$u=ot("STORE_PUT_ERROR_INFO"),eh=ot("STORE_PUT_LAST_RECOVER_POSITION"),th=ot("STORE_PUT_IS_ABR_SUPPORTED"),ih=ot("STORE_PUT_IS_ABR_ENABLED"),rh=ot("STORE_PUT_VIDEO_TRACK"),nh=ot("STORE_PUT_VIDEO_TRACKS",e=>[...e].sort(ct)),oh=ot("STORE_PUT_USER_VIDEO_TRACK_PARAMS"),ah=ot("STORE_PUT_AUDIO_TRACK_VALUE"),sh=ot("STORE_PUT_AUDIO_TRACKS"),lh=ot("STORE_PUT_USER_AUDIO_TRACK_PARAMS"),dh=ot("STORE_PUT_TEXT_TRACKS"),ch=ot("STORE_PUT_TEXT_TRACK_ENABLED"),uh=ot("STORE_PUT_NATIVE_TEXT_TRACK_VISIBILITY"),hh=ot("STORE_PUT_FEED"),ph=ot("STORE_PUT_TEXT_TRACK_VALUE"),fh=ot("STORE_PUT_USER_TEXT_TRACK_PARAMS"),gh=ot("ENABLE_TEXT_TRACK"),vh=ot("STORE_PUT_IS_FULLSCREEN"),mh=ot("STORE_PUT_IS_PIP"),Ah=ot("STORE_PUT_IS_VISIBLE"),Eh=ot("STORE_PUT_IS_DOCUMENT_VISIBLE"),yh=ot("STORE_PUT_PREVIEW"),Sh=ot("STORE_PUT_WATCHED_TIME"),Th=ot("STORE_PUT_RESOURCES_IDLE"),Rh=ot("STORE_PUT_HIDDEN_CONTROLS"),Ph=ot("STORE_PUT_HIDE_CONTROLS"),_h=ot("STORE_PUT_SHOW_SKIP_AD_BUTTON"),bh=ot("STORE_PUT_SHOW_AD_SKIN"),Ih=ot("STORE_PUT_NATIVE_CONTROLS_VISIBILITY"),Ch=ot("STORE_PUT_VIDEO_ELEMENT_STYLE"),Oh=ot("STORE_ON_VIDEO_TAG_PLAYING_STATE_CHANGE"),wh=ot("STORE_PUT_PRELOAD_DETAILS"),kh=ot("STORE_PUT_PLAYER_CONFIG_EPISDOES"),Dh={inStreamPlayingState:void 0,adConfig:void 0,adInfo:void 0,originalBroadcastAdCueId:void 0,originalBroadcastAdCues:{},adblockDetected:!1,hasPreroll:!1,adSyncInit:!1,nextAdInfo:void 0,nativeAdControlsVisibility:!0,delayedNextAdInfo:void 0,delayedMidrollAdViewers:void 0},Nh=Wl(jl(Math.max(0,0))),Lh=M(jl(5)),Mh="0000000000000000000000000000000000000000000000000000000000000000";let Vh=function(e){return e.init="init",e.waitForUserPlay="waitForUserPlay",e.waitForDocumentVisibility="waitForDocumentVisibility",e.starting="starting",e.started="started",e.broken="broken",e.destroyed="destroyed",e}({}),xh=function(e){return e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached",e}({}),Fh=function(e){return e.Init="Init",e.SetSource="SetSource",e.Seek="Seek",e.VideoTrackChange="VideoTrackChange",e.AudioTrackChange="AudioTrackChange",e.Recover="Recover",e.MediaError="MediaError",e.Offline="Offline",e.Other="Other",e.RepresentationsChange="RepresentationsChange",e.LiveEdge="LiveEdge",e.AdStart="AdStart",e.AdOther="AdOther",e.AdBetween="AdBetween",e.AdEnd="AdEnd",e}({});const Uh={autoplay:!1,initialAutoplay:!1,allowMuted:!0,autoplayImpossible:!1,startStage:Vh.init,preload:!0,from:void 0,encoderState:xh.Detached,vsid:Mh,streams:[],stream:void 0,streamBlock:"",sourceParams:void 0,sourceId:0,volume:1,muted:!1,userVolume:NaN,duration:jl(NaN),currentTime:Nh,currentTimeLowGranularity:Nh,watchedTime:jl(0),startPosition:{},programDateTime:void 0,fragmentDuration:Lh,dvrStartTime:jl(0),dvrDuration:jl(NaN),videoType:void 0,playingState:$l.PAUSE,bufferingRanges:[],preview:ld,isFullscreen:!1,isPip:!1,isVisible:void 0,togglePlaybackOnVisibilityChangeSetting:void 0,errorInfo:{},lastRecoverPosition:void 0,isOnline:!0,isDocumentVisible:!0,lastKnownBandwidthEstimate:{value:Ul(NaN),source:"default"},isAbrSupported:!1,isAbrEnabled:!1,defaultQuality:void 0,feed:!1,videoTrackValue:void 0,videoTracks:[],userVideoTrackName:void 0,userVideoTrackHeight:void 0,audioTrackValue:void 0,audioTracks:[],userAudioTrackName:void 0,userAudioTrackLang:void 0,textTrackEnabled:!1,nativeTextTrackVisible:void 0,textTrackValue:void 0,textTracks:[],userTextTrackEnabled:void 0,userTextTrackLang:void 0,userTextTrackName:void 0,playbackRate:1,expectedStalled:ut(Fh.Init,void 0),videoWidth:Yl(0),videoHeight:Yl(0),playerConfig:void 0,preloadDetails:void 0,yaDirectPixelUrl:"",yaDirectPixelData:{},vid:"123",dzenuid:"12345",ea:"40",eg:"2"};let Bh=function(e){return e.LIVE="LIVE",e.EVENT="EVENT",e.VOD="VOD",e}({});const Hh=function(e,t){let i=e[t];if(!u(i)){const n=i;try{delete e[t],i=e[t],e[t]=n}catch(r){}}return i}(Object,"create")?Object.create:function(e,t){function i(){}if(i.prototype=e,I(t))for(const r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);return new i},Gh=e=>e instanceof Date||"Date"===Ts(e),jh=function e(t,i){void 0===i&&(i={preserveConstructors:!0});let r=t;if(El(t)){return t.map(t=>e(t,i))}return Gh(t)?new Date(t.getTime()):(!n(t)&&I(t)&&(r=i.preserveConstructors?Hh(t):{},A(t,(t,n)=>{r[n]=e(t,i)})),r)};let Wh=function(e){return e[e.PLAYING=1]="PLAYING",e[e.NOT_PLAYING=2]="NOT_PLAYING",e}({}),Yh=function(e){return e.INIT="INIT",e.SET_SOURCE="SET_SOURCE",e}({}),Kh=function(e){return e.preroll="preroll",e.midroll="midroll",e.postPauseroll="postPauseroll",e.postroll="postroll",e.inroll="inroll",e}({});const zh=Gl(5e3);class qh{constructor(e){this.cache=e}get(e){return this.cache[e]}has(e){return e in this.cache}set(e,t){this.cache[e]=t}}const Xh=document.createElement("a"),Qh=(function(e,t,i){void 0===t&&(t=e=>e),void 0===i&&(i=new qh({}))}(e=>vt({},mt(e))),/^(android-app:|chrome-extension:)/),Jh=e=>{try{return decodeURIComponent(e)}catch(t){return e}},Zh=(e,t)=>t.map(t=>e+"[]="+encodeURIComponent(t)).join("&");var $h=e(4972);const ep=["strm.yandex.net","strm.yandex.ru","strm-ott.akamaized.net","media.strm.yandex.net","cdn.ngenix.net","streaming.tst.strm.yandex.net","default.zen.zeta.dzen.ru","video.dzen.ru",$h.zendexConfig.strmApi,$h.zendexConfig.s3],tp=jl(300),ip=jl(15);let rp=function(e){return e.AdCompleted="AdCompleted",e.LoadSource="LoadSource",e.PlayerDestroy="PlayerDestroy",e.CutOff="CutOff",e.PlayerError="PlayerError",e.AdTypeChange="AdTypeChange",e.InsertIntoCalled="InsertIntoCalled",e.AdSkipped="AdSkipped",e}({});const np=jl(900);let op=jl(0);const ap=Gl(2e3),sp=document.createElement("a"),lp={},dp=e=>e===$h.zendexConfig.strmApi?"pingx":"ping",cp=Gl(1e3),up={reason:"recoverStreamByReturnToOnline",delay:0,rawData:0},hp=[];class pp{static enableConsole(){pp.consoleEnabled=!0,pp.log("YA PLAYER VERSION: 1.0-1238")}static log(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];pp.consoleEnabled&&console.log(Qt(...t)),pp.addToHistory("log",t)}static warn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];pp.consoleEnabled&&console.warn(Qt(...t)),pp.addToHistory("warn",t)}static error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];pp.consoleEnabled&&console.error(Qt(...t)),pp.addToHistory("error",t)}static getHistory(){return[...hp]}static addToHistory(e,t){hp.length>=150&&hp.shift(),hp.push("["+e+"]["+Date.now()+"] "+t.map(e=>{try{return Xt(e)}catch(kE){return kE instanceof Error?JSON.stringify(["stringify_error",kE.stack]):String(kE)}}).join())}}pp.consoleEnabled=void 0;const fp=jl(10),gp=ad(),vp=gp?.25:.02,mp=[Kh.midroll,Kh.postroll,Kh.preroll];let Ap,Ep;const yp=["ewma","hlsjs","yabro"];let Sp=function(e){return e.OK="OK",e.SLOW="SLOW",e.UNKNOWN="UNKNOWN",e}({});const Tp=["ts","m4s","m4f"],Rp=e=>{let{fragDuration:t,downloadTime:i}=e;return i>.9*t},Pp=e=>{let{fragDuration:t,timings:i}=e;const r=i.filter(e=>{const{name:t,duration:i,encodedBodySize:r,decodedBodySize:n,transferSize:o}=e;if(void 0===t||void 0===i)return!1;const a=Number(r||n||o);return!(isNaN(a)||a<1024)&&Tp.includes(Pt(t).toLowerCase())}).slice(-5).map(e=>{let{duration:t}=e;return Gl(t)});if(0===r.length)return Sp.UNKNOWN;const n=(a=.33,0===(o=r).length?Gl(0):o.reduce((e,t)=>Kl(ql(e,a),ql(t,1-a)),o[0]));var o,a;return Rp({fragDuration:t,downloadTime:n})?Sp.SLOW:Sp.OK},_p="."+$h.zendexConfig.strmApi,bp=jl(1);var Ip=e(3628);let Cp=function(e){return e.BroadcastAdReceived="BroadcastAdReceived",e.BroadcastAdInit="BroadcastAdInit",e.StreamPlayerReceivedMetadata="StreamPlayerReceivedMetadata",e.StreamPlayerChooseMetadata="StreamPlayerChooseMetadata",e.PlayWithoutRAAResults="PlayWithoutRAAResults",e.CanPlay="CanPlay",e.ContentImpression="ContentImpression",e.WaitForPlayCompleted="WaitForPlayCompleted",e.DrmSystemsSupportDetected="DrmSystemsSupportDetected",e.VideoEpisodesLoaded="VideoEpisodesLoaded",e.InrollAdStart="InrollAdStart",e.InrollAdPodStart="InrollAdPodStart",e.InrollAdPodEnd="InrollAdPodEnd",e.InrollAdEnd="InrollAdEnd",e.PlayAdViewers="PlayAdViewers",e.AdStart="AdStart",e.AdPodImpression="AdPodImpression",e.AdPodLoading="AdPodLoading",e.AdPodError="AdPodError",e.AdPodStart="AdPodStart",e.AdPodSkip="AdPodSkip",e.AdPodResume="AdPodResume",e.AdPodPause="AdPodPause",e.AdPodEnd="AdPodEnd",e.AdEnd="AdEnd",e.AdClickThru="AdClickThru",e.NoAdPodsToPlayAd="NoAdPodsToPlayAd",e.Stalled="Stalled",e.LoadSource="LoadSource",e.PrerollInit="PrerollInit",e.WaitForUserGesture="WaitForUserGesture",e.WaitForDocumentVisibility="WaitForDocumentVisibility",e.CallPublicApiAfterDestroy="CallPublicApiAfterDestroy",e.HiddenAutoplayPrevented="HiddenAutoplayPrevented",e.PlayVideoOnVisibilityChange="PlayVideoOnVisibilityChange",e.PauseVideoOnVisibilityChange="PauseVideoOnVisibilityChange",e.StreamStopWhileLoadingMultiroll="StreamStopWhileLoadingMultiroll",e.StreamStopWhileChoosingStream="StreamStopWhileChoosingStream",e.StreamStopWhileDestroyVideoController="StreamStopWhileDestroyVideoController",e.StreamStopDuringDefineAutoplaySettings="StreamStopDuringDefineAutoplaySettings",e.StreamStopWhileWaitingForPlay="StreamStopWhileWaitingForPlay",e.StreamStopWhileWaitingForDocumentVisibility="StreamStopWhileWaitingForDocumentVisibility",e.StreamStopWhileLoadingPreroll="StreamStopWhileLoadingPreroll",e.StreamStopWhilePreloadingPreroll="StreamStopWhilePreloadingPreroll",e.SkippableFragmentWidgetDrawn="SkippableFragmentWidgetDrawn",e.SkippableFragmentWidgetHidden="SkippableFragmentWidgetHidden",e.HlsJsLoadSourceCalledTwice="HlsJsLoadSourceCalledTwice",e.PreloadSource="PreloadSource",e.UsePreloadedHlsJs="UsePreloadedHlsJs",e.PlayAfterWaitingForDocumentVisibility="PlayAfterWaitingForDocumentVisibility",e.ResourcesIdle="ResourcesIdle",e.ClientInfo="ClientInfo",e.HlsJsForceCappingStart="HlsJsForceCappingStart",e.CanRenderSkinCalledBeforeSkinIsReady="CanRenderSkinCalledBeforeSkinIsReady",e.ExternalPlaybackOpenButtonClick="ExternalPlaybackOpenButtonClick",e.ExternalPlaybackCloseButtonClick="ExternalPlaybackCloseButtonClick",e.ExternalPlayerListVisibleStatusChange="ExternalPlayerListVisibleStatusChange",e.ExternalPlaybackPlayerCsrfFetching="ExternalPlaybackPlayerCsrfFetching",e.ExternalPlaybackPlayerCsrfFetchSuccess="ExternalPlaybackPlayerCsrfFetchSuccess",e.ExternalPlaybackPlayerCsrfFetchError="ExternalPlaybackPlayerCsrfFetchError",e.ExternalPlaybackPlayerListHasAnyDevice="ExternalPlaybackPlayerListHasAnyDevice",e.ExternalPlaybackPlayerListFetching="ExternalPlaybackPlayerListFetching",e.ExternalPlaybackPlayerListFetchSuccess="ExternalPlaybackPlayerListFetchSuccess",e.ExternalPlaybackPlayerListFetchError="ExternalPlaybackPlayerListFetchError",e.ExternalPlaybackPlayerListAboutInfoClick="ExternalPlaybackPlayerListAboutInfoClick",e.ExternalPlaybackPlayerListRefresh="ExternalPlaybackPlayerListRefresh",e.ExternalPlaybackPlayerActivate="ExternalPlaybackPlayerActivate",e.ExternalPlaybackPlayerActivateSucceed="ExternalPlaybackPlayerActivateSucceed",e.ExternalPlaybackPlayerActivateFailed="ExternalPlaybackPlayerActivateFailed",e.ExternalPlaybackCsrfTokenExpired="ExternalPlaybackCsrfTokenExpired",e.YandexRpcError="YandexRpcError",e.YandexAndroidVsidChanged="YandexAndroidVsidChanged",e.Seek="Seek",e.RecommendationsSetParams="RecommendationsSetParams",e.RecommendationSelect="RecommendationSelect",e.RecommendationsWidgetVisibilityChange="RecommendationsWidgetVisibilityChange",e.PlayInrollAd="PlayInrollAd",e.ShareButtonClick="ShareButtonClick",e.FPSControllerRestrictions="FPSControllerRestrictions",e.VideoCodecSupport="VideoCodecSupport",e.DebugVideoCodecSupport="DebugVideoCodecSupport",e.SetMaxWidthCapSize="SetMaxWidthCapSize",e}({});var Op=e(1413),wp=e.n(Op);const kp=Gl(15e3),Dp=ot("SKIN_PUT_USE_NATIVE_SUBTITLES");var Np=e(5051);const Lp={hiddenControls:[],useNativeSubtitles:!1,nativeControlsVisibility:!0,skinDVRStartTime:jl(0),skinDVRDuration:jl(0)},Mp={min:0,max:1/0},Vp={min:1,max:1/0},xp={min:0,max:1};let Fp=function(e){return e.ApiPlay="ApiPlay",e.VolumeChange="VolumeChange",e.MuteChange="MuteChange",e}({});const Up="other",Bp={from:Up,reqid:void 0,hash:void 0,vsid:Mh},Hp={startPosition:{},additionalParams:Bp,adConfig:void 0,withCredentials:!1,loop:!1,preview:"",videoInfo:{}},Gp=Gl(500),jp=Bl(-1),Wp={name:(Yp="TRACK_AUTO",{TRACK_AUTO:"\u0410\u0432\u0442\u043e"}[Yp]),value:"auto",bitrate:jp};var Yp;let Kp=function(e){return e.VideoIsNotPausedOnInit="VideoIsNotPausedOnInit",e.DetectByInterval="DetectByInterval",e.VideoPlayEvent="VideoPlayEvent",e.PlayCallback="PlayCallback",e}({}),zp=function(e){return e.Internal="internal",e.Api="api",e.Cache="cache",e}({}),qp=function(e){return e.ON="ON",e.OFF="OFF",e}({}),Xp=function(e){return e.setSource="setSource",e.destroy="destroy",e.end="end",e}({}),Qp=function(e){return e.NATIVE="NATIVE",e.HLS="HLS",e.MPD="MPD",e.MP4="MP4",e}({}),Jp=function(e){return e.SetMuted="SetMuted",e.SetVolume="SetVolume",e.RequestAutoplaySettings="RequestAutoplaySettings",e.VolumeChangeEvent="VolumeChangeEvent",e.RestoreSavedMuted="RestoreSavedMuted",e}({});const Zp=(e,t)=>{for(let i=0;i<e.length;i++)if(t(e[i],i,e))return!0;return!1},$p=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent,i=t.indexOf("Android");return-1===i?-1:parseFloat(t.slice(i+8))}(),ef=Es?function(e,t){return void 0===t&&(t=As),Boolean(t.canPlayType(e).replace(/no/,""))}:()=>!1,tf=ef("application/vnd.apple.mpegurl")||$p>=4.4;let rf=function(e){return e.NO_MSE="NO_MSE",e.NO_CODECS="NO_CODECS",e.NO_SUPPORTED_DRM="NO_SUPPORTED_DRM",e.NO_SUPPORTED_FORMAT="NO_SUPPORTED_FORMAT",e.INVALID_STREAM_URL="INVALID_STREAM_URL",e}({});const nf={supported:!1,noSupportReason:rf.NO_MSE},of={supported:!1,noSupportReason:rf.NO_CODECS},af={supported:!1,noSupportReason:rf.NO_SUPPORTED_DRM},sf={supported:!1,noSupportReason:rf.NO_SUPPORTED_FORMAT},lf={supported:!1,noSupportReason:rf.INVALID_STREAM_URL},df=["yandex.ru","yandex.net","yastatic.net","yandex-team.ru","kinopoisk.ru","strm-ott.akamaized.net","default.zen.zeta.dzen.ru","video.dzen.ru",$h.zendexConfig.strmApi,$h.zendexConfig.s3],cf=e=>mt(e.toLocaleLowerCase()).hostname.includes($h.zendexConfig.s3),uf=function(e){void 0===e&&(e=window);const t=e.MediaSource||e.WebKitMediaSource;return t&&n(t.isTypeSupported)&&!function(e){void 0===e&&(e=window);const t=e.SourceBuffer||e.WebKitSourceBuffer;return!!t&&!(t.prototype&&n(t.prototype.appendBuffer)&&n(t.prototype.remove))}(e)?t:void 0}();var hf=e(1836);const pf={getItem(e){try{return hf.Ay.getItem(e)}catch(t){return null}},setItem(e,t){try{hf.Ay.setItem(e,t)}catch(i){}},removeItem(e){try{hf.Ay.removeItem(e)}catch(t){}},clear(){try{hf.Ay.clear()}catch(e){}}},ff=function(e){return void 0===e&&(e=window),o(e).includes("YaBrowser")},gf=ff(),vf=Gl(2592e5),mf=U(()=>{if(void 0===uf)return Promise.reject(new Error("MSE is not supported"));if(function(){if(!gf)return!1;try{return void 0!==window.top.WEB_NTP_VERSION}catch(e){return!1}}())return Promise.resolve(uf);if(function(){try{const e=pf.getItem("videoplayer-supported-mse");if(null===e)return;const{value:t,time:i,version:r}=JSON.parse(e);if(Date.now()-i>vf)return void pf.removeItem("videoplayer-supported-mse");if("1"!==r)return;return t||void 0}catch(e){return}}())return Promise.resolve(uf);const e=document.createElement("video"),t=new uf,i=URL.createObjectURL(t);let r,n;const o=new Promise((o,a)=>{r=()=>{o(uf);try{pf.setItem("videoplayer-supported-mse",JSON.stringify({value:!0,time:Date.now(),version:"1"}))}catch(e){}},n=()=>a(new Error("MSE is not supported")),t.addEventListener("sourceopen",r),e.addEventListener("error",n),e.addEventListener("durationchange",n),e.src=i});return o.then(()=>{URL.revokeObjectURL(i),t.removeEventListener("sourceopen",r),e.removeEventListener("error",n),e.removeEventListener("durationchange",n)}),o});t(mf());const Af=function(e){void 0===e&&(e=window);const t=o(e).toLowerCase();return/yandexstation.*yandexio/.test(t)||/station.*crosswalk/.test(t)}(),Ef={supported:!0,engine:Qp.NATIVE},yf={supported:!0,engine:Qp.HLS};let Sf;const Tf=(e,t)=>e===t,Rf=function(e){return void 0===e&&(e=window),e.navigator.userAgent.includes("Chrome")&&e.navigator.vendor.includes("Google Inc")&&!ff(e)}(),Pf=function(e){return void 0===e&&(e=window),e.navigator.userAgent.toLowerCase().includes("firefox")}(),_f=function(e){return void 0===e&&(e=window),o(e).toLowerCase().includes("linux")&&!X(e)}();let bf=function(e){return e.fairplay="fairplay",e.playready="playready",e.widevine="widevine",e}({});const If="com.apple.fps.1_0",Cf="com.apple.fps.2_0",Of=function(e){return[].concat.apply([],e)}(hr({[bf.fairplay]:["com.apple.fairplay",If,Cf],[bf.widevine]:["com.widevine.alpha"],[bf.playready]:["com.microsoft.playready"]}));let wf,kf=function(e){return e.YandexBrowserLinux="YandexBrowserLinux",e.OldYandexBrowser="OldYandexBrowser",e.WebKitMediaKeys="WebKitMediaKeys",e.requestMediaKeySystemAccess="requestMediaKeySystemAccess",e.MSMediaKeys="MSMediaKeys",e.GenerateKeyRequest="GenerateKeyRequest",e.Constant="Constant",e.NotAvailable="NotAvailable",e.LiteMode="LiteMode",e}({});const Df=[],Nf=Gl(2592e5);let Lf;const Mf=U(async e=>{let{video:t}=e;const i=function(){try{const e=pf.getItem("videoplayer-supported-drm-systems");if(null===e)return;const{value:t,time:i,version:r}=JSON.parse(e);if(Date.now()-i>Nf)return void pf.removeItem("videoplayer-supported-drm-systems");if("8a39686821b096447bc76f3c5d060531"!==r)return void pf.removeItem("videoplayer-supported-drm-systems");if(0===t.supportedDrmSystems.length)return;return t}catch(e){return}}(),r=i||await yr({video:t});return Df.forEach(e=>e(r)),Df.length=0,Lf=r,void 0===i&&function(e){if(0!==e.supportedDrmSystems.length)try{pf.setItem("videoplayer-supported-drm-systems",JSON.stringify({value:e,time:Date.now(),version:"8a39686821b096447bc76f3c5d060531"}))}catch(t){}}(r),r.supportedDrmSystems}),Vf=document.createElement("video"),xf={supported:!0,engine:Qp.MPD};let Ff;const Uf=/Smart.?TV|PlayStation/i.test(navigator.userAgent);class Bf{static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent)}static isSafariDesktop(){return gp&&!fd}static setDeviceType(e){this.deviceType=e}static isSmartTV(){return"SMART_TV"===this.deviceType||Uf}static canPlayHlsOnNative(){return this.isSmartTV()||tf}}Bf.deviceType=void 0;const Hf=function(e){if(void 0===e&&(e=window),gp&&e.navigator&&e.navigator.userAgent){const t=e.navigator.userAgent.match(/version\/(\d+)/i);if(t){const e=Number(t[1]);if(e)return e}}return-1}(),Gf=function(e){return void 0===e&&(e=window),Y(e)&&o(e).toLowerCase().includes("iphone")}(),jf=function(e){return void 0===e&&(e=window),e.navigator.userAgent.toLowerCase().includes("ipad")&&Y(e)}();class Wf extends Td{constructor(){super(),this.once("Destroy",f(window,"online",()=>{this.emit("Online")})),this.once("Destroy",f(window,"offline",()=>{this.emit("Offline")}))}destroy(){this.emit("Destroy")}}const Yf={setItem(e,t){try{sessionStorage.setItem(e,t)}catch(i){}},getItem(e){try{return sessionStorage.getItem(e)}catch(t){return null}},removeItem(e){try{sessionStorage.removeItem(e)}catch(t){}}};class Kf{constructor(){this.videoContentId=void 0,this.lastProgress=void 0}setVideoContentId(e){this.lastProgress=void 0,this.videoContentId=e}clearVideoContentId(){this.lastProgress=void 0,this.videoContentId=void 0}getProgress(){if(!this.videoContentId)return;const e=Fr(this.videoContentId);return B(e)?jl(e):void 0}saveProgress(e){this.videoContentId&&("number"===typeof this.lastProgress&&Math.abs(this.lastProgress-e)<1||(this.lastProgress=e,Ur(this.videoContentId,e)))}}const zf=Br(window),qf=Br(window),Xf={antiadblock_turn_off:"false",mediascope_log_url:"","video_quality_survey.answer_text":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442\u0435 \u0434\u0435\u043b\u0430\u0442\u044c \u0414\u0437\u0435\u043d \u043b\u0443\u0447\u0448\u0435!","video_quality_survey.answer_text_bad_mark":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u0441\u0442\u0430\u0440\u0430\u0442\u044c\u0441\u044f \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0414\u0437\u0435\u043d \u043b\u0443\u0447\u0448\u0435!","video_quality_survey.is_enabled":"false","video_quality_survey.question_text":"\u0412\u0430\u043c \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f \u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432\u0438\u0434\u0435\u043e \u0432 \u0414\u0437\u0435\u043d\u0435?","video_quality_survey.related_ads_option":"\u0420\u0435\u043a\u043b\u0430\u043c\u0430","video_quality_survey.related_content_option":"\u041a\u043e\u043d\u0442\u0435\u043d\u0442","video_quality_survey.related_features_option":"\u0424\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043b\u0435\u0435\u0440\u0430","video_quality_survey.related_quality_option":"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f","video_quality_survey.related_text":"\u0421 \u0447\u0435\u043c \u0441\u0432\u044f\u0437\u0430\u043d\u0430 \u0432\u0430\u0448\u0430 \u043e\u0446\u0435\u043d\u043a\u0430?",web_gogol_fetch_keepalive:"false",web_gogol_fetch_retry_once:"false",web_gogol_wait_for_online:"false",web_prefer_hd:"false",web_skip_all_adpods:"false"};qf.flags||(qf.flags={});const Qf=U(()=>{try{return"keepalive"in new Request("")}catch(e){return!1}}),Jf=new RegExp("^https?:\\/\\/([^\\/]+\\.)?("+["strm-ott\\.akamaized\\.net","akamai\\.strm\\.yandex\\.net","(an|strm)\\.yandex\\.(ru|net)","cdn\\.ngenix\\.net","strm\\.yandex\\.cdnga\\.net","strm-yandex\\.gcdn\\.co","(widevine|playready|fairplay)-proxy\\.ott\\.yandex\\.ru","cdn\\.dzeninfra\\.ru ","cdn\\.dzen\\.ru "].join("|")+")\\/(?!log|perf|jstracer|ping)"),Zf={perfLogUrl:"https://"+$h.zendexConfig.gogolApi+"/perf",updateInterval:Gl(3e4),urlRegexp:Jf};class $f{static clearResourceTimings(){"function"===typeof performance.clearResourceTimings?performance.clearResourceTimings():"function"===typeof performance.webkitClearResourceTimings&&performance.webkitClearResourceTimings()}constructor(e){let{perfLogUrl:t=Zf.perfLogUrl,updateInterval:i=Zf.updateInterval,urlRegexp:r=Zf.urlRegexp}=void 0===e?{}:e;this.timeoutId=void 0,this.history=[],this.reportUrl=void 0,this.updateInterval=void 0,this.urlRegexp=void 0,this.reportUrl=t,this.updateInterval=i,this.urlRegexp="string"===typeof r?new RegExp(r):r,$f.isSupported&&this.loop()}destroy(){clearTimeout(this.timeoutId)}async updateInfo(){if(!$f.isSupported)return;const e=this.getCurrentResourcesTimings();if($f.clearResourceTimings(),0===e.length)return;this.history.push(...e),this.history.length>200&&this.history.splice(0,this.history.length-200);zr({url:Tt(this.reportUrl,{perfnow:String(Date.now()),navstart:String(void 0!==performance.timeOrigin?performance.timeOrigin:performance.timing.navigationStart)},{saveOriginalPath:!0}),data:JSON.stringify(e)})}getCurrentResourcesTimings(){if(!$f.isSupported)return[];return performance.getEntriesByType("resource").filter(e=>{let{name:t}=e;return this.urlRegexp.test(t)&&t!==this.reportUrl})}getLastResourcesTimings(){return this.history}getAllResourcesTimings(){return[...this.getLastResourcesTimings(),...this.getCurrentResourcesTimings()]}loop(){this.updateInterval<=0||(this.timeoutId=window.setTimeout(async()=>{await this.updateInfo(),this.loop()},this.updateInterval))}}$f.isSupported=window.performance&&"function"===typeof window.performance.getEntriesByType&&("function"===typeof performance.clearResourceTimings||"function"===typeof performance.webkitClearResourceTimings);const eg=jl(3),tg=Gl(8e3),ig=Gl(3e4),rg=Gl(3e4),ng={timeout:5e3,baseDelay:1e3,backoffFactor:1,fuzzFactor:.5,maxAttempts:1e3},og={drm:{retryParameters:Jr({},ng,{timeout:1e4,maxAttempts:3})},manifest:{availabilityWindowOverride:1/0,retryParameters:Jr({},ng,{timeout:tg}),dash:{ignoreMinBufferTime:!0,autoCorrectDrift:!1,ignoreEmptyAdaptationSet:!0,targetLatency:5}},streaming:{rebufferingGoal:.3,jumpLargeGaps:!0,retryParameters:Jr({},ng,{timeout:rg})}};var ag,sg;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ETHERNET=1]="ETHERNET",e[e.WIFI=2]="WIFI",e[e.CELL_2G=3]="CELL_2G",e[e.CELL_3G=4]="CELL_3G"}(ag||(ag={})),function(e){e.BLUETOOTH="bluetooth",e.CELLULAR="cellular",e.ETHERNET="ethernet",e.MIXED="mixed",e.NONE="none",e.OTHER="other",e.UNKNOWN="unknown",e.WIFI="wifi",e.WIMAX="wimax"}(sg||(sg={}));const lg=Ul(1e6),dg=Ul(1e5),cg=W()?9e5:864e5;var ug=e(4939);const hg=e=>{const t=[];for(;e;)try{if($r(e),t.push(e),e.parent===e)break;e=e.parent}catch(i){break}return t},pg=hg(window);class fg{constructor(e){this.alpha=void 0,this.estimate=0,this.totalWeight=0,this.setHalfLife(e)}sample(e,t){const i=Math.pow(this.alpha,e),r=t*(1-i)+i*this.estimate;isNaN(r)||(this.estimate=r,this.totalWeight+=e)}getEstimate(){const e=1-Math.pow(this.alpha,this.totalWeight);return this.estimate/e}setHalfLife(e){this.alpha=Math.exp(Math.log(.5)/e)}}const gg={fast:2,slow:5},vg={fast:1,slow:2};class mg{constructor(){this.fast=void 0,this.slow=void 0,this.bytesSampled=0,this.fast=new fg(gg.fast),this.slow=new fg(gg.slow)}sample(e,t,i){if(void 0===i&&(i=!1),e<=0||t<(i?2e3:16e3))return;this.setHalfLife(i?vg:gg);const r=8e3*t/e,n=e/1e3;this.bytesSampled+=t,this.fast.sample(n,r),this.slow.sample(n,r)}getBandwidthEstimate(e){return this.hasGoodEstimate()?{value:this.getCurrentEstimate(),source:"ewma"}:e}hasGoodEstimate(){return this.bytesSampled>=128e3}getCurrentEstimate(){return Ul(Math.min(this.fast.getEstimate(),this.slow.getEstimate()))}setHalfLife(e){this.fast.setHalfLife(e.fast),this.slow.setHalfLife(e.slow)}}var Ag;!function(e){e.LOAD_SCRIPT_ERROR="LOAD_SCRIPT_ERROR",e.STATS_SENSOR_NAME_ERROR="STATS_SENSOR_NAME_ERROR",e.STATS_LABEL_KEY_ERROR="STATS_LABEL_KEY_ERROR",e.STATS_LABEL_VALUE_ERROR="STATS_LABEL_VALUE_ERROR"}(Ag||(Ag={}));const Eg="utf-8",yg=e=>!0,Sg=[...["sendReportLog","setSource","preloadSource","requestVideoElementFullscreen","requestDebugInfo","destroy","requestExternalPlay","requestExternalPlayerList","insertInto","play"],...["setVideoTrack","setAudioTrack","setTextTrack","changeAdditionalParams","exitVideoElementFullscreen","setPlaybackRate","setMuted","setVolume","setPictureInPictureAllowed","setVideoStyle","setNativeControlsVisibility","setNativeTextTrackVisibility","logEvent","logError","seek","openReportWindow","playInrollAd","skipAdPod","setNativeAdControlsVisibility","setFeed","sendRatingLog","toggleAdFreeSessionState","updateEpisodes","pause","on","once","off","publicEmit"],"getState","getReadyState"],Tg=window;Tg.Ya||(Tg.Ya={}),Tg.Ya.playerApi||(Tg.Ya.playerApi={}),Tg.Ya.playerApi.METHODS||(Tg.Ya.playerApi.METHODS=Sg);window.Ya.playerApi;const Rg=window.Ya.playerApi,Pg="https://static.dzeninfra.ru/yandex-video-player-iframe-api-bundles/hlsjs/0.12.2-1761-1846-1976_tmp-2080-2095-2146-2171-2-2172-2232_tmp-2427-2498/hls.min.js",_g="https://static.dzeninfra.ru/yandex-video-player-iframe-api-bundles/shaka/2.5.17-yandex-patched-fix-ttml-parsing/shaka-player.compiled.js",bg=U(()=>shaka.polyfill.installAll());let Ig;const Cg=Yl(480),Og=[4320,2880,2160,1440,1080,720,480,360,240,144,0],wg=Og.reduce((e,t)=>(e[t]=t,e),Object.create(null)),kg=Gl(1e4);class Dg{constructor(){this.previousVariantIndex=void 0,this.lastDowngradedVariantIndex=void 0,this.getTimeSinceDowngrade=()=>1/0}filter(e){if(0===e.length)return e;let t=e.length-1;return this.isDowngrading(t)&&(this.lastDowngradedVariantIndex=t+1,this.getTimeSinceDowngrade=H()),void 0!==this.lastDowngradedVariantIndex&&this.getTimeSinceDowngrade()<kg&&(t=this.lastDowngradedVariantIndex-1),this.previousVariantIndex=t,e.slice(0,t+1)}reset(){this.getTimeSinceDowngrade=()=>1/0,this.previousVariantIndex=void 0,this.lastDowngradedVariantIndex=void 0}isDowngrading(e){return void 0!==this.previousVariantIndex&&this.previousVariantIndex>e}}class Ng{constructor(e){this.bandwidthEstimator=new mg,this.config=void 0,this.enabled=!1,this.originalShakaVariants=[],this.props=void 0,this.startupComplete=!1,this.switchCallback=Q,this.variants=[],this.switchHistoryRule=new Dg,this.props=e}init(e){this.switchCallback=e}configure(e){this.config=e}stop(){this.enabled=!1,this.switchCallback=Q,this.variants=[],this.switchHistoryRule.reset()}getBandwidthEstimate(){const e=this.bandwidthEstimator.getBandwidthEstimate({value:this.config.defaultBandwidthEstimate,source:this.config.defaultBandwidthEstimateSource});return{value:Kl(e.value,this.props.bandwidthEstimateOffset),source:e.source}}getMaxCapAllowedVideoTrack(){const{restrictions:e}=this.props.getFilterParams(this.variants),t=this.variants.filter(mn);if(0===t.length)return;const i=En(t,e);return i[i.length-1].video}enable(){this.enabled=!0}disable(){this.enabled=!1}getVariants(){return this.variants}setVariants(e){wp()(e,this.originalShakaVariants)||(this.originalShakaVariants=e,this.variants=yn([...e].sort((e,t)=>e.bandwidth-t.bandwidth)),this.switchHistoryRule.reset())}chooseVariant(){const{preloadedVariant:e,restrictions:t}=this.props.getFilterParams(this.variants);if(e)return e;let i=function(e,t,i){if(e.length<=1)return e;let r=0;const n=Math.max(i,1);for(let o=1;o<e.length;o++){const i=e[o],a=e[o+1]||{bandwidth:1/0},s=i.bandwidth/.95*n,l=a.bandwidth/.85*n;t>=s&&t<=l&&(r=o)}return e.slice(0,r+1)}(this.variants,this.getBandwidthEstimate().value,this.props.getPlaybackRate());i=this.switchHistoryRule.filter(i),i=En(i,t);return gn(i.slice().reverse(),e=>{var t;return(null==e||null==(t=e.audio)?void 0:t.bandwidth)||0})||null}segmentDownloaded(e,t){this.bandwidthEstimator.sample(e,t,this.props.isLowLatencyLive()),this.enabled&&this.suggestStreams()}suggestStreams(){if(!this.startupComplete){if(!this.bandwidthEstimator.hasGoodEstimate())return;this.startupComplete=!0}const e=this.chooseVariant();this.switchCallback(e)}}const Lg={maxWidth:Yl(1/0),maxHeight:Yl(1/0),width:Yl(1/0),height:Yl(1/0)};class Mg{constructor(e){this.props=e}getAbrRestrictions(){if(!this.props.getState().controller.isAbrEnabled)return Lg;const e=this.props.getCapSizes();if(void 0===e)return Lg;const{width:t,height:i,maxHeight:r,maxWidth:n}=e,o=function(e){if(void 0===e)return;const t=e.querySelector('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:capping:maxheight"]');if(!t)return;const i=Yl(parseInt(t.getAttribute("value")||"",10));return i>0?{maxHeight:i}:void 0}(this.props.getManifestXml()),a=null!=o&&o.maxHeight?(null==o?void 0:o.maxHeight)+1:1/0;return{maxWidth:n,maxHeight:Yl(Math.min(...[a,r].filter(B))),height:i,width:t}}}const Vg=e=>e.active;class xg{constructor(e){this.length=e,this.list=[]}push(e){this.list.length>=this.length&&this.list.shift(),this.list.push(e)}getAll(){return this.list}clear(){this.list.length=0}copy(){const e=new xg(this.length);return e.list=this.list.slice(),e}}const Fg=jl(30),Ug=Fg/Lh*2*2;class Bg{constructor(){this.initSegments=new xg(10),this.segments=new xg(Ug)}set(e,t){const{pathname:i}=mt(e),r={pathname:i,response:t};Pn(e)?this.initSegments.push(r):this.segments.push(r)}get(e){const{pathname:t}=mt(e),i=Pn(e)?Rn(this.initSegments,t):Rn(this.segments,t);return void 0===i?void 0:i.response}clear(){this.initSegments.clear(),this.segments.clear()}copy(){const e=new Bg;return e.initSegments=this.initSegments.copy(),e.segments=this.segments.copy(),e}hasCachedData(){return this.initSegments.getAll().length>0||this.segments.getAll().length>0}}class Hg{constructor(){this.serverTimestamp=void 0,this.getElapsedTimeFromServerDate=()=>0}parseServerTime(e,t){if(!e.date&&!e["x-server-time-ms"])return;let i=NaN;if(e["x-server-time-ms"]){i=new Date(parseInt(e["x-server-time-ms"],10)).getTime()}else if(e.date){i=new Date(e.date).getTime()}B(i)&&(this.serverTimestamp=i+t/2,this.getElapsedTimeFromServerDate=H())}getServerTime(){if(void 0!==this.serverTimestamp)return this.serverTimestamp+this.getElapsedTimeFromServerDate()}}class Gg{constructor(e){let{segmentCache:t,loadedManifest:i}=void 0===e?{segmentCache:void 0,loadedManifest:void 0}:e;this.segmentCache=void 0,this.lastLoadedManifest=void 0,this.useLastLoadedManifest=!0,this.shakaPlayer=void 0,this.networkErrorHandler=void 0,this.networkSuccessHandler=void 0,this.serverTimeEstimator=void 0,this.requestFilters=[],this.strmSession=void 0,this.segmentCache=t||new Bg,this.lastLoadedManifest=i,this.serverTimeEstimator=new Hg}setup(e,t,i){this.shakaPlayer&&(_n(this.shakaPlayer),this.useLastLoadedManifest=!0),this.shakaPlayer=e,this.networkSuccessHandler=t,this.networkErrorHandler=i;const r=this.customNetPluginFactory(window.shaka),n=e.getNetworkingEngine();null==n||n.registerScheme("http",r),null==n||n.registerScheme("https",r)}destroy(){this.requestFilters.length=0,this.segmentCache.clear(),this.shakaPlayer&&_n(this.shakaPlayer)}hasCachedSegments(){return this.segmentCache.hasCachedData()}hasCachedData(){return this.useLastLoadedManifest&&void 0!==this.lastLoadedManifest||this.hasCachedSegments()}getCurrentVariantTrack(){return Tn(this.shakaPlayer)}copyCachedData(){return{segmentCache:this.segmentCache.copy(),loadedManifest:this.lastLoadedManifest}}getServerTime(){return this.serverTimeEstimator.getServerTime()}registerRequestFilter(e){this.requestFilters.includes(e)||this.requestFilters.push(e)}unregisterRequestFilter(e){const t=this.requestFilters.indexOf(e);t<=-1||this.requestFilters.splice(t,1)}cacheResponse(e,t,i,r){switch(i){case e.net.NetworkingEngine.RequestType.MANIFEST:this.lastLoadedManifest=r,this.useLastLoadedManifest=!1;break;case e.net.NetworkingEngine.RequestType.SEGMENT:this.segmentCache.set(t,r)}}getCachedResponse(e,t,i){switch(i){case e.net.NetworkingEngine.RequestType.MANIFEST:const{useLastLoadedManifest:i,lastLoadedManifest:r}=this;return i&&void 0!==r?(this.useLastLoadedManifest=!1,r):void 0;case e.net.NetworkingEngine.RequestType.SEGMENT:const n=this.segmentCache.get(t);return void 0===n?void 0:n;default:return}}customNetPluginFactory(e){return(t,i,r,n)=>{const o=this.getCachedResponse(e,t,r);if(void 0!==o)return o.fromCache=!0,new e.util.AbortableOperation(Promise.resolve(o),Q);switch(this.requestFilters.forEach(e=>{try{e(r,i)}catch(t){}}),r){case e.net.NetworkingEngine.RequestType.MANIFEST:void 0===this.strmSession?t=Cr(t):(i.headers["x-strm-session"]=this.strmSession,i.headers["x-client-timestamp"]=String(Date.now()),t=Gt(t,"t"));break;case e.net.NetworkingEngine.RequestType.SEGMENT:t=Cr(i.uris[0]||t)}const a=function(e){return e.net.HttpFetchPlugin.isSupported()?e.net.HttpFetchPlugin:e.net.HttpXHRPlugin}(e),s=Tl(),l=a(t,i,r,n);return new e.util.AbortableOperation(l.promise.then(i=>(r===e.net.NetworkingEngine.RequestType.MANIFEST&&(this.strmSession=i.headers["x-strm-session"],this.serverTimeEstimator.parseServerTime(i.headers,Tl()-s)),this.cacheResponse(e,t,r,i),this.networkSuccessHandler(r),i)).catch(t=>{throw t&&t.code!==e.util.Error.Code.OPERATION_ABORTED&&this.networkErrorHandler(r,t),t}),()=>l.abort())}}}const jg=function(e){const t=o(e).match(/Firefox\/([0-9]+)\./);return t&&parseInt(t[1],10)||-1}(window),Wg=jl(.5);class Yg extends Nl{constructor(e){super(),this.manifestXml=void 0,this.resolvePromise=Q,this.rejectPromise=Q,this.manifestXmlPromise=void 0;const t=e.getNetworkingEngine(),i=(e,t)=>{const i=Ln(e,t);void 0===this.manifestXml&&void 0!==i&&this.resolvePromise(i),void 0!==i&&(this.manifestXml=i)};null==t||t.registerResponseFilter(i),this.addDestroyHandler(()=>{null==t||t.unregisterResponseFilter(i),this.rejectPromise()}),e.addEventListener("unloading",this.rejectPromise)}getManifestXml(){if(!this.isDestroyed)return this.manifestXml}async waitForManifestXml(){return this.isDestroyed?Promise.reject():void 0!==this.manifestXml?Promise.resolve(this.manifestXml):(this.manifestXmlPromise||(this.manifestXmlPromise=new Promise((e,t)=>{this.resolvePromise=e,this.rejectPromise=t})),this.manifestXmlPromise)}}class Kg extends Nl{get preloaded(){if(this.isDestroyed)return"none";const e=this.getSource().sourceParams.startPosition.videoTime||jl(0),{total:t}=Ir(this.getBufferedInfo(),e);return t>=jl(2)?"full":this.hasCachedSegments()?"partial":this.hasManifest()?"manifest":"none"}}class zg extends Kg{constructor(e){super(),this.props=e,this.preload=U(async()=>{if(await pn(),this.isDestroyed)throw new Error("MpdPreloader was destroyed");const e=new shaka.Player(this.videoElement);this.shakaPlayer=e,this.manifestXmlSpy=new Yg(e);e.getNetworkingEngine().registerRequestFilter((t,i)=>{if(t===shaka.net.NetworkingEngine.RequestType.LICENSE)return new Promise((t,i)=>{e.addEventListener("unloading",i)});i.allowCrossSiteCredentials=this.props.source.sourceParams.withCredentials}),e.configure(this.getInitialShakaConfig()),e.addEventListener("manifestparsed",()=>{const{videoTime:t,utc:i}=this.props.source.sourceParams.startPosition,r=B(t)||B(i);e.isLive()&&!r&&this.destroy()});const i=new Gg;i.setup(e,Q,Q),this.customNetworkingEngine=i;const r=new Promise((t,i)=>{let r=Q;const n=()=>{r(),i(new Error("MpdPreloader: shakaPlayer unloading"))};e.addEventListener("unloading",n);const o=f(this.videoElement,"progress",()=>{const{total:i,audio:n,video:o}=e.getBufferedInfo();if(0===n.length||0===o.length)return;const{start:a,end:s}=i[0]||{},l=s-a,d=this.videoElement.duration;(eg<=Kl(l,jl(.2))||d<=Kl(s,jl(.2)))&&(r(),t())});r=U(()=>{o(),e.removeEventListener("unloading",n)})});return t(Mn({shakaPlayer:e,streamUrl:this.props.source.stream.url,startPosition:this.props.source.sourceParams.startPosition})),r}),this.shakaPlayer=void 0,this.customNetworkingEngine=void 0,this.manifestXmlSpy=void 0,this.abrRestrictionsHelper=void 0,this.videoElement=document.createElement("video"),t(pn()),this.abrRestrictionsHelper=new Mg({getManifestXml:()=>{var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()},getState:this.props.getState,getCapSizes:this.props.getCapSizes}),this.addDestroyHandler(()=>{var e,t,i;null==(e=this.customNetworkingEngine)||e.destroy(),null==(t=this.manifestXmlSpy)||t.destroy(),null==(i=this.shakaPlayer)||i.destroy(),this.customNetworkingEngine=void 0,this.manifestXmlSpy=void 0,this.shakaPlayer=void 0})}getBandwidthEstimate(){var e;if(this.isDestroyed)return;const t=null==(e=this.shakaPlayer)?void 0:e.getStats();return null!=t&&t.estimatedBandwidth?{value:t.estimatedBandwidth,source:t.estimatedBandwidthSource}:void 0}getCachedVariantTrack(){return this.hasCachedSegments()?Tn(this.shakaPlayer):void 0}copyCachedData(){var e;const t=null==(e=this.customNetworkingEngine)?void 0:e.copyCachedData();return{segmentCache:null==t?void 0:t.segmentCache,loadedManifest:null==t?void 0:t.loadedManifest}}getVideoElement(){return this.videoElement}getType(){return this.props.type}getBufferedInfo(){return void 0===this.shakaPlayer?{total:[],audio:[],video:[]}:this.shakaPlayer.getBufferedInfo()}getSource(){return this.props.source}getManifestXml(){var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()}hasManifest(){var e;return void 0!==(null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml())}hasCachedSegments(){var e;return Boolean(null==(e=this.customNetworkingEngine)?void 0:e.hasCachedSegments())}getInitialShakaConfig(){var e,t;const i=this.props.getState(),{stream:r}=this.props.source,n=rn(i),o=new Ng({getPlaybackRate:()=>1,bandwidthEstimateOffset:null!=(e=null==(t=i.controller.playerConfig)?void 0:t.bandwidthEstimateOffset)?e:Ul(0),getSegmentDuration:()=>On(this.shakaPlayer),getFilterParams:()=>({preloadedVariant:void 0,restrictions:this.abrRestrictionsHelper.getAbrRestrictions()}),isLowLatencyLive:()=>!1});return Vn({},og,{abr:Vn({},og.abr,{enabled:!1},null!=n&&n.value?{defaultBandwidthEstimate:n.value,defaultBandwidthEstimateSource:n.source}:{}),abrFactory:function(){return o},drm:Vn({},og.drm,r.drmConfig),streaming:Vn({},og.streaming,{bufferingGoal:eg})})}}var qg;!function(e){e[e.MEDIA_ERR_CUSTOM=0]="MEDIA_ERR_CUSTOM",e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED",e[e.MEDIA_ERR_ENCRYPTED=5]="MEDIA_ERR_ENCRYPTED"}(qg||(qg={}));class Xg{constructor(e){this.code=0,this.message="",this.details=void 0,"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:I(e)&&("number"===typeof e.code&&(this.code=e.code),"string"===typeof e.message&&(this.message=e.message),this.details=e.details),this.message||(this.message=qg[this.code]||"")}}var Qg=e(9388);const{isSupported:Jg}=e(2490),Zg=Jg(),$g=[401,403],{ErrorDetails:ev}=e(3579),tv=[ev.FRAG_LOAD_ERROR,ev.FRAG_LOAD_TIMEOUT,ev.FRAG_PARSING_ERROR,ev.BUFFER_APPEND_ERROR,ev.INTERNAL_EXCEPTION,ev.LEVEL_LOAD_TIMEOUT,ev.MANIFEST_LOAD_ERROR,ev.MANIFEST_LOAD_TIMEOUT],iv=[ev.FRAG_LOAD_ERROR,ev.FRAG_LOAD_TIMEOUT,ev.FRAG_PARSING_ERROR,ev.LEVEL_LOAD_TIMEOUT],rv=[ev.MANIFEST_LOAD_ERROR,ev.MANIFEST_LOAD_TIMEOUT],nv=[ev.FRAG_DECRYPT_ERROR,ev.FRAG_PARSING_ERROR,ev.BUFFER_STALLED_ERROR,ev.BUFFER_NUDGE_ON_STALL];let ov=function(e){return e.LOWRES="lowres",e.HIGHRES="highres",e}({});const av={tiles:"com.yandex.video.thumbnail.lowres.tiles",duration:"com.yandex.video.thumbnail.lowres.duration",resolution:"com.yandex.video.thumbnail.lowres.resolution",uri:"com.yandex.video.thumbnail.lowres.uri"},sv={tiles:"com.yandex.video.thumbnail.tiles",duration:"com.yandex.video.thumbnail.duration",resolution:"com.yandex.video.thumbnail.resolution",uri:"com.yandex.video.thumbnail.uri"},lv=[Yl(4320),Yl(2880),Yl(2160),Yl(1440),Yl(1080),Yl(720),Yl(576),Yl(480),Yl(360),Yl(240),Yl(144)],dv=Math.min(...lv.slice(1).map((e,t)=>lv[t]/e));let cv=function(e){return e.WAS_WORKER_INTERNAL_ERROR="YANDEX_PLAYER_HLS_WAS_WORKER_INTERNAL_ERROR",e}({});let uv=function(e){return e.HasAd="HasAd",e.NoAd="NoAd",e.NoData="NoData",e}({});const hv=/^(\d+)x(\d+)@(\d+)$/,pv=function(){const{volume:e}=As;As.volume=0===e?1:0;const t=As.volume!==e;return As.volume=e,t}(),fv=Yl(1080),gv=Yl(720);let vv=function(e){return e.VideoTagPaused="VideoTagPaused",e.VideoTagPausedAfterDurationChange="VideoTagPausedAfterDurationChange",e.VideoTagPausedAfterError="VideoTagPausedAfterError",e.PauseEvent="PauseEvent",e.ProgressEvent="ProgressEvent",e.PromiseResolve="PromiseResolve",e.PromiseReject="PromiseReject",e.PlayingEvent="PlayingEvent",e.Timeout="Timeout",e}({});const mv={once:!0,passive:!0};class Av{constructor(e){this.props=e,this.currentAttempt=0,this.recovering=!1,this.plannedTaskPromise=void 0,this.resetTimeoutId=0}get allowed(){return this.currentAttempt<this.props.maxAttempts}get started(){return this.currentAttempt>0}get attempt(){return this.currentAttempt}getState(){return this.started?qp.ON:qp.OFF}planTask(e,i){let r,{reason:n,delay:o,force:a,rawData:s}=i;if(this.recovering&&!a)return this.log("Can't plan task cause is in process of recover"),void this.props.onConcurrentRecover({reason:n,rawData:s});this.clearPlannedTask("new task planned"),this.clearResetTimeout("new task planned"),"number"===typeof o?(r=Zl(o).promise.then(Q),this.log("#"+this.currentAttempt+", PLAN task, "+o+"ms, ["+n+"]",s)):(r=o,this.log("#"+this.currentAttempt+", PLAN async task, ["+n+"]",s)),t(r),r.then(()=>{if(r===this.plannedTaskPromise)return this.recovering=!0,this.currentAttempt++,this.props.onRunTask({reason:n,delay:o,rawData:s,attempt:this.currentAttempt}),this.log("#"+this.currentAttempt+", RUN task, ["+n+"]",s),this.clearPlannedTask(),e()}).catch(e=>{this.log("Error while recover",e),this.props.onRecoverError({reason:n,rawData:s},e)}).then(()=>{this.recovering=!1}),this.plannedTaskPromise=r}isRecovering(){return this.recovering}planReset(e){let{reason:t,delay:i}=e;this.log("plan RESET, "+i+"ms, if ["+t+"]"),this.clearResetTimeout("new reset planned"),this.resetTimeoutId=window.setTimeout(()=>{this.reset(t)},i)}destroy(){this.reset("destroy")}reset(e){this.props.onReset(),this.log("RESET because of ["+e+"]"),this.clearPlannedTask(),this.clearResetTimeout(),this.currentAttempt=0}log(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];pp.log("RecoverHelper:",...t)}clearPlannedTask(e){e&&this.log("CLEAR planned TASKS because of ["+e+"]"),this.plannedTaskPromise=void 0}clearResetTimeout(e){e&&this.log("CLEAR planned RESET because of ["+e+"]"),0!==this.resetTimeoutId&&(clearTimeout(this.resetTimeoutId),this.resetTimeoutId=0)}}class Ev extends Td{destroy(){this.emit("Destroy"),this.off("Destroy"),Object.keys(this.handlers).forEach(e=>{this.off(e)}),Object.keys(this.onceHandlers).forEach(e=>{this.off(e)})}}class yv extends Ev{constructor(e,t){super();let i={videoWidth:e.videoWidth,videoHeight:e.videoHeight};const r=()=>{const{videoWidth:r,videoHeight:n}=e;isNaN(r)||isNaN(n)||r<1||n<1||i.videoWidth===r&&i.videoHeight===n||(i={videoWidth:r,videoHeight:n},t({videoWidth:r,videoHeight:n}))};if("onresize"in e)e.addEventListener("resize",r),this.once("Destroy",()=>e.removeEventListener("resize",r));else{e.addEventListener("timeupdate",r),this.once("Destroy",()=>e.removeEventListener("timeupdate",r));const t=setInterval(r,Gl(1e3));this.once("Destroy",()=>clearInterval(t))}}}var Sv=e(7724),Tv=e.n(Sv);const Rv={droppedVideoFrames:0,corruptedVideoFrames:0,totalVideoFrames:0},Pv=Yl(360);class _v{constructor(e){void 0===e&&(e={}),this.timeMeasurer=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.totalDecodedFrames=0,this.totalDroppedFrames=0,this.lastVideoWidth=void 0,this.lastVideoHeight=void 0,this.maxWidth=1/0,this.maxHeight=1/0,this.props=void 0,this.props=e}setRestrictions(e,t){var i,r;e>=this.maxWidth&&t>=this.maxHeight||t<Pv||(this.maxWidth=e,this.maxHeight=t,pp.warn("FPSController changed restrictions: "+e+"\xd7"+t+"."),null==(i=(r=this.props).onRestrictionsChange)||i.call(r,{decodedFrames:this.totalDecodedFrames,droppedFrames:this.totalDroppedFrames,maxWidth:e,maxHeight:t}))}getRestrictions(){return{maxWidth:this.maxWidth,maxHeight:this.maxHeight}}update(e){if(!e.videoWidth||!e.videoHeight)return;const t=ko(e);this.checkFPS(Yl(e.videoWidth),Yl(e.videoHeight),t.totalVideoFrames,t.droppedVideoFrames)}checkFPS(e,t,i,r){!this.timeMeasurer||!i||this.lastVideoWidth!==e||this.lastVideoHeight!==t||i<this.lastDecodedFrames?(this.timeMeasurer=H(),this.totalDecodedFrames=0,this.totalDroppedFrames=0):(this.totalDroppedFrames+=r-this.lastDroppedFrames,this.totalDecodedFrames+=i-this.lastDecodedFrames,this.timeMeasurer()>5e3&&this.totalDroppedFrames>.25*this.totalDecodedFrames&&this.setRestrictions(e,t)),this.lastDecodedFrames=i,this.lastDroppedFrames=r,this.lastVideoWidth=e,this.lastVideoHeight=t}}const bv=Gl(100);class Iv{constructor(e,t){this.win=e,this.callback=t,this.started=!1,this.intervalId=0,this.getDiff=H()}start(){this.started||(this.started=!0,this.getDiff=H(),this.intervalId=this.win.setInterval(()=>{const e=Gl(this.getDiff());this.getDiff=H(),this.callback(e)},bv))}stop(){this.started&&(this.started=!1,this.win.clearInterval(this.intervalId))}}const Cv=null===As.onwaiting,Ov=!Cv||Gs||sd?(e,t)=>{let i=0,r=!1;return N(()=>{const n=e.currentTime,o=e.duration;if(!e.paused){const e=i+.004;r?n>e&&(t(!1),r=!1):n<e&&n!==o&&(t(!0),r=!0)}i=n})}:(e,t)=>{let i=!1;const r=f(e,"pause",()=>{i&&(i=!1,t(!1))},{passive:!0}),n=f(e,"waiting",()=>{i||(i=!0,t(!0))},{passive:!0}),o=f(e,"playing",()=>{i&&(i=!1,t(!1))},{passive:!0}),a=f(e,"canplay",()=>{i&&(i=!1,t(!1))},{passive:!0});return()=>{r(),n(),o(),a()}},wv=jl(0),kv=jl(30),Dv=jl(7),Nv=jl(15);class Lv extends Td{get state(){return this.playerStore.getState()}get fragDuration(){return this.getFragmentsData().fragmentDuration}get isDestroyed(){return this.destroyed}async requestDebugInfo(){return{notImplemented:!0}}constructor(e){var t;super(),this.props=e,this.engine=void 0,this.recoverHelper=void 0,this.adShown=!1,this.video=void 0,this.wasPausedAfterQualityChanged=!1,this.currentTextTrack=void 0,this.withCredentials=!1,this.playerStore=void 0,this.currentState=void 0,this.videoTrackLabels=new Map,this.previousScreenshotBlobUrl=void 0,this.destroy=U(()=>(this.destroyed=!0,this.destroyUnsafe())),this.destroyed=!1,this.tickController=void 0,this.fpsController=new _v({onRestrictionsChange:e=>{this.props.logEvent({event:"FPSControllerRestrictions",params:e})}}),this.currentSubtitles=[],this.bandwidthEstimateUpdateInterval=null,this.preventPauseState=void 0,this.playDeferred=void 0,this.isPauseHandlerCalled=void 0,this.restoreUserTracks=()=>{this.restoreUserTextTrack(),this.restoreUserAudioTrack(),this.restoreUserVideoTrack()},this.refreshSubtitles=()=>{try{if(!this.video)return;const e=this.getCurrentTextTrack(),t=e?K(e.activeCues).filter(e=>e&&e.text).map(e=>{let{text:t}=e;return t}):[];wp()(this.currentSubtitles,t)||(this.currentSubtitles=t,this.props.onSubtitlesChange(t))}catch(kE){kE instanceof Error&&this.props.onError(new jc(kE,{code:Cs.REFRESH_SUBTITLES_ERROR,isFatal:!1}))}},this.disableSubtitlesNative=()=>{this.video&&Io(this.video.textTracks).forEach(e=>{e&&(e.mode="disabled")})},this.emptySubtitles=()=>{this.currentSubtitles.length>0&&(this.currentSubtitles=[],this.props.onSubtitlesChange([]))},this.handleConcurrentRecover=e=>{this.props.logEvent({event:"ConcurrentRecoverCalled",params:e})},this.handleRecoverError=(e,t)=>{this.props.onError(new jc({code:Cs.RECOVER_TASK_ERROR,isFatal:!1,details:e,stack:null==t?void 0:t.stack}))},this.setMaxListeners(42),this.isPauseHandlerCalled=this.props.video.paused,this.recoverHelper=new Av({maxAttempts:null!=(t=e.maxRecoverAttempts)?t:10,onRunTask:this.props.onRecover,onReset:()=>this.playerStore.dispatch(eh(void 0)),onConcurrentRecover:this.handleConcurrentRecover,onRecoverError:this.handleRecoverError}),this.on("Destroy",()=>this.recoverHelper.destroy());const{video:i,playerStore:r,sourceParams:n}=this.props;this.video=i,this.playerStore=r,this.setLoop(Boolean(e.sourceParams.loop)),this.withCredentials=Boolean(e.sourceParams.withCredentials),this.setPoster(n.preview),this.updateNativeControlsVisibility();const o=this.playerStore.getState().controller.preload||fd;i.setAttribute("preload",o?"auto":"none");const a=f(i,"loadstart",()=>{this.video.style.opacity="1"});this.on("Destroy",a),this.tickController=new Iv(window,e=>{try{this.onTick(Gl(e))}catch(kE){kE instanceof Error&&this.props.onError(new jc(kE,{code:Cs.ON_TICK_ERROR,isFatal:!1}))}}),this.on("Destroy",()=>this.tickController.stop()),this.on("InternalPlayingStateChange",this.updateBufferGoal),Promise.resolve().then(()=>{this.initInternalSubscribe()})}initInternalSubscribe(){this.on("VideoPlayingStateChange",e=>{if(e!==$l.END||ei(this.state)){if(e===$l.PLAY&&!ei(this.state)){const e=this.fragDuration<=2*Lh?1e3*this.fragDuration:1e3*Lh;this.recoverHelper.planReset({delay:e,reason:"no new errors for "+e+"ms"})}}else this.recoverHelper.reset("onPlayingStateChange ["+$l.END+"]")}),this.on("InternalPlayingStateChange",e=>{const{encoderState:t}=this.state.controller;(t===xh.Attaching||t===xh.Attached)&&this.currentState!==e&&(this.isBufferingOnPreload(e)||this.currentState===$l.END&&this.video.paused||(this.currentState=e,this.emit("VideoPlayingStateChange",e)))}),this.on("CurrentTimeChange",e=>{const t=this.getDuration(),{videoType:i}=this.state.controller;e>=t&&t>0&&i===Bh.VOD&&!this.props.sourceParams.loop&&this.emit("InternalPlayingStateChange",$l.END)}),this.on("InternalVideoTrackValueChange",Ro(e=>{this.emit("VideoTrackValueChange",e)})),this.on("InternalAudioTrackValueChange",Ro(e=>{this.emit("AudioTrackValueChange",e)})),this.on("InternalTextTrackValueChange",Ro(e=>{this.emit("TextTrackValueChange",e)})),this.addVideoEventListener(null===this.video.onplaying?"playing":"play",()=>this.handleVideoElementPlayEvent()),this.addVideoEventListener("loadedmetadata",()=>{this.emit("DurationChange",this.getDuration())}),this.addVideoEventListener("play",()=>{this.isPauseHandlerCalled=!1}),this.addVideoEventListener("seeked",()=>{this.emit("Seeked")});let e=this.video.playbackRate;this.addVideoEventListener("ratechange",()=>{const t=this.video.playbackRate,i=this.state.controller.playbackRate;if(e===t)return;const r=e;e=t,ei(this.state)||this.recoverHelper.isRecovering()||0===t||t===i||(0===r&&t!==i?this.setPlaybackRate(i):t!==this.state.controller.playbackRate&&this.playerStore.dispatch(Ju(t)))}),this.addVideoEventListener("pause",()=>this.onPause()),this.addVideoEventListener("progress",()=>{ei(this.state)||this.emit("BufferingRangesChange",function(e){const t=[];for(let i=0;i<e.buffered.length;i++)t.push({start:jl(e.buffered.start(i)),end:jl(e.buffered.end(i))});return function(e){const t=e.map(e=>{let{start:t,end:i}=e;return{start:t,end:i}}).sort((e,t)=>e.start-t.start);if(t.length<=1)return t;const i=[t[0]];return t.slice(1).forEach((e,t)=>{const r=i[i.length-1];r.end<e.start?i.push(e):r.end<e.end&&(r.end=e.end)}),i}(t)}(this.props.video))}),this.addVideoEventListener("canplay",()=>{this.emit("CanPlay",void 0)}),this.addVideoEventListener("ended",()=>{const{videoType:e}=this.playerStore.getState().controller;e===Bh.VOD||void 0===e?this.emit("InternalPlayingStateChange",$l.END):this.video.paused&&pp.warn('Pause stream after "ended" event on LIVE stream')}),this.addVideoEventListener("loadeddata",()=>{this.emit("LoadedData",void 0)}),this.addVideoEventListener("error",e=>this.onVideoTagError(e)),this.handleSubtitles(),this.addVideoEventListener("timeupdate",()=>{ei(this.state)||this.state.controller.playingState===$l.PAUSE||this.fpsController.update(this.video)}),this.addVideoEventListener("durationchange",()=>{ei(this.state)||this.dispatchOnDurationChange()}),this.on("DvrChange",()=>this.updateDVRParams())}async play(){if(this.preventPauseState)return this.preventPauseState=Do({},this.preventPauseState,{shouldPlayAfterEnd:!0}),pp.log("play method call during preventPauseAsync operation"),this.playDeferred||(this.playDeferred=new dd,this.playDeferred.promise.catch(Q).then(()=>{this.playDeferred=void 0})),this.playDeferred.promise;await this.playInternal()}getFragmentsData(){return{totalDuration:this.getDuration(),fragmentDuration:Lh,startTime:jl(0)}}getUtcStartTime(){return wv}getUtcPosition(){return wv}async attachEncoder(){this.tickController.start(),this.bandwidthEstimateUpdateInterval=window.setInterval(()=>{this.playerStore.dispatch(fu(this.getBandwidthEstimate())),Zr(this.getBandwidthEstimate())},5e3),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=this.state.controller.playbackRate);const e=new yv(this.video,()=>{this.onVideoResize()});this.once("Detach",()=>e.destroy())}onVideoTagError(e){!this.video.src&&!ei(this.state)&&(this.video.style.opacity="0")}captureScreenshot(e){return Promise.resolve(void 0)}clearScreenshot(){this.previousScreenshotBlobUrl&&(URL.revokeObjectURL(this.previousScreenshotBlobUrl),this.previousScreenshotBlobUrl=void 0)}seek(e){if(!this.canSeek())return void this.playerStore.dispatch(ju({videoTime:e}));this.playerStore.dispatch(eh(void 0));const{start:t,end:i}=this.getSeekableRange(),{currentTime:r,bufferingRanges:n}=this.state.controller,o=l(e,t,i);void 0===_i(n,o)&&this.props.onExpectedStalledChange(ut(Fh.Seek,{oldPosition:r,newPosition:o})),wn(this.video,jl(o)),this.emit("CurrentTimeChange",this.getCurrentTime())}setPlaybackRate(e){const t=this.video.playbackRate;if(t===e)return;this.video.playbackRate=e;const i=this.video.playbackRate;i!==t&&this.playerStore.dispatch(Ju(i))}getUtcEndTime(){return jl(0)}static isLiveStreamUrl(e){return e.startsWith("https://strm.yandex.ru/live/")||e.startsWith("https://streaming.tst.strm.yandex.net/live/")}updateNativeControlsVisibility(){const e=!id(this.state.skin.hiddenControls)&&(this.state,!0);this.playerStore.dispatch(Ih(e)),To(this.video,{controls:e?"controls":null}),this.video.classList.toggle(Tv().video_hiddenControls,!e),this.setNativeTimeControlVisibility(Po(this.state)),this.setNativeTimelineControlVisibility(Po(this.state))}detachEncoder(){if(this.tickController.stop(),this.state.controller.encoderState===xh.Attached){const e=this.getBandwidthEstimate();this.playerStore.dispatch(fu(e)),Zr(e)}return null!==this.bandwidthEstimateUpdateInterval&&clearInterval(this.bandwidthEstimateUpdateInterval),this.emit("BufferingRangesChange",[]),this.emit("InternalVideoTrackValueChange",void 0),this.emit("InternalAudioTrackValueChange",void 0),this.emit("InternalTextTrackValueChange",void 0),this.emit("Detach",void 0),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=1),Promise.resolve()}async preloadSource(){pp.log("preloadSource() is not implemented for "+this.engine)}createCachePreloader(){}setLoop(e){const{video:t}=this.props,{loop:i}=this.video;e!==i&&(t.loop=e)}isPaused(){return this.props.video.paused}pause(){var e;this.recoverHelper.reset("pause"),this.props.video.pause(),this.onPause(),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()"))}getDuration(){return jl(this.video.duration)}getCurrentTime(){return Wl(Xl(Math.floor(ql(this.props.video.currentTime,1e3)),1e3))}getVideoWidth(){return this.video.videoWidth}getVideoHeight(){return this.video.videoHeight}setVolume(e){!function(e){return"number"===typeof e&&0<=e&&e<=1}(e)?pp.warn("setVolume wrong value"):pv?this.video.volume=e:pp.warn("cannot change video volume")}getVolume(){return this.video.volume}setMuted(e){this.video.muted=e}getMuted(){return this.video.muted}setPoster(e){this.state.skin.nativeControlsVisibility&&(this.removePoster(),this.props.video.setAttribute("poster",e||ld))}removePoster(){this.props.video.removeAttribute("poster")}getConnectionQuality(){return Pp({fragDuration:ql(this.fragDuration,1e3),timings:this.props.resourceTimingsMonitor.getAllResourcesTimings()})}isDvrEnabled(){return!0}toggleNativeSubtitles(e){const t=this.state.skin.useNativeSubtitles;if(t===e)return;const i=Co(t),r=Co(e);this.playerStore.dispatch(Dp(e)),Io(this.video.textTracks).forEach(e=>{e&&(e.mode=i===e.mode?r:"disabled")})}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getRecoverHelperState(){return this.recoverHelper.getState()}getContainerSize(){const e=this.getVideoElementSize();return{width:ql(e.width,devicePixelRatio),height:ql(e.height,devicePixelRatio)}}getCapSizes(){var e,t;const i=null!=(e=this.props.getPipWindowSize())?e:function(e,t,i){let{videoWidth:r,videoHeight:n}=e;const{width:o,height:a}=i;if(!r||!n)return{width:o,height:a};switch(t){case"none":return{width:Yl(r),height:Yl(n)};case"cover":{const e=Yl(Math.floor(n*o/r));return e>=a?{width:o,height:e}:{height:a,width:Yl(Math.floor(r*a/n))}}case"contain":case"scale-down":{const e=Yl(Math.floor(n*o/r));return e<=a?{width:o,height:e}:{height:a,width:Yl(Math.floor(r*a/n))}}case"fill":default:return{width:o,height:a}}}(this.video,(null==(t=this.state.controller.videoElementStyle)?void 0:t.objectFit)||"contain",this.props.videoSizeSensor.getSize()),r=i.height>i.width,n=((e,t)=>!t&&("video_related:video_page"===e||"video_related:video_related"===e))(this.state.controller.streamBlock,r),o=((e,t)=>null===e?Yl(1/0):void 0===e?t?gv:fv:Yl(e))(this.props.defaultQuality,r),a=ql(n?Yl(Math.max(screen.height,i.height)):i.height,devicePixelRatio),s=ql(n?Yl(Math.max(screen.width,i.width)):i.width,devicePixelRatio),l=e=>n?o:Math.max(Math.min(e,o),Cg),d=Yl(r?a:l(a)),c=Yl(r?l(s):s);return Do({width:c,height:d,maxWidth:n?void 0:c,maxHeight:n?void 0:d},this.props.capSizesOverride)}getMaxCapAllowedVideoTrack(){}getRemainingBufferedTime(){return{total:Ii(this.state)||jl(0)}}getSegmentSize(){}getBandwidthEstimate(){return rn(this.playerStore.getState())}async recoverStream(){const e=this.getPositionToRecover();this.playerStore.dispatch(ju(e)),await this.detachEncoder(),await this.attachEncoder()}getLiveLatency(){if(!this.isLiveStreaming())return;const e=this.getUtcPosition(),t=this.getServerTime();return e>0&&void 0!==t?jl(Math.max(t/1e3-e,0)):void 0}getServerTime(){}getPlayingState(){return this.currentState}isLiveStreaming(){const{state:e}=this;if(!di(e)||ei(e))return!1;const{controller:{playingState:t,currentTime:i,duration:r}}=e;return!(t!==$l.PLAY&&t!==$l.BUFFERING)&&!(0===i||!r)}subscribeVideoBuffering(){const{video:e}=this,t=Ov(e,t=>{const i=Oo(e,t);if(this.isStalledLiveEdge(i)){const e=ut(Fh.LiveEdge,void 0);this.props.onExpectedStalledChange(e)}this.emit("InternalPlayingStateChange",i)});this.once("Destroy",t)}updateVideoSize(){const{videoWidth:e,videoHeight:t}=this.video;this.state.controller.videoWidth===e&&this.state.controller.videoHeight===t||this.playerStore.dispatch(Du({videoWidth:Yl(e),videoHeight:Yl(t)}))}isStalledLiveEdge(e){const{video:t}=this,{controller:{videoType:i}}=this.state,r=e===$l.BUFFERING,n=i===Bh.EVENT||i===Bh.LIVE,o=t.seekable.length>0&&t.seekable.end(0)-t.currentTime<2.5;return r&&n&&o}getPositionToRecover(){const{programDateTime:e,currentTime:t,startPosition:i}=this.state.controller,r={utc:void 0===e?void 0:Kl(Xl(e,1e3),t),videoTime:t};return t?r:i}subscribeContentImpression(){this.once("Detach",function(e,t){const i=f(e,"timeupdate",()=>{e.currentTime>0&&!e.paused&&(n(),t())}),r=f(e,"playing",()=>{e.duration>0&&(n(),t())}),n=()=>{i(),r()};return n}(this.video,()=>{this.emit("ContentImpression",void 0)}))}onTick(e){const t=this.getCurrentTime();t===this.state.controller.currentTime&&0!==t||this.emit("CurrentTimeChange",t),this.video.paused&&this.currentState===$l.PLAY&&!this.wasPausedAfterQualityChanged&&this.state.controller.encoderState!==xh.Attaching&&this.state.controller.playingState!==$l.PAUSE&&this.emit("InternalPlayingStateChange",$l.PAUSE),this.setPlaybackRateCatchup()}addVideoEventListener(e,t,i){let{once:r}=void 0===i?{}:i,n=t;const{video:o}=this,a=()=>{o.removeEventListener(e,n)};return r&&(n=e=>{this.off("Destroy",a),a(),t.call(o,e)}),this.on("Destroy",a),this.video.addEventListener(e,n),a}addEventListener(e,t,i,r){const n=f(e,t,i,r);this.once("Destroy",n)}getSeekableRange(){return{start:jl(0),end:this.getDuration()||jl(0)}}setNativeTimeControlVisibility(e){this.video.classList.toggle(Tv().video_hiddenTime,!e)}setNativeTimelineControlVisibility(e){this.video.classList.toggle(Tv().video_hiddenTimeline,!e)}getVisibleTextTrackMode(){return Co(this.state.skin.useNativeSubtitles)}getHiddenTextTrackMode(){return"disabled"}getCurrentTextTrack(){if(!this.video)return;const e=this.getVisibleTextTrackMode();return Io(this.video.textTracks).find(t=>void 0!==t&&t.mode===e)}restoreUserTextTrack(){const{userTextTrackEnabled:e}=this.state.controller;if(void 0!==e)if(e){const e=function(e){const{userTextTrackName:t,userTextTrackLang:i,textTracks:r}=e.controller;return Zt(r,{name:t,lang:i})}(this.state);e&&this.setTextTrack(e)}else this.disableTextTrack()}restoreUserAudioTrack(){const e=function(e){const{userAudioTrackName:t,userAudioTrackLang:i,audioTracks:r}=e.controller;return fo(r,{name:t,lang:i})}(this.playerStore.getState());e&&(pp.log("Set audio track by user params audioTrack=["+JSON.stringify(e)+"]"),this.setAudioTrack(e))}restoreUserVideoTrack(){const e=function(e){const{videoTracks:t,userVideoTrackName:i,userVideoTrackHeight:r}=e.controller;return go(t,{name:i,height:r})}(this.playerStore.getState());e&&(pp.log("Set video track by user params videoTrack=["+JSON.stringify(e)+"]"),this.setVideoTrack(e))}updateSkinDvrParameters(e){const t=Xl(e,1e3),{skin:{skinDVRStartTime:i,skinDVRDuration:r},controller:{videoType:n,dvrDuration:o,duration:a}}=this.state;if(n===Bh.LIVE){const e=jl(Math.min(Kl(i,t),a||jl(0)));this.playerStore.dispatch(Xu(e)),this.emit("DVRStartTimeChange",e)}else if(n===Bh.EVENT){const e=jl(Math.min(Kl(r,t),o));this.playerStore.dispatch(Qu(e)),this.emit("DVRDurationChange",e)}}async destroyUnsafe(){this.emit("Destroy",void 0),await this.detachEncoder();const{error:e}=this.state.controller.errorInfo;e&&e.isFatal&&this.video.src&&this.video.removeAttribute("src")}async preventPauseAsync(e,i){const{paused:r}=e,n=i();this.preventPauseState||(this.preventPauseState={promises:[],shouldPlayAfterEnd:!r}),this.preventPauseState.promises.push(n);const o=await n;if(this.preventPauseState){const e=this.preventPauseState.promises.length;Promise.all(this.preventPauseState.promises).catch(Q).then(()=>{this.preventPauseState&&e===this.preventPauseState.promises.length&&(this.preventPauseState.shouldPlayAfterEnd&&t(this.playInternal()),this.preventPauseState=void 0)})}return o}getVideoOwnerDocument(){return this.video.ownerDocument||document}getStreamUrl(){return this.props.stream.url}shouldUseLowBuffer(){const{startStage:e,autoplay:t,preload:i,feed:r}=this.state.controller;return!(!this.video.paused||!r)||e!==Vh.started&&!t&&i}isBufferingOnPreload(e){return e===$l.BUFFERING&&(!!this.state.controller.preload&&(this.state.controller.startStage!==Vh.started&&this.state.controller.startStage!==Vh.starting))}getMaxBufferLength(){if(this.shouldUseLowBuffer())return eg;if(this.state.controller.feed&&this.getCurrentTime()<kv)return Dv;if(this.state.controller.feed)return Nv;if(this.getCurrentTime()<kv)return Nv;const{maxBufferLength:e=Fg}=this.props;return e}handleVideoElementPlayEvent(){this.wasPausedAfterQualityChanged=!1,this.emit("InternalPlayingStateChange",$l.PLAY)}updateBufferGoal(){}isLowLatencyLive(){return!1}onVideoResize(){this.updateVideoSize()}onPause(){this.video.paused&&(this.isPauseHandlerCalled||(this.isPauseHandlerCalled=!0,this.wasPausedAfterQualityChanged||this.video.ended||this.getCurrentTime()>=this.getDuration()||this.emit("InternalPlayingStateChange",$l.PAUSE)))}calculateDVRParams(){const{fragmentDuration:e,startTime:t,totalDuration:i}=this.getFragmentsData();return{fragmentDuration:e,dvrDuration:i,dvrStartTime:t,skinDVRDuration:i,skinDVRStartTime:t}}updateDVRParams(){const{fragmentDuration:e,dvrStartTime:t,dvrDuration:i,skinDVRStartTime:r,skinDVRDuration:n}=this.calculateDVRParams();this.playerStore.dispatch(Yu(e));const{dvrDuration:o,dvrStartTime:a}=this.state.controller;wp()(o,i)||(this.playerStore.dispatch(qu(i)),this.playerStore.dispatch(Qu(n)),this.emit("DVRDurationChange",n)),wp()(a,t)||(this.playerStore.dispatch(zu(t)),this.playerStore.dispatch(Xu(r)),this.emit("DVRStartTimeChange",r))}setPlaybackRateCatchup(){const e=function(e,t,i){if(!di(e)||ei(e)||!i)return;const{controller:{playingState:r,playbackRate:n}}=e;if(r!==$l.PLAY)return;const o=t.total;let a;if(o<2){const e=5*(o-2);a=.97+.06/(1+Math.pow(Math.E,-e))}else{const e=.02;if(Math.abs(i-7)<=7*e)a=1;else{const e=5*(i-7);a=.97+.06/(1+Math.pow(Math.E,-e))}}return Math.abs(n-a)<=vp&&(a=void 0),a}(this.state,this.getRemainingBufferedTime(),this.getLiveLatency());void 0!==e&&this.isLowLatencyLive()&&this.setPlaybackRate(e)}getVideoElementSize(){var e;const t=this.props.videoSizeSensor.getSize();return null!=(e=this.props.getPipWindowSize())?e:{width:Yl(t.width),height:Yl(t.height)}}handleSubtitles(){const{textTracks:e}=this.video;e&&"function"===typeof e.addEventListener&&(this.on("Destroy",f(e,"addtrack",e=>{const{track:t}=e;t&&"subtitles"===t.kind&&this.on("Destroy",f(t,"cuechange",this.refreshSubtitles))})),this.on("TextTrackValueChange",e=>{void 0===e?this.emptySubtitles():this.refreshSubtitles()}),this.on("Destroy",N(this.refreshSubtitles)),this.on("Detach",this.disableSubtitlesNative))}dispatchOnDurationChange(){const e=this.getDuration();isNaN(e)||this.state.controller.duration!==e&&this.emit("DurationChange",e)}playInternal(){const e=_o(this.video);return e.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()}).catch(e=>{var t;String(e).includes("no supported sources")&&this.props.onError(new jc({code:Cs.UNSUPPORTED_MEDIA_TYPE,isFatal:!0})),null==(t=this.playDeferred)||t.reject(e)}),e.then(Q)}shouldLogStalledDebugInfo(){return!1}}const Mv=Yl(1/0);class Vv extends Lv{initInternalSubscribe(){super.initInternalSubscribe(),this.on("VideoPlayingStateChange",e=>{e===$l.PLAY?this.recoverHelper.reset("play"):e===$l.END?this.stopLoad():e===$l.BUFFERING&&this.tryRecoverOnBuffering()}),this.subscribeVideoBuffering()}constructor(e){super(e),this.props=e,this.engine=Qp.HLS,this.preloadSourceHLSEncoder=void 0,this.preloadSourceHandlers=[],this.preloadPosition={},this.HLSEncoder=void 0,this.lastKnownLevelDetails=void 0,this.HLSEncoderAttachTime=1/0,this.loadStarted=!1,this.recoverOnBufferingReason=null,this.initHlsEncoderPromise=void 0,this.maxHeightCapping=void 0,this.levelForcingInterval=void 0,this.lastFragRequest=void 0,this.restoreUserTracksWhenPossible=()=>{const{HLSEncoder:e}=this;if(!e)return;if(!e.levels||0===e.levels.length)return void e.once(Hls.Events.MANIFEST_LOADED,this.restoreUserTracksWhenPossible);B(this.HLSEncoderAttachTime)?this.restoreUserTracks():e.once(Hls.Events.MEDIA_ATTACHED,this.restoreUserTracks)},this.onLevelUpdated=()=>{this.emit("VideoTypeChange",this.getVideoType());const e=this.getHlsEncoderLevelDetails();if(e&&e.fragments&&e.fragments.length>0){const[t]=e.fragments;t.programDateTime&&this.emit("ProgramDateTimeChange",ql(this.getUtcStartTime(),1e3))}},this.onSubtitleTracksUpdated=()=>{this.HLSEncoder&&this.emit("TextTracksChange",function(e){const t=[];return Array.isArray(e)&&e.forEach(e=>{const i=ao(e);i&&t.push(i)}),t}(this.HLSEncoder.subtitleTracks))},this.onAudioTracksUpdated=()=>{const{HLSEncoder:e}=this;if(!e)return;const{audioTracks:t}=e;e.config.maxBufferSize=t.length>0?12e6:Hls.DefaultConfig.maxBufferSize,this.emit("AudioTracksChange",function(e){const t=[];return Array.isArray(e)?(e.forEach(e=>{const i=oo(e);i&&t.push(i)}),t):[]}(t))},t(hn()),this.playerStore.dispatch(th(!0))}getEngine(){return Qp.HLS}getFragmentsData(){const e=this.getHlsEncoderLevelDetails();if(!e)return super.getFragmentsData();const{totalduration:t,targetduration:i,fragments:r}=e,[n]=r;return n?{totalDuration:jl(Math.min(t,this.getDuration())),fragmentDuration:jl(i),startTime:jl(n.start)}:super.getFragmentsData()}onOnline(){this.startLoadOnce(this.video.currentTime)}onOffline(){this.stopLoad()}play(){return this.startLoadOnce(),super.play()}getUtcStartTime(){const e=this.getHlsEncoderLevelDetails();if(!e||!e.hasProgramDateTime)return jl(0);const[t]=e.fragments;return t&&t.programDateTime?zl(Xl(Gl(t.programDateTime),1e3),jl(t.start)):jl(0)}getUtcPosition(){const e=this.getUtcStartTime();return e>0?Kl(e,this.getCurrentTime()):super.getUtcPosition()}setVideoTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const{levels:i}=t;if(void 0===i)return;const r=e.value===Wp.value?-1:i.findIndex(t=>t.url.some(t=>t===e.value));-1===r?this.startLevelForcingWithSizeCap():this.stopLevelForcingWithSizeCap();const n=this.isPaused();t.currentLevel=r,!n&&this.isPaused()&&(this.wasPausedAfterQualityChanged=!0,this.emit("InternalPlayingStateChange",$l.BUFFERING))}setAudioTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const i=t.audioTracks.find(t=>e.value===String(t.id));i&&(t.audioTrack=Number(i.id))}setTextTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const i=this.getHlsTextTrack(e);i&&(this.emit("InternalTextTrackValueChange",e&&e.value),t.subtitleTrack=i.id)}disableTextTrack(){this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e);const{HLSEncoder:t}=this;void 0!==t&&(t.subtitleDisplay=e)}async preloadSource(){let e=!1;const t=()=>{e=!0};this.once("Destroy",t),this.once("Detach",t);try{await hn()}catch(a){return void(a instanceof Error&&this.props.onError(new jc(a,{code:Cs.SCRIPT_INIT_ERROR,isFatal:!1})))}if(e||this.HLSEncoder||this.initHlsEncoderPromise||this.preloadSourceHLSEncoder)return;const i=No({},this.getHlsJsConfig(),{liveSyncDuration:Lh}),r=window.hls=this.preloadSourceHLSEncoder=new Hls(i),n=(e,t)=>{this.preloadSourceHandlers.push([e,t]),r.once(e,t)};((e,t)=>{this.preloadSourceHandlers.push([e,t]),r.on(e,t)})(Hls.Events.ERROR,(e,t)=>{if(!t)return;const i=Xn(t),n=Jn(t);void 0!==n&&(this.props.onError(new jc(n,{isFatal:!1})),i&&(this.props.onError(new jc({code:Cs.PRELOAD_SOURCE_FAILED,isFatal:!1,details:{reason:n}})),this.unsubscribePreloadSourceHandlers(),r.destroy(),this.clearPreloadSourceHlsEncoder()))});const o=()=>{this.preloadPosition=this.state.controller.startPosition,r.config.startFragPrefetch=!0,this.loadStarted=!0};n(Hls.Events.MANIFEST_PARSED,(e,t)=>{let{levels:i=[],audioTracks:a=[]}=t;const s=this.getStartVideoLevelIndex(i);r.startLevel=s,this.state.controller.isAbrEnabled||(r.loadLevel=s);this.getStartAudioTrackIndex(a)>-1&&(r.audioTrack=this.getStartAudioTrackIndex(a));const l=this.getStartLoadPosition();n(Hls.Events.LEVEL_UPDATED,(e,t)=>{let{details:i}=t;const n=this.getStartLoadPosition(i);l!==n&&void 0!==n&&r.streamController.startLoad(n),o()}),r.startLoad(l)}),r.loadSource(this.getStreamUrl())}async attachEncoder(){if(await super.attachEncoder(),!Zg){const e=Cs.HLS_JS_NOT_SUPPORTED_ERROR;return this.props.onError(new jc({code:e})),Promise.reject(s(e,this.state.ad.adblockDetected))}return this.initHlsEncoderPromise=this.initHlsEncoder(),await this.initHlsEncoderPromise,this.initHlsEncoderPromise=void 0,this.subscribeContentImpression(),this.startLevelForcingWithSizeCap(),this.attachMedia()}async destroyUnsafe(){await super.destroyUnsafe(),this.preloadSourceHLSEncoder&&this.preloadSourceHLSEncoder.destroy(),this.HLSEncoder&&this.HLSEncoder.destroy()}canSeek(){return void 0!==this.HLSEncoder&&Boolean(this.HLSEncoder.media)&&super.canSeek()}async detachEncoder(){if(K(this.video.textTracks).forEach(mo),this.stopLevelForcingWithSizeCap(),await super.detachEncoder(),this.loadStarted=!1,this.preloadSourceHLSEncoder&&(this.preloadSourceHLSEncoder.destroy(),this.clearPreloadSourceHlsEncoder()),!this.HLSEncoder){if(!this.initHlsEncoderPromise)return;await this.initHlsEncoderPromise}const{video:e,HLSEncoder:t}=this;if(void 0!==t)return this.recoverOnBufferingReason=null,new Promise(i=>{t.media?t.once(Hls.Events.MEDIA_DETACHED,()=>{this.HLSEncoderAttachTime=1/0,i()}):i(),this.lastKnownLevelDetails=void 0,vo(e,()=>{t.destroy(),this.HLSEncoder=void 0})})}getConnectionQuality(){if(void 0===this.lastFragRequest)return super.getConnectionQuality();const{fragDuration:e,getElapsedTime:t}=this.lastFragRequest,i={fragDuration:e,downloadTime:t()};return Rp(i)?Sp.SLOW:super.getConnectionQuality()}getMaxCapAllowedVideoTrack(){const{HLSEncoder:e}=this;if(!e||!e.levels||!e.autoLevelEnabled)return;const t=e.levels[e.autoLevelCapping];return t?this.state.controller.videoTracks.find(e=>{let{value:i}=e;return i===t.url[0]}):void 0}onVideoTagError(e){if(super.onVideoTagError(e),!this.video.error||ei(this.state))return;const t=xn(this.video);if(t.code!==qg.MEDIA_ERR_DECODE&&t.code!==qg.MEDIA_ERR_SRC_NOT_SUPPORTED)return;const i=t.code===qg.MEDIA_ERR_SRC_NOT_SUPPORTED,r=new jc({code:qg[t.code],details:t,isFatal:i});if(this.props.onError(r),i)return;const n="VideoTagError MEDIA_ERR_DECODE";pp.log(n),this.props.onExpectedStalledChange(ut(Fh.MediaError,void 0)),this.isPaused()&&this.recoverHelper.planTask(()=>this.recoverCurrentFrag(),{reason:n,delay:1e3})}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e===Bh.VOD||void 0===e)return super.calculateDVRParams();const{fragmentDuration:t,startTime:i,totalDuration:r}=this.getFragmentsData(),{liveOffset:n}=this.props,o=ql(t,1),a=e===Bh.EVENT?n:Kl(o,n);return{fragmentDuration:t,dvrStartTime:i,dvrDuration:r,skinDVRStartTime:e===Bh.EVENT?i:Kl(o,i),skinDVRDuration:zl(r,a)}}onTick(e){super.onTick(e),this.updateSkinDvrParameters(e)}getStreamUrl(){const e=super.getStreamUrl(),t={session_data:"1"};return Fn(e)||(t.preview="1"),Tt(e,t,{saveOriginalPath:!0})}getBandwidthEstimate(){if(!this.HLSEncoder)return super.getBandwidthEstimate();const e=i(()=>this.HLSEncoder.abrController._bwEstimator.getEstimate());return B(e)?{value:e,source:"hlsjs"}:super.getBandwidthEstimate()}getUtcEndTime(){const e=this.getUtcStartTime();return e?Kl(e,this.getDuration()):jl(0)}stopLoad(){this.HLSEncoder&&(this.HLSEncoder.stopLoad(),this.loadStarted=!1)}tryRecoverOnBuffering(){if(!this.recoverOnBufferingReason)return;const{type:e,url:t,details:i,frag:r}=this.recoverOnBufferingReason,{controller:{bufferingRanges:n,fragmentDuration:o}}=this.state,a=this.getCurrentTime();if(n.some(e=>{let{start:t,end:i}=e;return t+o<a&&i-o>a}))return void pp.log("skip recover",{currentTime:a,bufferingRanges:n});const{recoverHelper:s}=this;s.planTask(()=>this.recoverCurrentFrag(),{reason:"HlsJs "+e,rawData:{details:i,type:e,url:t,isFatal:!0,frag:Hn(r)},delay:100})}getHlsJsConfig(){const e="true"!==pf.getItem(cv.WAS_WORKER_INTERNAL_ERROR);return{manifestLoadingTimeOut:tg,levelLoadingTimeOut:ig,fragLoadingTimeOut:rg,fragLoadingMaxRetry:5,debug:this.props.debug,enableWorker:e,autoStartLoad:!1,capLevelToPlayerSize:!1,liveSyncDuration:this.props.liveOffset,levelLoadingMaxRetry:25,levelLoadingMaxRetryTimeout:100,enableCEA708Captions:!1,xhrSetup:(e,t)=>{this.withCredentials&&(e.withCredentials=!0);const i=Pt(t);("m3u8"===i||"ts"===i)&&e.open("GET",Cr(t),!0)},fetchSetup:(e,t)=>(this.withCredentials&&(t.credentials="include"),new Request(e.url,t)),maxMaxBufferLength:this.getMaxBufferLength()}}preparePreloadSourceHlsEncoderToAttach(){const e=this.preloadSourceHLSEncoder;if(!e)return;this.HLSEncoder=e;const{preloadPosition:t}=this;if(this.unsubscribePreloadSourceHandlers(),this.clearPreloadSourceHlsEncoder(),e.config.liveSyncDuration=this.props.liveOffset,!e.levels||0===e.levels.length)return e;this.onLevelsUpdated(),this.onLevelUpdated(),this.updateThumbnailTileMeta(),this.onAudioTracksUpdated(),this.onAudioTrackUpdated(e.audioTrack),this.onSubtitleTracksUpdated();const{videoTime:i,utc:r}=this.state.controller.startPosition;if(!(t.utc!==r||t.videoTime!==i))return e;const n=this.getStartLoadPosition(this.getHlsEncoderLevelDetails());return void 0!==n&&e.streamController.startLoad(n),e}async initHlsEncoder(){if(this.HLSEncoder)return;if(this.HLSEncoder=this.preparePreloadSourceHlsEncoderToAttach(),this.HLSEncoder)this.props.logEvent({event:Cp.UsePreloadedHlsJs,params:{}});else{try{await hn()}catch(i){if(i instanceof Error){const e=new jc(i,{code:Cs.SCRIPT_INIT_ERROR});throw this.props.onError(e),e}throw i}this.HLSEncoder=new Hls(this.getHlsJsConfig())}const{HLSEncoder:e}=this;window.hls=e,this.subscribeHlsEncoderEvents(e),this.restoreUserTracksWhenPossible();const t=i=>{i!==$l.BUFFERING&&i!==$l.PLAY||(e.config.maxMaxBufferLength=this.getMaxBufferLength(),this.off("VideoPlayingStateChange",t))};this.on("VideoPlayingStateChange",t)}subscribeHlsEncoderEvents(e){e.subtitleDisplay=this.state.skin.useNativeSubtitles;const t=t=>{if(!e.levels)return;const i=e.levels[t];if(!i)return;const r=ho(i,this.videoTrackLabels);r&&this.emit("InternalVideoTrackValueChange",r.value)};e.on(Hls.Events.LEVEL_SWITCHING,(e,i)=>{t(i.level)}),e.on(Hls.Events.LEVEL_SWITCHED,(e,i)=>{t(i.level)}),e.on(Hls.Events.STREAM_STATE_TRANSITION,(e,t)=>{let{nextState:i}=t;"FRAG_LOADING"!==i&&(this.lastFragRequest=void 0)}),e.on(Hls.Events.FRAG_LOADING,(e,t)=>{let{frag:{duration:i}}=t;this.lastFragRequest={fragDuration:Gl(1e3*i),getElapsedTime:H()}}),e.levels&&0!==e.levels.length||e.on(Hls.Events.MANIFEST_PARSED,(i,r)=>{let{levels:n=[],audioTracks:o=[]}=r;this.onLevelsUpdated(),this.updateThumbnailTileMeta();const a=this.getStartVideoLevelIndex(n);e.startLevel=a,this.state.controller.isAbrEnabled||(e.loadLevel=a);this.getStartAudioTrackIndex(o)>-1&&(e.audioTrack=this.getStartAudioTrackIndex(o)),e.once(Hls.Events.LEVEL_LOADED,(e,i)=>{let{level:r}=i;t(r)})}),e.on(Hls.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated),e.on(Hls.Events.AUDIO_TRACK_SWITCHING,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.AUDIO_TRACK_SWITCHED,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated),e.on(Hls.Events.SUBTITLE_TRACK_SWITCH,(t,i)=>{const{subtitleTrack:r}=e;if(r>-1){const t=ao(e.subtitleTracks.find(e=>e.id===i.id));if(!t)return;this.emit("InternalTextTrackValueChange",t.value)}else this.emit("InternalTextTrackValueChange",void 0)}),e.on(Hls.Events.FRAG_PARSING_METADATA,async(e,t)=>{const{samples:i,frag:r}=t;if(!i||0===i.length)return;const n=i.map(e=>{let{data:t}=e;return(0,Qg.parseV2Tag)(t)}).filter(e=>!1!==e&&void 0!==e.writer).map(e=>e.writer).filter(e=>void 0!==e),{data:o,index:a,reason:s}=function(e){const[t,i]=e.reduce((e,t)=>{let[i,r]=e;try{return!function(e){return"object"===typeof e&&e.id&&"number"===typeof e.offset&&(void 0===e.cutoff||"number"===typeof e.cutoff)}(JSON.parse(t))?r.push(t):i.push(t),[i,r]}catch(n){return[i,r]}},[[],[]]);if(t.length>0){const i=t[t.length-1];return{data:i,index:e.indexOf(i),reason:uv.HasAd}}if(i.length>0){const t=i[i.length-1];return{data:t,index:e.indexOf(t),reason:uv.NoAd}}return{data:"",index:-1,reason:uv.NoData}}(n);pp.log("choose metadata: ",o,a,s);Math.random()<.01&&this.props.logEvent({event:Cp.StreamPlayerChooseMetadata,params:{fragmentMetadataArray:o,chosenIndex:a,chosenReason:s}}),this.emit("MetadataChange",{fragmentMetadataArray:[o],fragmentStart:jl(r.start),fragmentDuration:jl(r.duration),src:r?r.url:this.getStreamUrl()})}),e.on(Hls.Events.MANIFEST_LOADED,()=>{this.onLevelsUpdated(),this.forceLevel(),this.onAudioTracksUpdated(),this.onSubtitleTracksUpdated()}),e.on(Hls.Events.LEVEL_UPDATED,this.onLevelUpdated),e.on(Hls.Events.ERROR,(e,t)=>{t&&this.onEncoderError(t)}),e.on(Hls.Events.FRAG_PARSED,(e,t)=>this.handleFragParsed(e,t)),this.on("VideoPlayingStateChange",e=>{"play"!==e&&"buffering"!==e||this.startLoadOnce()})}getStartVideoLevelIndex(e){const{userVideoTrackHeight:t,userVideoTrackName:i}=this.playerStore.getState().controller,r=go(e,{name:i,height:t});if(r){const t=e.indexOf(r);return pp.log("User level found, start loading by index=["+t+"]"),t}return function(e){let{video:t,maxHeightCapping:i,levels:r=[],bandwidth:n}=e;const o=r.slice().filter(Boolean).sort((e,t)=>t.bitrate-e.bitrate);if(0===o.length)return-1;const{width:a,height:s}=yo(t),[l]=o.filter(e=>!(n&&e.bitrate>n)&&(!(i&&e.height>i)&&(e.width<=a||e.height<=s)));return void 0===l?r.indexOf(o.pop()):r.indexOf(l)}({levels:e,maxHeightCapping:this.maxHeightCapping,video:this.video,bandwidth:this.state.controller.isAbrEnabled?this.getBandwidthEstimate().value:1/0})}getStartAudioTrackIndex(e){const{userAudioTrackName:t,userAudioTrackLang:i}=this.playerStore.getState().controller,r=fo(e,{name:t,lang:i});if(!r)return-1;const n=e.indexOf(r);return pp.log("User audio track found, start loading by index=["+n+"]"),n}handleFragParsed(e,t){let{frag:i}=t;const{duration:r}=i;if(0===r&&this.state.controller.videoType===Bh.VOD){const e=this.getHlsEncoderLevelDetails(),t=e?e.fragments:[];if(t[t.length-1]===i)return}(r<=0||r>=2*this.fragDuration)&&this.props.logEvent({event:"InvalidFragDuration",params:Hn(i)})}startLoadOnce(e){const{HLSEncoder:t}=this;!this.loadStarted&&void 0!==t&&this.state.controller.isOnline&&(t.levels&&t.levels.length>0?(t.startLoad(e),this.loadStarted=!0):t.once(Hls.Events.MANIFEST_PARSED,()=>{this.startLoadOnce(e)}))}getHlsEncoderLevelDetails(){const{HLSEncoder:e}=this;if(void 0===e)return;const{currentLevel:t,levels:i}=e;if(!i)return;const r=i[t];if(r&&r.details)return this.lastKnownLevelDetails=r.details,this.lastKnownLevelDetails;const n=i.find(e=>{let{details:t}=e;return Boolean(t)});if(n){const{details:e}=n;this.lastKnownLevelDetails=e}return this.lastKnownLevelDetails}computeRecoverJumpGap(){const{controller:{bufferingRanges:e}}=this.state,t=this.getCurrentTime();return Math.max(...e.map(e=>{let{end:t}=e;return t}))+1.1*this.fragDuration<t?(pp.log("use 0 as recoverJumpGap",{currentTime:t,bufferingRanges:e}),jl(0)):ql(this.fragDuration,1.1)}computeRecoverPositionFromStartPosition(){const{startPosition:e}=this.state.controller,t={},i=this.computeRecoverJumpGap();return void 0!==e.utc&&e.utc>0&&(t.utc=Kl(e.utc,i)),t.videoTime=Kl(e.videoTime||jl(0),i),t}computeRecoverPositionFromCurrentTime(){const e={},{lastRecoverPosition:t}=this.state.controller,i=this.getCurrentTime(),r=this.getUtcPosition(),n=this.computeRecoverJumpGap(),{utc:o=0,videoTime:a=0}=t||{};return(r>0||o>0)&&(e.utc=Kl(jl(Math.max(r,o)),n)),e.videoTime=Kl(jl(Math.max(i,a)),n),e}async recoverCurrentFrag(){const{lastRecoverPosition:e}=this.state.controller,t=this.getDuration()>0||void 0!==e?this.computeRecoverPositionFromCurrentTime():this.computeRecoverPositionFromStartPosition();this.playerStore.dispatch(eh(t)),this.playerStore.dispatch(ju(t)),await this.detachEncoder(),await this.attachEncoder()}attachMedia(){pp.log("attachMedia");const{video:e,HLSEncoder:t}=this;if(void 0===t){const e=new jc({code:Cs.NO_HLS_JS_INSTANCE,isFatal:!1});return this.props.onError(e),Promise.reject(e)}const i=new Promise(e=>{t.once(Hls.Events.MEDIA_ATTACHED,()=>{window.performance&&n(performance.now)&&(this.HLSEncoderAttachTime=performance.now()),t.url||t.loadSource(this.getStreamUrl()),e()})});t.once(Hls.Events.MANIFEST_PARSED,()=>{if(this.loadStarted)return;const e=this.getStartLoadPosition();t.startLoad(e),this.loadStarted=!0,t.once(Hls.Events.LEVEL_UPDATED,(i,r)=>{let{details:n}=r;const o=this.getStartLoadPosition(n);o!==e&&void 0!==o&&t.streamController.startLoad(o)})});const r=t.levels&&t.levels.length>0?Promise.resolve():new Promise(e=>{t.once(Hls.Events.MANIFEST_PARSED,()=>{e()})});return vo(this.video,()=>{t.attachMedia(e)}),Promise.all([i,r]).then(()=>{})}onAudioTrackUpdated(e){const{HLSEncoder:t}=this;if(!t)return;const i=oo(t.audioTracks.find(t=>t.id===e));i&&this.emit("InternalAudioTrackValueChange",i.value)}getVideoType(){const e=this.getHlsEncoderLevelDetails();if(e)return Eo(e);return(this.HLSEncoder&&this.HLSEncoder.levels||[]).some(e=>{let{details:t}=e;return Boolean(t&&t.live)})||this.getDuration()===1/0?Bh.LIVE:Bh.VOD}onLevelsUpdated(){const{sessionData:e={},levels:t=[]}=this.HLSEncoder||{};this.videoTrackLabels=function(e){const{VALUE:t=""}=e["com.yandex.video.labels.quality"]||{};return t.split(",").filter(Boolean).reduce((e,t)=>{const[i,r]=t.split(":");return void 0!==So(i)&&r&&e.set(i,r),e},new Map)}(e),this.maxHeightCapping=function(e){const{VALUE:t=""}=e["com.yandex.video.capping.maxheight"]||{},i=parseInt(t,10);return i>0?i:void 0}(e),this.emit("VideoTracksChange",po(t,this.videoTrackLabels))}updateThumbnailTileMeta(){const{sessionData:e={}}=this.HLSEncoder||{},t=e=>{this.props.logEvent({event:e,params:void 0})},i=no(e,ov.LOWRES,t),r=no(e,ov.HIGHRES,t);if(void 0===r)return;const n=i?ro(i,t):void 0,o=ro(r,t),a=function(e){const{VALUE:t=""}=e["com.yandex.video.thumbnail.version"]||{};return parseFloat(t)||0}(e);this.props.onThumbnailTileGeneralMetaInfoChange({version:a,lowRes:n,highRes:o})}onEncoderError(e){const{details:t,type:i,url:r,frag:n}=e;if(!t)return;if((o=e).networkDetails&&423===o.networkDetails.status&&o.details===Hls.ErrorDetails.LEVEL_LOAD_ERROR){this.props.logEvent({event:Cp.HlsJsForceCappingStart,params:{}});const{recoverHelper:n}=this;return void n.planTask(()=>this.recoverCurrentFrag(),{force:$n(e),reason:"HlsJs "+i,rawData:{details:t,type:i,url:r,isFatal:!1},delay:0})}var o;const a=Xn(e),s=Jn(e);if(void 0!==s&&(a||i===Hls.ErrorTypes.MEDIA_ERROR))if(this.recoverHelper.allowed&&!s.isFatal){if(this.props.onError(s),Zn(e)){if(this.currentState!==$l.BUFFERING&&function(e){const{details:t}=e;return!!t&&iv.includes(t)}(e))return void(this.recoverOnBufferingReason=e);let o;e.details===Hls.ErrorDetails.INTERNAL_EXCEPTION&&"demuxerWorker"===e.event?(pf.setItem(cv.WAS_WORKER_INTERNAL_ERROR,"true"),o=()=>this.recoverStream()):o=()=>this.recoverCurrentFrag(),this.recoverHelper.planTask(o,{force:$n(e),reason:"HlsJs "+i,rawData:{details:t,type:i,url:r,isFatal:a,frag:Hn(n)},delay:1e3})}}else this.props.onError(new jc(s,{isFatal:!0}))}getHlsTextTrack(e){if(this.HLSEncoder)return this.HLSEncoder.subtitleTracks.find(t=>e.value===String(t.id))}unsubscribePreloadSourceHandlers(){const{preloadSourceHLSEncoder:e}=this;e&&(this.preloadSourceHandlers.forEach(t=>{let[i,r]=t;e.off(i,r)}),this.preloadSourceHandlers.length=0)}clearPreloadSourceHlsEncoder(){this.preloadSourceHLSEncoder=void 0,this.preloadPosition={}}getStartLoadPosition(e){const{startPosition:t}=this.state.controller,{liveOffset:i}=this.props;return function(e){let{details:t,startPosition:i,liveOffset:r}=e,{videoTime:n}=i;if(void 0===t)return n;if(t.hasProgramDateTime&&Ao(i.utc)){const e=Xl(Gl(t.fragments[0].programDateTime),1e3);n=zl(i.utc,e)}if(!Ao(n))return;const o=Eo(t)===Bh.VOD?0:r,[a]=t.fragments,s=void 0===a?0:a.start,d=t.totalduration-o;return jl(l(n,s,d))}({details:e,startPosition:t,liveOffset:i})}startLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval),this.levelForcingInterval=window.setInterval(()=>{this.forceLevel()},1e3)}stopLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval)}forceLevel(){if(!this.HLSEncoder||!this.HLSEncoder.autoLevelEnabled||!this.HLSEncoder.levels||!this.HLSEncoder.levels.length)return;const{width:e,height:t,maxWidth:i,maxHeight:r}=this.getCapSizes(),n=Math.min(e,i||Mv),o=Math.min(t,r||Mv),a=Yl(Math.min(...[this.maxHeightCapping,o].filter(B))),{levels:s}=this.HLSEncoder,l=s.reduce((e,t,i)=>{if((t.height<e.smallestLevel.height||t.width<e.smallestLevel.width)&&(e.smallestLevel=t,e.smallestLevelIndex=i),t.height>a||t.width>n)return e;const r=(s[e.index]||{}).height||0;return t.height>r?No({},e,{index:i}):e},{index:-1,smallestLevel:s[0],smallestLevelIndex:0});this.HLSEncoder.autoLevelCapping=-1===l.index?l.smallestLevelIndex:l.index}}class xv{static fromXHR(e){return new xv(e)}constructor(e){this.status=void 0,this.status=e.status}isFatalError(){return this.isRegionLimitationError()||this.isSignatureExpiredError()}toPlayerError(){return new jc({code:this.getErrorCode(),isFatal:this.isFatalError(),details:JSON.parse(Xt(this))})}isRegionLimitationError(){return 451===this.status}isSignatureExpiredError(){return $g.includes(this.status)}getErrorCode(){return this.isRegionLimitationError()?Cs.REGIONAL_LIMITATION_MANIFEST:this.isSignatureExpiredError()?Cs.SIGNATURE_EXPIRED_MANIFEST:Cs.DEFAULT_ERROR}}const Fv=e=>d(e)&&g(Cs,e),Uv=(e,t)=>{const i=e<t?e:t;return i<=144?144:i<=240?240:i<=360?360:i<=480?480:i<=576?576:i<=720?720:i<=1080?1080:i<=1440?1440:2160},Bv=e=>e.map((e,t)=>Go({},e,{name:Uv(e.height,e.width)+"p",value:t.toString(),bitrate:jp})),Hv=Gl(3e3);class Gv extends Lv{initInternalSubscribe(){super.initInternalSubscribe(),this.subscribeVideoBuffering();const e=U(()=>{var e;const t=Bv((null==(e=this.state.controller.sourceParams)?void 0:e.resolutions)||[]);this.emit("VideoTracksChange",t),this.emit("AudioTracksChange",Bo(this.video.audioTracks)),this.emit("TextTracksChange",Ho(this.video.textTracks)),this.actualizeActiveVideoTrack(),this.setFirstAudioTrack()});this.initTextTracks(),this.once("CanPlay",e),this.once("Destroy",()=>{this.off("CanPlay",e)}),this.video.audioTracks&&(this.addEventListener(this.video.audioTracks,"addtrack",()=>{this.emit("AudioTracksChange",Bo(this.video.audioTracks)),this.actualizeNativeAudioTrack(),this.restoreUserAudioTrack()}),this.addEventListener(this.video.audioTracks,"removetrack",()=>{this.emit("AudioTracksChange",Bo(this.video.audioTracks)),this.actualizeNativeAudioTrack()}),this.addEventListener(this.video.audioTracks,"change",e=>{this.actualizeNativeAudioTrack(),this.saveUserAudioTrack(e)})),this.video.textTracks&&this.addEventListener(this.video.textTracks,"addtrack",()=>{this.emit("TextTracksChange",Ho(this.video.textTracks))}),this.addVideoEventListener("progress",()=>{const{videoType:e}=this.state.controller;e!==Bh.LIVE&&e!==Bh.EVENT||this.emit("DvrChange")}),this.subscribeCueChange()}initCurrentVideoTrack(){const{isAbrEnabled:e,userVideoTrackHeight:t,sourceParams:i}=this.state.controller;if(e||!t)return;const r=Bv((null==i?void 0:i.resolutions)||[]),n=this.getNearestVideoTrack(t,r);n&&(this.currentVideoTrack=n,this.playerStore.dispatch(oh({name:n.name,height:n.height?Yl(n.height):void 0})))}constructor(e){super(e),this.props=e,this.serverTimeEstimator=void 0,this.estimatorPollingInterval=void 0,this.isRecoverablePlaylistHTTPStatus=!0,this.checkPlaylistHTTPStatusPromise=void 0,this.currentVideoTrack=Wp,this.applyStartPosition=()=>{if(!this.canSeek())return;const e=this.getCurrentTime(),t=this.getStartPosition();B(t)&&e!==t&&this.seekInternal(t)},this.saveUserAudioTrack=e=>{if(!e.isTrusted)return;const t=xo(this.video);t&&this.playerStore.dispatch(lh({name:t.name||void 0,lang:t.lang||void 0}))},this.actualizeNativeAudioTrack=()=>{const e=xo(this.video);this.emit("InternalAudioTrackValueChange",e&&e.value)},this.notifyTextTracksChanged=()=>{const e=function(e,t){const{textTracks:i=[]}=e;for(let r=0;r<i.length;r++){const e=i[r];if(e&&Fo(e)&&e.mode===t)return Uo(e,r)}}(this.video,this.getVisibleTextTrackMode());this.emit("InternalTextTrackValueChange",e&&e.value)},this.playerStore.dispatch(th(!0)),this.serverTimeEstimator=new Hg,this.initCurrentVideoTrack(),this.estimateLatency(),this.on("VideoTypeChange",e=>{this.startLatencyPolling(e)}),this.on("Detach",()=>this.stopLatencyPolling()),this.once("Destroy",()=>this.stopLatencyPolling())}onVideoResize(){super.onVideoResize(),this.actualizeActiveVideoTrack()}getNearestVideoTrack(e,t){const i=t||this.state.controller.videoTracks;if(!i.length)return;return i.reduce((t,i)=>i.height?t.height?Math.abs(e-i.height)<Math.abs(e-t.height)?i:t:i:t,i[0])}actualizeActiveVideoTrack(){const{videoHeight:e}=this.video,t=this.getNearestVideoTrack(e);t&&(this.currentVideoTrack=t,this.emit("InternalVideoTrackValueChange",t.value))}getServerTime(){const e=this.serverTimeEstimator.getServerTime();return e?jl(e):void 0}setAudioTrack(e){if(""===e.value)return;const t=K(this.props.video.audioTracks),i=t.find(t=>t.id===e.value);i&&t.forEach(e=>{e.enabled=e.id===i.id})}setTextTrack(e){""!==e.value&&this.renderTextTrack(e.value)}disableTextTrack(){this.renderTextTrack(void 0)}renderTextTrack(e){Io(this.video.textTracks).forEach((t,i)=>{t&&(Uo(t,i).value===e?t.mode=this.getVisibleTextTrackMode():t.mode=this.getHiddenTextTrackMode())})}seekInternal(e){wn(this.video,jl(l(e,0,this.getDuration()||0)))}getSeekableRange(){const{seekable:e}=this.video;return{start:jl(e.start(0)),end:jl(e.end(e.length-1))}}getFragmentsData(){if(!this.isDvrEnabled()||!this.video||!this.video.seekable.length)return super.getFragmentsData();const{start:e,end:t}=this.getSeekableRange();return{totalDuration:zl(t,e),fragmentDuration:Lh,startTime:e}}shouldSkipVideoTagError(e){return e.code!==qg.MEDIA_ERR_DECODE&&e.code!==qg.MEDIA_ERR_ENCRYPTED&&e.code!==qg.MEDIA_ERR_SRC_NOT_SUPPORTED||ei(this.state)}async onVideoTagError(){const e=xn(this.video);if(this.shouldSkipVideoTagError(e))return;this.video.poster=ld,this.checkPlaylistHTTPStatus();const t=!this.recoverHelper.allowed||!this.isRecoverablePlaylistHTTPStatus,i=new jc({code:Mo(e),details:e,isFatal:t});if(!t)return this.props.onError(i),void this.recoverHelper.planTask(()=>this.recoverStream(),{delay:500,reason:"VideoTagError ["+e.code+"]["+e.message+"]"});const r=await this.checkPlaylistHTTPStatusPromise;r&&r.isFatalError()?this.props.onError(r.toPlayerError()):this.props.onError(i)}onTick(e){super.onTick(e),this.isDvrEnabled()&&this.updateSkinDvrParameters(e)}async attachEncoder(){await super.attachEncoder();const e=e=>(this.props.onError(e),Promise.reject(s(e.code,this.state.ad.adblockDetected))),t=this.getStreamUrl().toLowerCase();if(!("mp4"===Pt(Rt(t))||cf(t))&&!Bf.canPlayHlsOnNative())return e(new jc({code:Cs.NATIVE_HLS_NOT_SUPPORTED_ERROR}));const{video:i}=this;this.subscribeContentImpression();try{await this.initDrm(this.props.stream.drmConfig)}catch(n){if(n instanceof jc)return e(n)}const r=B(this.getStartPosition())?this.waitForStartPositionEstablished():void 0;this.initVideoTypeQualifier(),vo(i,()=>{i.src=this.getStreamUrl()}),void 0!==r&&await r,this.startLatencyPolling(this.state.controller.videoType)}getStreamUrl(){const e=this.getStartPosition();return Lo(super.getStreamUrl(),e)}onOnline(){}onOffline(){}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if(!B(e)&&!B(t))return;const i=this.getUtcStartTime();return i>0&&B(t)&&t>0?t-i:B(e)?e:void 0}checkPlaylistHTTPStatus(){this.checkPlaylistHTTPStatusPromise||(this.checkPlaylistHTTPStatusPromise=this.loadPlaylistInfo().then(xv.fromXHR).then(e=>(this.isRecoverablePlaylistHTTPStatus=!e.isFatalError(),e)).catch(()=>{}))}estimateLatency(){const e=Tl();ie({url:this.getStreamUrl(),method:"HEAD",timeout:5e3}).then(t=>{this.serverTimeEstimator.parseServerTime({"x-server-time-ms":t.getResponseHeader("x-server-time-ms"),date:t.getResponseHeader("date")},Tl()-e)},()=>{})}startLatencyPolling(e){this.estimatorPollingInterval||e!==Bh.EVENT&&e!==Bh.LIVE||(this.estimatorPollingInterval=window.setInterval(()=>this.estimateLatency(),1e4))}stopLatencyPolling(){clearInterval(this.estimatorPollingInterval),this.estimatorPollingInterval=void 0}initTextTracks(){let e=!1,t=!1;const{textTracks:i}=this.video;if(!i)return;const r=U(()=>{this.castTextTracksModeOnInit(),this.addEventListener(i,"change",this.notifyTextTracksChanged),this.notifyTextTracksChanged()}),n=()=>{e&&t&&r()};this.addEventListener(this.video,"loadedmetadata",()=>{e=!0,n()}),this.addEventListener(i,"addtrack",function(e,t,i,r){function n(){null!==o&&clearTimeout(o),o=null}3===arguments.length&&"boolean"!==typeof i&&(r=i,i=!1);let o=null;const a=function(){const a=arguments;r=r||this,i&&null===o&&e.apply(r,a),n(),o=window.setTimeout((function(){i||e.apply(r,a),o=null}),t)};return a.cancel=n,a}(()=>{t=!0,n()},0))}setFirstAudioTrack(){this.restoreUserAudioTrack();const e=xo(this.video);e&&this.emit("InternalAudioTrackValueChange",e.value)}loadPlaylistInfo(){return ie({method:"HEAD",url:this.getStreamUrl(),timeout:Hv,checkStatus:()=>!0})}subscribeCueChange(){const{textTracks:e}=this.video;if(!e||"function"!==typeof e.addEventListener)return;const t=e=>{const t=e.track;t&&"metadata"===t.kind&&(t.mode="hidden",this.addEventListener(t,"cuechange",e=>{const{activeCues:t}=e.target,{length:i}=t;if(!i)return;const r=t[i-1];if(!r)return;const{value:n,startTime:o,endTime:a}=r;if(!n)return;const s="number"===typeof a&&isFinite(a)?zl(a,o):Lh,l=K(t).map(e=>{if(e&&e.value){const{data:t}=e.value;if("string"===typeof t)return t}return""});this.emit("MetadataChange",{fragmentMetadataArray:l,fragmentStart:o,fragmentDuration:s,src:this.video.src})}))};e.addEventListener("addtrack",t),this.on("Destroy",()=>e.removeEventListener("addtrack",t))}castTextTracksModeOnInit(){if(this.state.skin.useNativeSubtitles)return;void 0!==Io(this.video.textTracks).find(e=>Boolean(e&&"disabled"===e.mode))||Io(this.video.textTracks).forEach(e=>{e&&(e.mode="showing"===e.mode?this.getVisibleTextTrackMode():this.getHiddenTextTrackMode())})}}class jv extends Gv{constructor(e){super(e),this.props=e,this.engine=Qp.MP4;const t=U(()=>{this.emit("VideoTracksChange",function(e){const{videoWidth:t,videoHeight:i}=e;return[{name:co({width:Yl(t),height:Yl(i)}),value:"0",bitrate:jp,width:t,height:i}]}(e.video))});this.once("CanPlay",t),this.once("Destroy",()=>this.off("CanPlay",t))}async attachEncoder(){await super.attachEncoder(),pp.log("mp4 native mode")}waitForStartPositionEstablished(){return new Promise((e,t)=>{const i=this.addVideoEventListener("durationchange",()=>{this.canSeek()&&(this.applyStartPosition(),i(),e())});this.once("Detach",()=>{i(),t()})})}initVideoTypeQualifier(){this.emit("VideoTypeChange",Bh.VOD)}initDrm(){return Promise.resolve()}setVideoTrack(){}}const Wv=jl(5*Math.random());let Yv=function(e){return e.EXPIRED_SIGNATURE="EXPIRED_SIGNATURE",e}({});const Kv={error:"",isFatal:!1};class zv{static convertToTextTrackCue(e){return shaka&&VTTCue?e.startTime>=e.endTime?null:new VTTCue(e.startTime,e.endTime,e.payload):null}static removeWhere(e,t){const i=e.mode;e.mode="hidden";const r=e.cues||[];for(let n=r.length-1;n>=0;n--){const i=r[n];i&&t(i)&&e.removeCue(i)}e.mode=i}constructor(e,t){this.useNativeSubtitles=t,this.textTrack=void 0,K(e.textTracks).forEach(e=>{e.mode="disabled","StreamPlayerJs TextTrack"===e.label&&(this.textTrack=e)}),this.textTrack||(this.textTrack=e.addTextTrack("subtitles","StreamPlayerJs TextTrack")),this.textTrack.mode=this.hiddenMode()}remove(e,t){if(!this.textTrack||!shaka)return!1;return zv.removeWhere(this.textTrack,i=>i.startTime<t&&i.endTime>e),!0}append(e){if(!shaka||!this.isTextVisible()||!this.textTrack)return;const t=e.map(e=>{if(e.nestedCues.length){const t=e.nestedCues.map(e=>e.spacer?"\n":e.payload+" ").join("").replace(/ $/m,""),i=e.clone();return i.nestedCues=[],i.payload=t,i}return e}),i=[],r=this.textTrack.cues?Array.from(this.textTrack.cues):[];for(const n of t){if(!r.some(e=>e.startTime===n.startTime&&e.endTime===n.endTime&&e.text===n.payload)){const e=zv.convertToTextTrackCue(n);e&&i.push(e)}}i.slice().sort((e,t)=>e.startTime!==t.startTime?e.startTime-t.startTime:e.endTime!==t.endTime?e.endTime-t.startTime:i.indexOf(t)-i.indexOf(e)).forEach(e=>{this.textTrack.addCue(e)})}destroy(){if(this.textTrack){const e=e=>!0;zv.removeWhere(this.textTrack,e)}return this.textTrack=void 0,Promise.resolve()}isTextVisible(){return!!this.textTrack&&this.textTrack.mode!==this.hiddenMode()}setTextVisibility(e){this.textTrack&&(this.textTrack.mode=e?this.showingMode():this.hiddenMode())}hiddenMode(){return"disabled"}showingMode(){return Co(this.useNativeSubtitles())}}let qv=!1;const Xv={version:'Period>SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:version"]',uriTemplate:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:uri"]',tiles:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:tiles"]',spriteDuration:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:duration"]',resolution:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:resolution"]'},Qv={version:Xv.version,uriTemplate:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:uri"]',tiles:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:tiles"]',spriteDuration:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:duration"]',resolution:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:resolution"]'},Jv=document.createElement("canvas"),Zv=Jv.getContext("2d"),$v=Gl(3e4);class em extends Ev{constructor(){super(),this.blacklist=new Set,this.destroyed=!1,this.checkLoopTimeoutId=void 0,this.startLoop(),this.once("Destroy",()=>{this.destroyed=!0})}destroy(){this.stopLoop(),super.destroy()}getBlacklist(){return Array.from(this.blacklist)}addHostname(e){ep.includes(e)||this.blacklist.has(e)||this.blacklist.add(e)}isBlacklisted(e){return this.blacklist.has(e)}async checkBlacklistedHosts(){await Promise.all([...this.blacklist].map(async e=>{try{await Vt(Ti(e)),this.blacklist.delete(e)}catch(t){}}))}startLoop(){this.destroyed||(this.checkLoopTimeoutId=setTimeout(async()=>{this.stopLoop(),await this.checkBlacklistedHosts(),this.startLoop()},$v))}stopLoop(){clearTimeout(this.checkLoopTimeoutId)}}const tm=Number.EPSILON||Math.pow(2,-52),im=U(()=>{const e=pr("Chrome");if(void 0===e)return!0;const[t]=e;return t>70}),rm=/^(ext-)?strm[^.]+\.strm\.yandex\.net$/;class nm extends Kg{constructor(e,t){super(),this.source=e,this.cacheData=t,this.addDestroyHandler(()=>{var e;null==(e=this.cacheData.segmentCache)||e.clear(),this.cacheData.loadedManifest=void 0,this.cacheData.cachedVariantTrack=void 0})}preload(){return Promise.resolve()}getBandwidthEstimate(){}copyCachedData(){var e;return{segmentCache:null==(e=this.cacheData.segmentCache)?void 0:e.copy(),loadedManifest:this.cacheData.loadedManifest}}getCachedVariantTrack(){return this.hasCachedSegments()?this.cacheData.cachedVariantTrack:void 0}getBufferedInfo(){return this.cacheData.bufferedInfo}getSource(){return this.source}getType(){return zp.Cache}getManifestXml(){return this.cacheData.manifestXml}hasManifest(){return void 0!==this.cacheData.loadedManifest}hasCachedSegments(){var e;return Boolean(null==(e=this.cacheData.segmentCache)?void 0:e.hasCachedData())}}const om=[429,500,502,503,504],am=Gl(1e3),sm=jl(.001);class lm extends Lv{static fuzz(e,t){void 0===t&&(t=.5);return(e<10?2**e*100:6e4)*(1+(2*Math.random()-1)*t)}initInternalSubscribe(){super.initInternalSubscribe(),this.once("Destroy",()=>this.chunkHostnameBlacklist.destroy()),this.once("Destroy",()=>this.stopShakaConfigAutoUpdate()),this.once("Destroy",()=>{var e;return null==(e=this.customNetworkingEngine)?void 0:e.destroy()}),this.once("Destroy",()=>{var e;return null==(e=this.preloader)?void 0:e.destroy()});const e=e=>{Sn(this.shakaPlayer)&&this.shakaPlayer.setTextTrackVisibility(Boolean(e))};this.on("InternalTextTrackValueChange",e),this.once("Destroy",()=>this.off("InternalTextTrackValueChange",e)),this.addEventListener(this.video,"play",this.updateBufferingState),this.on("VideoTypeChange",e=>{if(void 0===e)return;this.shakaPlayer&&this.setShakaAvailabilityWindowOverride(this.shakaPlayer);const t=e===Bh.VOD;this.setNativeTimeControlVisibility(t),this.setNativeTimelineControlVisibility(t)})}constructor(e,r){super(e),this.preloader=r,this.engine=Qp.MPD,this.shakaPlayer=void 0,this.chunkHostnameBlacklist=new em,this.shakaConfigAutoUpdateInterval=void 0,this.manifestXML=void 0,this.initMpdEncoderPromise=void 0,this.detachMpdEncoderCalled=!1,this.useNativeSubtitles=!1,this.customNetworkingEngine=void 0,this.lastTrackBeforeDetach=void 0,this.preloadedTrack=void 0,this.isPauseCalled=!1,this.attempt=0,this.playingStateBeforeLoadShakaSource=void 0,this.abrManager=void 0,this.abrRestrictionsHelper=new Mg({getManifestXml:()=>this.manifestXML,getState:()=>this.state,getCapSizes:()=>this.getCapSizes()}),this.updateBufferGoal=()=>{this.updateShakaConfig()},this.shakaFailureCallback=e=>{const t=lm.fuzz(this.attempt++),{clear:i,promise:r}=Zl(t);this.once("Detach",i),r.then(()=>{var e;null==(e=this.shakaPlayer)||e.retryStreaming(),this.off("Detach",i)})},this.shakaHTTPRequestFilter=(e,t)=>i(()=>this.shakaHTTPRequestFilterInternal(e,t),this.onShakaFilterError),this.shakaHTTPRequestFilterInternal=(e,t)=>{if("undefined"!==typeof shaka)switch(t.allowCrossSiteCredentials=this.withCredentials,e){case shaka.net.NetworkingEngine.RequestType.SEGMENT:Qo(t,this.getRemainingBufferedTime());const{uris:e}=t,i=e.filter(e=>{const{hostname:t}=mt(e);return!this.chunkHostnameBlacklist.isBlacklisted(t)});if(0===i.length)break;t.uris=i}},this.shakaPreviewsHTTPResponseFilter=(e,t)=>i(()=>this.shakaPreviewsHTTPResponseFilterInternal(e,t),this.onShakaFilterError),this.shakaPreviewsHTTPResponseFilterInternal=(e,t)=>{if(void 0===shaka)return;if(e!==shaka.net.NetworkingEngine.RequestType.MANIFEST)return;if(!t.data)return;const i=t.fromCache&&this.manifestXML||Ln(e,t);if(!i)return;this.manifestXML&&this.checkRepresentationChange(this.manifestXML,i),this.manifestXML=i,this.videoTrackLabels=function(e){const t=new Map;return K(e.querySelectorAll('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:labels:quality"]')).forEach(e=>{const i=e.getAttribute("value");if(!i)return;i.split(",").filter(Boolean).forEach(e=>{const[i,r]=e.split(":");void 0!==So(i)&&r&&t.set(i,r)})}),t}(i);const r=qo(i,ov.LOWRES),n=qo(i,ov.HIGHRES),o={version:function(e){const t=e.querySelector('AdaptationSet[mimeType="image/jpeg"] SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:version"]');return t?parseFloat(t.getAttribute("value")||""):0}(i),lowRes:r,highRes:n};o.highRes&&this.props.onThumbnailTileGeneralMetaInfoChange(o)},this.updateBufferingState=()=>{if(ei(this.state))return;const{shakaPlayer:e}=this;if(void 0===e)return;if(function(e){if(!e.isBuffering())return!1;const t=kn(e);if(!(t===Bh.LIVE||t===Bh.EVENT))return!1;const i=e.getMediaElement();if(!i)return!1;const{currentTime:r}=i,n=On(e);if(0===n)return!1;const o=r+n/2,a=Cn(e,jl(r)),s=Cn(e,jl(o));return Boolean(a&&!s)}(e)){const e=ut(Fh.LiveEdge,void 0);this.props.onExpectedStalledChange(e)}const t=this.computeVideoPlayingState(e);this.emit("InternalPlayingStateChange",t)},this.onShakaAdaptationEvent=()=>{this.actualizeAvailableVariantTracks(),this.actualizeActiveVariantTrack()},this.onShakaEmsgEvent=e=>{if(pp.log("-> Shaka EmsgEvent",e),!I(e)||!I(e.detail)||!I(e.detail.messageData))return;const{startTime:t,messageData:i}=e.detail,r=(0,Qg.parseV2Tag)(i);r&&r.writer&&this.emit("MetadataChange",{fragmentMetadataArray:[r.writer],fragmentStart:t,fragmentDuration:On(this.shakaPlayer,t),src:this.getStreamUrl()})},this.reportLargeGap=e=>{pp.log("-> Shaka LargeGapEvent",e),this.props.logEvent({event:"MpdLargeGap",params:{currentTime:e.currentTime,gapSize:e.gapSize}})},this.actualizeTracks=()=>{Sn(this.shakaPlayer)&&(this.actualizeAvailableTracks(),this.actualizeActiveTracks())},this.onShakaErrorEvent=e=>{if(!shaka||!e)return;const{detail:t}=e;this.onShakaError(t);const i=Ko(shaka,t);i&&i.isFatal&&this.destroyShakaPlayer()},this.onShakaError=e=>{if(!shaka)return;pp.error("-> onShakaError",e);const t=function(e,t,i){let{code:r}=t;return r===e.util.Error.Code.VIDEO_ERROR&&i.controller.watchedTime>0}(shaka,e,this.state)&&this.recoverHelper.allowed,i=function(e,t,i){let{code:r,data:n}=t;return r===e.util.Error.Code.BAD_HTTP_STATUS?om.includes(n[1]):n[2]===e.net.NetworkingEngine.RequestType.MANIFEST||r!==e.util.Error.Code.HTTP_ERROR?r===e.util.Error.Code.TIMEOUT:i<=10}(shaka,e,this.attempt);(t||i)&&(e.severity=shaka.util.Error.Severity.RECOVERABLE);const r=Ko(shaka,e);r&&(t&&this.recoverHelper.planTask(()=>this.recoverStream(),{delay:0,reason:r.code}),this.checkDeadChunkServer(e),this.props.onError(r))},this.destroyShakaPlayer=()=>{var e;return((null==(e=this.shakaPlayer)?void 0:e.destroy())||Promise.resolve()).then(()=>{this.shakaPlayer=void 0})},this.onShakaFilterError=e=>{if(shaka){if(pp.error("-> onShakaFilterError",e),zo(e))return this.onShakaError(e);this.props.onError(new jc({code:Cs.SHAKA_FILTER_ERROR,message:e.message,isFatal:!1,stack:e.stack}))}},this.onShakaNetworkSuccess=e=>{if(this.attempt=0,shaka&&e===shaka.net.NetworkingEngine.RequestType.MANIFEST){const{videoType:e}=this.state.controller;e!==Bh.LIVE&&e!==Bh.EVENT||this.emit("DvrChange")}},this.onShakaNetworkError=(e,t)=>{if("undefined"===typeof shaka||void 0===this.shakaPlayer)return;const i=jo(shaka,t);451===i||$g.includes(i)?t.severity=shaka.util.Error.Severity.CRITICAL:this.onShakaError(t)},this.parseTextTrack=e=>{let{label:t,language:i,originalTextId:r}=e;const n=ea(this.manifestXML,r)||i;return{name:t||n||r,value:r,lang:n}},function(e){try{if(!navigator.requestMediaKeySystemAccess)return;const t=ra(e);if(t===window)return;if(!t.navigator.requestMediaKeySystemAccess)return;navigator.requestMediaKeySystemAccess=function(){return t.navigator.requestMediaKeySystemAccess(...arguments)}}catch(t){}}(this.video),t(pn()),r&&r.isDestroyed&&(this.preloader=void 0),this.video.classList.add(Tv().video_hiddenSubtitlesBtn),this.playerStore.dispatch(th(!0)),function(){if(!qv&&(qv=!0,window.MediaKeySession)){const{prototype:e}=window.MediaKeySession,{close:t}=e;e.close=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return Promise.race([t.call(this,i),Zl(200).promise])}}}(),this.useNativeSubtitles=this.state.skin.useNativeSubtitles}getMaxCapAllowedVideoTrack(){var e;const t=null==(e=this.abrManager)?void 0:e.getMaxCapAllowedVideoTrack();if(void 0!==t)return this.state.controller.videoTracks.find(e=>{let{value:i}=e;return i===t.originalId})}getFragmentsData(){const{start:e=jl(0),end:t=jl(0)}=void 0===this.shakaPlayer?{}:this.shakaPlayer.seekRange();return{totalDuration:zl(t,e),fragmentDuration:On(this.shakaPlayer),startTime:e}}onOnline(){}onOffline(){}getUtcStartTime(){const e=Dn(this.shakaPlayer,this.manifestXML);return void 0===e?super.getUtcStartTime():e}getUtcPosition(){const e=function(e,t){if(void 0===e)return;const i=Dn(e,t);if(void 0===i)return;const r=e.getMediaElement();return r?Kl(i,jl(r.currentTime)):void 0}(this.shakaPlayer,this.manifestXML);return void 0===e?super.getUtcPosition():e}setVideoTrack(e){var t;let{value:i}=e;if(void 0===this.shakaPlayer)return;if("auto"===i)return void this.setAbrEnabled(!0);const r=Tn(this.shakaPlayer);if(void 0===r)return;const n=$o(null==(t=this.abrManager)?void 0:t.getVariants(),i,r.originalAudioId),o=this.shakaPlayer.getVariantTracks().find(e=>e.id===n);void 0!==o&&(this.setAbrEnabled(!1),this.setVariantTrack(o))}setAudioTrack(e){let{lang:t,value:i}=e;if(void 0===this.shakaPlayer)return;const r=Tn(this.shakaPlayer);if(void 0===r)return;const n=this.shakaPlayer.getVariantTracks().find(e=>{const t=e.originalAudioId===i,n=e.originalVideoId===r.originalVideoId;return t&&n});if(!r||!n)return void this.shakaPlayer.selectAudioLanguage(t);const{height:o,videoBandwidth:a}=r,{language:s}=n;this.setVariantTrack(this.shakaPlayer.getVariantTracks().find(e=>e.height===o&&e.videoBandwidth===a&&e.language===s))}setTextTrack(e){let{value:t}=e;if(!this.shakaPlayer)return;const i=this.shakaPlayer.getTextTracks().find(e=>{let{originalTextId:i}=e;return i===t});i&&(this.shakaPlayer.selectTextTrack(i),this.emit("InternalTextTrackValueChange",t))}disableTextTrack(){this.shakaPlayer&&this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e),this.useNativeSubtitles=e}captureScreenshot(e){return(e=>{if(!Zv)return Promise.reject();Jv.width=e.videoWidth,Jv.height=e.videoHeight;try{Zv.drawImage(e,0,0,e.videoWidth,e.videoHeight)}catch(t){return Promise.reject(t)}return new Promise((e,i)=>{try{Jv.toBlob(t=>{e(t)},"image/jpeg")}catch(t){i(t)}})})(e).then(e=>{e&&(this.previousScreenshotBlobUrl=URL.createObjectURL(e))}).catch(()=>{this.previousScreenshotBlobUrl=void 0}).then(()=>this.previousScreenshotBlobUrl)}onVideoTagError(e){super.onVideoTagError(e),pp.log("-> onVideoTagError",e)}getDuration(){return Sn(this.shakaPlayer)?this.shakaPlayer.seekRange().end:jl(NaN)}async requestDebugInfo(){var e;return this.shakaPlayer?{manifest:null!=(e=i(()=>{var e;return null==(e=this.manifestXML)?void 0:e.documentElement.outerHTML}))?e:null,shakaPlayerStats:this.shakaPlayer.getStats()}:{noShakaPlayer:!0}}async preloadSource(){var e;await pn();if(this.isDestroyed||this.preloader&&!this.preloader.isDestroyed||void 0!==this.initMpdEncoderPromise||void 0!==this.shakaPlayer||!shaka.Player.isBrowserSupported()||(null==(e=this.customNetworkingEngine)?void 0:e.hasCachedData()))return;const t=new zg({source:this.props,getState:()=>this.state,getCapSizes:()=>this.getCapSizes(),type:zp.Internal});this.preloader=t,t.addDestroyHandler(()=>{this.preloader=void 0});const i=t.getVideoElement(),r=f(i,"canplay",()=>{this.captureScreenshot(i).then(()=>{this.props.setPlayerBackgroundImage(this.previousScreenshotBlobUrl),this.props.setPlayerBackgroundVisibility(!1)})},{once:!0});this.once("ContentImpression",r),this.once("Destroy",r),await t.preload()}createCachePreloader(){if(this.customNetworkingEngine)return new nm({stream:this.props.stream,sourceParams:this.props.sourceParams},na({},this.customNetworkingEngine.copyCachedData(),{cachedVariantTrack:this.customNetworkingEngine.getCurrentVariantTrack(),manifestXml:this.manifestXML,bufferedInfo:void 0===this.shakaPlayer?{total:[],audio:[],video:[]}:this.shakaPlayer.getBufferedInfo()}))}getSeekableRange(){const{start:e,end:t}=Sn(this.shakaPlayer)?this.shakaPlayer.seekRange():{start:jl(0),end:jl(0)};return{start:e,end:jl(Math.min(t,zl(this.getDuration(),sm)||0))}}canSeek(){return Sn(this.shakaPlayer)&&super.canSeek()}onTick(e){void 0!==this.shakaPlayer&&Sn(this.shakaPlayer)&&!1===this.shakaPlayer.isLive()&&void 0!==this.state.controller.videoType&&this.state.controller.videoType!==Bh.VOD&&this.emit("VideoTypeChange",Bh.VOD),super.onTick(e)}getStreamUrl(){const e=super.getStreamUrl(),t={audio_mbr:"1",mburl:"1"};return Fn(e)||(t.preview="1"),Lv.isLiveStreamUrl(e)&&(t.packager="1",t.lowlatency="1"),Tt(e,t,{saveOriginalPath:!0})}getMaxBufferLength(){const e=kn(this.shakaPlayer);return!(e===Bh.LIVE||e===Bh.EVENT)||this.shouldUseLowBuffer()||this.isLowLatencyLive()?super.getMaxBufferLength():this.props.liveOffset}async detachEncoder(){this.detachMpdEncoderCalled=!0;const e=Tn(this.shakaPlayer);this.lastTrackBeforeDetach=e||void 0,await super.detachEncoder(),this.manifestXML=void 0;const{video:t,shakaPlayer:i}=this;t.classList.remove(Tv().video_hiddenSubtitlesBtn),this.stopShakaConfigAutoUpdate(),void 0!==i&&await this.preventPauseAsync(t,()=>(this.shakaPlayer=void 0,i.destroy())),u(window.VTTCue)||delete window.VTTCue}async attachEncoder(){this.detachMpdEncoderCalled=!1,await super.attachEncoder(),this.initMpdEncoderPromise=this.initMpdEncoder(),await this.initMpdEncoderPromise,this.initMpdEncoderPromise=void 0}getBandwidthEstimate(){var e,t;const i=null==(e=this.preloader)?void 0:e.getBandwidthEstimate();if(i&&B(i.value))return i;const r=null==(t=this.shakaPlayer)?void 0:t.getStats(),{estimatedBandwidth:n,estimatedBandwidthSource:o}=r||{};return n?{value:n,source:o}:super.getBandwidthEstimate()}getServerTime(){var e;const t=null==(e=this.customNetworkingEngine)?void 0:e.getServerTime();return t?jl(t):void 0}getRemainingBufferedTime(){if(!Sn(this.shakaPlayer))return super.getRemainingBufferedTime();const{currentTime:e}=this.state.controller,{audio:t,video:i,total:r}=this.shakaPlayer.getBufferedInfo();return{total:bi(r,e)||jl(0),video:bi(i,e)||jl(0),audio:bi(t,e)||jl(0)}}getSegmentSize(){if(!Sn(this.shakaPlayer))return;const e=this.shakaPlayer.getStreamForTime(this.getCurrentTime());if(!e)return;const{stream:{width:t,height:i}}=e;return t&&i?{width:t,height:i}:void 0}getUtcEndTime(){if(kn(this.shakaPlayer)===Bh.LIVE)return this.getSeekableRange().end;const e=this.getUtcStartTime();return e?Kl(e,this.getDuration()):jl(0)}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e!==Bh.LIVE)return super.calculateDVRParams();const{fragmentDuration:t,startTime:i,totalDuration:r}=this.getFragmentsData(),n=ql(t,1);return{fragmentDuration:t,dvrStartTime:i,dvrDuration:r,skinDVRStartTime:Kl(n,i),skinDVRDuration:zl(r,n)}}handleVideoElementPlayEvent(){var e;null!=(e=this.shakaPlayer)&&e.isBuffering()||super.handleVideoElementPlayEvent()}onVideoResize(){super.onVideoResize(),this.actualizeActiveVariantTrack()}async recoverStream(){return 1===this.recoverHelper.attempt&&this.captureScreenshot(this.props.video).then(()=>{this.handleBackgroundBeforeRecover()}),super.recoverStream()}async play(){if(this.isPauseCalled=!1,this.initMpdEncoderPromise&&await this.initMpdEncoderPromise,this.isPauseCalled)throw new Error("Pause called during play");await super.play()}pause(){this.isPauseCalled=!0,super.pause()}handleBackgroundBeforeRecover(){this.props.setPlayerBackgroundImage(this.previousScreenshotBlobUrl),this.once("CanPlay",()=>{this.props.setPlayerBackgroundImage(),this.clearScreenshot()})}async initMpdEncoder(){var e,t,i,r;try{await pn()}catch(l){if(l instanceof Error){const e=new jc(l,{code:Cs.MPD_SHAKA_INIT_ERROR});throw this.props.onError(e),e}throw l}if(this.detachMpdEncoderCalled)return;const n=vo(this.video,()=>new shaka.Player(this.video));this.shakaPlayer=n,this.customNetworkingEngine=this.customNetworkingEngine||new Gg(null==(e=this.preloader)?void 0:e.copyCachedData()),this.customNetworkingEngine.setup(n,this.onShakaNetworkSuccess,this.onShakaNetworkError),this.playerStore.dispatch(wh(void 0===this.preloader?void 0:{preloadingMethod:this.preloader.getType(),preloaded:this.preloader.preloaded})),this.manifestXML=null==(t=this.preloader)?void 0:t.getManifestXml(),this.preloadedTrack=null==(i=this.preloader)?void 0:i.getCachedVariantTrack(),null==(r=this.preloader)||r.destroy(),this.preloader=void 0,this.subscribeContentImpression(),this.attachShakaEventListeners(n);const o=n.getNetworkingEngine();this.customNetworkingEngine.registerRequestFilter(this.shakaHTTPRequestFilter),o.registerResponseFilter(this.shakaPreviewsHTTPResponseFilter);const{video:a}=this,s=()=>this.useNativeSubtitles;this.configureShaka(n,na({},this.getInitialShakaConfig(),{textDisplayFactory:function(){return new zv(a,s)}}));try{if(await this.preventPauseAsync(this.video,async()=>{this.playingStateBeforeLoadShakaSource=this.state.controller.playingState,await Mn({shakaPlayer:n,streamUrl:this.getStreamUrl(),startPosition:this.state.controller.startPosition}),this.playingStateBeforeLoadShakaSource=void 0}),this.preloadedTrack=void 0,this.detachMpdEncoderCalled)return;this.initShakaConfigAutoUpdate(),this.lastTrackBeforeDetach=void 0}catch(l){if(this.playingStateBeforeLoadShakaSource=void 0,this.detachMpdEncoderCalled)return;if(zo(l))return void this.onShakaError(l);this.props.onError(new jc(l,{code:Cs.SHAKA_LOAD_SOURCE_ERROR,isFatal:!0}))}}findPreloadedVariant(e){var t;const i=this.preloadedTrack||this.lastTrackBeforeDetach;if(void 0!==i&&null!=(t=this.customNetworkingEngine)&&t.hasCachedSegments())return e.find(e=>{let{video:t,audio:r}=e;const n=!t||t.originalId===i.originalVideoId,o=!r||r.originalId===i.originalAudioId;return n&&o})}getPlaybackRate(){return this.state.controller.playbackRate}getInitialShakaConfig(){var e;const t=this.getBandwidthEstimate(),i=this.abrManager=new Ng({getPlaybackRate:this.getPlaybackRate.bind(this),bandwidthEstimateOffset:null!=(e=this.props.bandwidthEstimateOffset)?e:Ul(0),getSegmentDuration:()=>On(this.shakaPlayer),getFilterParams:e=>({preloadedVariant:this.findPreloadedVariant(e),restrictions:this.abrRestrictionsHelper.getAbrRestrictions()}),isLowLatencyLive:()=>this.isLowLatencyLive()});return na({},og,{abr:na({},og.abr,null!=t&&t.value?{defaultBandwidthEstimate:t.value,defaultBandwidthEstimateSource:t.source}:{}),abrFactory:function(){return i},streaming:na({},og.streaming,{bufferingGoal:this.getMaxBufferLength(),failureCallback:this.shakaFailureCallback})})}attachShakaEventListeners(e){e.addEventListener("buffering",this.updateBufferingState),e.addEventListener("error",this.onShakaErrorEvent),e.addEventListener("adaptation",this.onShakaAdaptationEvent),e.addEventListener("trackschanged",this.actualizeTracks),e.addEventListener("emsg",this.onShakaEmsgEvent),e.addEventListener("largegap",this.reportLargeGap),e.addEventListener("variantchanged",()=>{this.tryToUpdateStreamingParameters()}),e.addEventListener("trackschanged",()=>{this.tryToUpdateStreamingParameters()}),e.addEventListener("manifestparsed",()=>{this.onManifestParsed(e),this.updateShakaConfig();const t=this.getBandwidthEstimate();B(t.value)&&this.configureShaka(e,{abr:{defaultBandwidthEstimate:t.value,defaultBandwidthEstimateSource:t.source}})}),e.addEventListener("trackschanged",U(this.restoreUserTracks))}tryToUpdateVideoType(){const e=kn(this.shakaPlayer);e&&e!==this.state.controller.videoType&&this.emit("VideoTypeChange",e)}tryToUpdateProgramDateTime(){const e=Dn(this.shakaPlayer,this.manifestXML),t=void 0===e?void 0:ql(e,1e3);void 0!==t&&t!==this.state.controller.programDateTime&&this.emit("ProgramDateTimeChange",t)}tryToUpdateStreamingParameters(){this.tryToUpdateVideoType(),this.tryToUpdateProgramDateTime()}onManifestParsed(e){this.tryToUpdateStreamingParameters(),this.setShakaAvailabilityWindowOverride(e),this.setPresentationTimelineDelay(e)}isLowLatencyLive(){var e,t;return Boolean(null==(e=this.shakaPlayer)?void 0:e.isLive())&&Boolean(null==(t=this.manifestXML)?void 0:t.querySelector("[availabilityTimeOffset]"))}setPresentationTimelineDelay(e){var t;const i=e.getManifest();if(!i)return;const r=null==(t=this.customNetworkingEngine)?void 0:t.getServerTime();void 0!==r&&i.presentationTimeline.setClockOffset(r-Date.now());const n=this.isLowLatencyLive()?0:this.props.liveOffset+Wv;i.presentationTimeline.setDelay(n)}setShakaAvailabilityWindowOverride(e){const t=kn(e);if(void 0===t)return;const i=t===Bh.EVENT?1/0:NaN,{manifest:{availabilityWindowOverride:r}}=e.getConfiguration();i===r||isNaN(i)&&isNaN(r)||this.configureShaka(e,{manifest:{availabilityWindowOverride:i}})}setVariantTrack(e){void 0!==this.shakaPlayer&&void 0!==e&&(this.shakaPlayer.selectVariantTrack(e,!0),this.actualizeTracks())}setAbrEnabled(e){var t;void 0!==this.shakaPlayer&&(null==(t=this.shakaPlayer.getConfiguration().abr)?void 0:t.enabled)!==e&&(this.configureShaka(this.shakaPlayer,{abr:{enabled:e}}),this.updateShakaConfig())}actualizeActiveTracks(){this.actualizeActiveVariantTrack(),this.actualizeActiveTextTrack()}actualizeActiveVariantTrack(){const e=Tn(this.shakaPlayer);if(void 0===e)return;const{originalAudioId:t,originalVideoId:i}=e;this.emit("InternalVideoTrackValueChange",i),this.emit("InternalAudioTrackValueChange",t)}actualizeActiveTextTrack(){if(void 0===this.shakaPlayer)return;const{controller:{textTrackEnabled:e}}=this.state,t=this.getCurrentInternalTextTrack();this.emit("InternalTextTrackValueChange",void 0!==t&&e?this.parseTextTrack(t).value:void 0)}actualizeAvailableTracks(){this.actualizeAvailableTextTracks(),this.actualizeAvailableVariantTracks()}actualizeAvailableTextTracks(){const e=this.getAvailableTextTracks();this.video.classList.toggle(Tv().video_hiddenSubtitlesBtn,0===e.length),this.emit("TextTracksChange",e)}getAvailableTextTracks(){return this.shakaPlayer?this.shakaPlayer.getTextTracks().map(this.parseTextTrack):[]}actualizeAvailableVariantTracks(){const e=Tn(this.shakaPlayer);if(!e)return;const t=bn(this.shakaPlayer);if(!t)return;const{variants:i}=t;if(!Array.isArray(i))return;const r={},n={};i.forEach(t=>{const i=t.video,o=t.audio;if(!o||o.originalId===e.originalAudioId){const t=((e,t)=>{const{bandwidth:i,width:r,height:n,originalId:o}=e;return{name:ta(e,t),value:o,width:r,height:n,bitrate:i?Xl(Ul(i),1e3):jp}})(i,this.videoTrackLabels),{name:n=String(t.height)||""}=t;(void 0===r[n]||t.value===e.originalVideoId||r[n].value!==e.originalAudioId&&r[n].bitrate<t.bitrate)&&(r[n]=t)}if(o&&i.originalId===e.originalVideoId){const t=function(e){let{manifestXml:t,audioStream:{label:i,language:r,originalId:n,bandwidth:o}}=e;const a=ea(t,n)||r;return{name:i||a||n,value:n,lang:a,bitrate:Bl(o?o/1e3:jp)}}({manifestXml:this.manifestXML,audioStream:o}),{name:i}=t;(void 0===n[i]||t.value===e.originalAudioId||n[i].value!==e.originalAudioId&&n[i].bitrate<t.bitrate)&&(n[i]=t)}}),this.emit("VideoTracksChange",hr(r)),this.emit("AudioTracksChange",hr(n))}getCurrentInternalTextTrack(){return void 0===this.shakaPlayer?void 0:this.shakaPlayer.getTextTracks().find(Vg)}checkDeadChunkServer(e){if(!shaka)return;if(!_t(this.getStreamUrl()))return;const{code:t,data:i}=e;if(!(t===shaka.util.Error.Code.BAD_HTTP_STATUS||t===shaka.util.Error.Code.HTTP_ERROR||t===shaka.util.Error.Code.TIMEOUT))return;const[r]=i,n=i[i.length-1];if("string"===typeof r&&n===shaka.net.NetworkingEngine.RequestType.SEGMENT){const{hostname:e}=mt(r);this.chunkHostnameBlacklist.addHostname(e)}}initShakaConfigAutoUpdate(){this.stopShakaConfigAutoUpdate(),this.shakaConfigAutoUpdateInterval=window.setInterval(()=>{this.updateShakaConfig()},am)}updateShakaConfig(){const{shakaPlayer:e}=this;if(void 0!==e)try{const t=this.getMaxBufferLength();if(e.getConfiguration().streaming.bufferingGoal===t)return;this.configureShaka(e,{streaming:{bufferingGoal:t}})}catch(t){}}stopShakaConfigAutoUpdate(){clearInterval(this.shakaConfigAutoUpdateInterval)}configureShaka(e,t){try{e.configure(t)}catch(i){i instanceof Error&&this.props.onError(new jc(i,{isFatal:!1,code:Cs.SHAKA_CONFIGURE_ERROR}))}}checkRepresentationChange(e,t){if(function(e,t){const i=Zo(e),r=Zo(t);return wp()(i,r)}(e,t))return;this.props.onExpectedStalledChange(ut(Fh.RepresentationsChange,void 0));const i=new jc({isFatal:!1,code:Cs.REPRESENTATION_CHANGE});this.props.onError(i),this.recoverStream()}computeVideoPlayingState(e){const t=e.isBuffering();return void 0===this.playingStateBeforeLoadShakaSource?Oo(this.video,t):this.playingStateBeforeLoadShakaSource===$l.PAUSE?$l.PAUSE:t?$l.BUFFERING:$l.PLAY}}const dm=function(e){if(void 0===e&&(e=window),!Y(e)&&!e.navigator)return-1;const{userAgent:t}=e.navigator,i=t.indexOf("OS ");return(t.includes("iPhone")||t.includes("iPad"))&&i>-1?Number(t.substr(i+3,3).replace("_",".")):-1}();class cm extends Td{constructor(e){super(),this.video=void 0,this.unsubscribers=[],this.isStrmCatchUpStream=void 0,this.seekableEndFifo=new xg(2),this.destroy=()=>{O(this.unsubscribers)},this.handleProgressEvent=()=>{if(!this.video||!this.video.seekable.length)return;const{seekable:e}=this.video,t=jl(e.end(e.length-1)),i=this.seekableEndFifo.getAll();t!==i[i.length-1]&&(this.seekableEndFifo.push(t),this.updateVideoType())},this.updateVideoType=()=>{this.emit("VideoTypeChange",this.getVideoType())},this.isStrmCatchUpStream=function(e){if(!_t(e))return!1;const t=Et(mt(e).search);return Boolean(t.start)}(e)}setHTMLVideoElement(e){this.destroy(),this.video=e,this.unsubscribers.push(f(e,"timeupdate",this.updateVideoType)),this.unsubscribers.push(f(e,"durationchange",this.updateVideoType)),this.unsubscribers.push(f(e,"progress",this.handleProgressEvent))}getVideoType(){if(!this.video||isFinite(this.video.duration))return Bh.VOD;if(this.isStrmCatchUpStream)return Bh.EVENT;const e=this.seekableEndFifo.getAll();if(!this.video.seekable.length||e.length<2)return Bh.LIVE;const t=this.video.seekable.start(0);return e[1]>e[0]&&t?Bh.LIVE:Bh.EVENT}}const um=["loadstart","progress","durationchange","loadedmetadata","loadeddata","canplay","playing"];class hm extends Gv{initInternalSubscribe(){super.initInternalSubscribe(),this.recoverIosSleepMode(),this.activateVideoTagIosWorkaround()}constructor(e){super(e),this.props=e,this.engine=Qp.NATIVE,this.isLowLatencyLiveStream=!1}getUtcStartTime(){const{video:e}=this,t=e;if(!this.video.src||0===e.readyState||"function"!==typeof t.getStartDate)return super.getUtcPosition();const i=t.getStartDate();if(!i||"function"!==typeof i.getTime)return super.getUtcPosition();const r=Gl(i.getTime());return isNaN(r)?super.getUtcPosition():Xl(r,1e3)}getUtcPosition(){const e=this.getUtcStartTime();return e>0?Kl(e,this.getCurrentTime()):super.getUtcPosition()}async attachEncoder(){this.emit("BufferingRangesChange",[]),await super.attachEncoder(),pp.log("hls native mode")}async detachEncoder(){await super.detachEncoder(),this.video.src&&this.video.removeAttribute("src")}shouldSkipVideoTagError(e){return super.shouldSkipVideoTagError(e)}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if(B(e)||B(t)){if(this.state.controller.videoType===Bh.LIVE){const e=this.getUtcStartTime();if(e>0&&B(t)&&t>0)return t-e}return B(e)?e:void 0}}waitForStartPositionEstablished(){return new Promise((e,t)=>{const i=[];um.forEach(t=>{i.push(this.addVideoEventListener(t,()=>{this.canSeek()&&(this.applyStartPosition(),O(i),e())},{once:!0}))}),this.once("Detach",()=>{O(i),t()})})}isDvrEnabled(){if(Bf.isSmartTV())return!1;if(Bf.isSafariDesktop())return!0;const{controller:{isFullscreen:e},skin:{nativeControlsVisibility:t}}=this.state;return!e&&!t}setVideoTrack(e){if(e.value===this.currentVideoTrack.value)return;this.currentVideoTrack=e,this.playerStore.dispatch(ju({videoTime:this.getCurrentTime()}));const t=this.currentState,i=this.getStreamUrl();this.video.src=i,this.video.load(),t!==$l.PLAY&&t!==$l.BUFFERING||this.play(),"auto"!==e.value&&this.emit("InternalVideoTrackValueChange",e.value)}getBandwidthEstimate(){return{value:Ul(NaN),source:"default"}}async initDrm(){}getStreamUrl(){const{isMultipleHLSAudioBitrate:e=!1}=this.props,t={};e&&(t.audio_mbr="1");const i=super.getStreamUrl(),r=Lv.isLiveStreamUrl(i),n=dm>=14||Hf>=15;if(this.isLowLatencyLiveStream=r&&n,this.isLowLatencyLiveStream&&(t.lowlatency="1"),t.force_m4s="1","auto"!==this.currentVideoTrack.value&&this.currentVideoTrack.height){var o;const e=null==(o=this.currentVideoTrack.height)?void 0:o.toString();t.min_res_height=e,t.max_res_height=e}return Tt(i,t,{saveOriginalPath:!0})}isLowLatencyLive(){return this.isLowLatencyLiveStream}initVideoTypeQualifier(){const e=new cm(this.getStreamUrl());this.once("Detach",e.destroy),e.on("VideoTypeChange",e=>{e&&this.emit("VideoTypeChange",e)}),e.setHTMLVideoElement(this.video)}onTick(e){super.onTick(e),this.updateProgramDateTime()}recoverIosSleepMode(){if(!fd)return;const e=R(this.getVideoOwnerDocument(),e=>{e&&(ei(this.state)||this.canSeek()&&(this.video.currentTime-=.001))});this.once("Destroy",e)}updateProgramDateTime(){const{videoType:e}=this.state.controller,t=this.getUtcStartTime(),i=(e===Bh.LIVE||e===Bh.EVENT)&&t?ql(t,1e3):void 0;this.emit("ProgramDateTimeChange",i)}activateVideoTagIosWorkaround(){fd&&this.once("Destroy",f(this.video,"touchstart",()=>{this.video.paused?this.video.pause():Promise.resolve(this.video.play()).catch(Q)},{once:!0}))}}U(()=>jr("web_prefer_hd"));const pm=function(){try{return JSON.parse(pf.getItem("videoplayer-prefer-hd")||"{}")}catch(kE){return{}}}(),fm=r(window),gm={};var vm=e(4514),mm=e.n(vm);class Am extends Nl{constructor(e){super(),this.video=void 0,this.playbackQuality=Rv,this.persistedPlaybackQuality=Rv,this.accumulatedPlaybackQuality=Rv,this.video=e,this.addDestroyHandler(()=>{this.reset(),this.video=void 0})}update(){if(!this.video)return;const e=ko(this.video);this.playbackQuality=e,0!==this.persistedPlaybackQuality.totalVideoFrames&&(this.persistedPlaybackQuality.totalVideoFrames>e.totalVideoFrames&&(this.accumulatedPlaybackQuality={droppedVideoFrames:this.accumulatedPlaybackQuality.droppedVideoFrames+this.persistedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.accumulatedPlaybackQuality.corruptedVideoFrames+this.persistedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.accumulatedPlaybackQuality.totalVideoFrames+this.persistedPlaybackQuality.totalVideoFrames}),this.persistedPlaybackQuality=Rv)}persist(){0!==this.playbackQuality.totalVideoFrames&&(this.persistedPlaybackQuality=this.playbackQuality,this.playbackQuality=Rv)}reset(){this.playbackQuality=Rv,this.persistedPlaybackQuality=Rv,this.accumulatedPlaybackQuality=Rv}getPlaybackQuality(){return this.persistedPlaybackQuality.totalVideoFrames>0?Rv:{droppedVideoFrames:this.playbackQuality.droppedVideoFrames+this.accumulatedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.playbackQuality.corruptedVideoFrames+this.accumulatedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.playbackQuality.totalVideoFrames+this.accumulatedPlaybackQuality.totalVideoFrames}}}const Em=["time","cacheVersion"],ym=Gl(2592e5),Sm=e(9979),Tm=["object"===typeof document&&document&&"onfreeze"in document?"pagehide":"beforeunload","unload"],Rm=!sd&&ef("video/webm")?"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAByhFNm3RAHU27i1OrhBVJqWZTrIHlTbuMU6uEFlSua1OsggEj7AEAAAAAAAC5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAADIq17GDD0JATYCNTGF2ZjU3Ljc2LjEwMFdBjUxhdmY1Ny43Ni4xMDBEiYhASwAAAAAAABZUrmsBAAAAAAAAYq4BAAAAAAAAWdeBAXPFgQGcgQAitZyDdW5khoZBX09QVVNWqoNjLqBWu4QExLQAg4EC4QEAAAAAAAARn4ECtYhA53AAAAAAAGJkgSBjopNPcHVzSGVhZAECOAGAuwAAAAAAH0O2dQEAAAAAAAAt54EAo4eBAACA/P/+o4eBABWA/P/+oAEAAAAAAAAPoYeBACkA/P/+daKDa3KD":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAMm1kYXTeBABMYXZjNTcuMTA3LjEwMABCIAjBGDghEARgjBwhEARgjBwhEARgjBwAAAMbbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAAEsAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAkV0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAAEsAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAA1AAAEAAABAAAAAAG9bWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAADgZVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAABaG1pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAABLHN0YmwAAABqc3RzZAAAAAAAAAABAAAAWm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAANmVzZHMAAAAAA4CAgCUAAQAEgICAF0AVAAAAAAH0AAAAEYwFgICABRGQVuUABoCAgAECAAAAMHN0dHMAAAAAAAAABAAAAAEAAAQAAAAAAQAABBgAAAABAAAEAAAAAAEAAAHuAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAAEAAAAAQAAACRzdHN6AAAAAAAAAAAAAAAEAAAAGAAAAAYAAAAGAAAABgAAABRzdGNvAAAAAAAAAAEAAAAsAAAAGnNncGQBAAAAcm9sbAAAAAIAAAAB//8AAAAcc2JncAAAAAByb2xsAAAAAQAAAAQAAAABAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ny44My4xMDA=";let Pm=function(e){return e.AutomaticallyGenerated="AutomaticallyGenerated",e.HardcodedParams="HardcodedParams",e.IOS9OrLess="IOS9OrLess",e.HTML5VideoIsNotSupported="HTML5VideoIsNotSupported",e.WindowHasBeenActive="WindowHasBeenActive",e.RAAStopped="RAAStopped",e.OldIE="OldIE",e.MediaError="MediaError",e.NotRecognized="NotRecognized",e.YaBroAllowedToPlay="YaBroAllowedToPlay",e}({});const _m=Hs(),bm=e=>{const{paused:i}=e;return()=>{i?e.pause():e.paused&&t(function(e){if(!Es)return Promise.reject();const t=(i=e.play).__yaMuffleVideoPlayPromiseOriginalPlay||i;var i;if(u(t))return t.call(e);const r=ua("HTMLVideoElement")||ua("HTMLMediaElement");if(r)return r.call(e);const n=document.createElement("div");n.style.display="none",document.body.appendChild(n);const o=ua("HTMLMediaElement",P(n).contentWindow);if(o){const t=o.call(e);return _(n),t}return e.play()}(e))}},Im=e=>{const t=(e=>{const{muted:t}=e;return()=>{e.muted=t}})(e),i=(e=>{const{volume:t}=e;return()=>{e.volume=t}})(e),r=bm(e);return()=>{t(),i(),r()}},Cm=_m>-1&&_m<=16,Om=pa({canPlayUnMuted:!1,canPlayMuted:!1,detectionMethod:Pm.AutomaticallyGenerated}),wm=pa({canPlayUnMuted:!0,canPlayMuted:!0,detectionMethod:Pm.AutomaticallyGenerated}),km=Gl(500);class Dm{constructor(e,t){let{checkSoundEnabled:i,promise:r}=t;if(this.video=e,this.promise=void 0,this.stop=Q,this.isStopped=!1,this.revertVideoState=Q,this.getIsActiveWindow())return this.promise=Promise.resolve(ha({},wm,{detectionMethod:Pm.WindowHasBeenActive})),this;if(r)return this.promise=r,this;const n=document.createElement("div");n.style.display="none";const o=Im(e),a=vo(e,()=>function(e,t){const i={};return v(t).forEach(t=>{i[t]=e.getAttribute(t)}),To(e,t),U(()=>{To(e,i)})}(e,{src:Rm}));let s;this.revertVideoState=U(()=>{a(),e.load(),o(),_(n)}),this.promise=new Promise(async(e,t)=>{let r,n,o;if(s=t,i){const e=await this.requestAutoplayAbilityByMuted(!1);n=e.autoplayAbility,r=e.detectionMethod}else n=!1;if(!this.isStopped){if(n)o=!0;else{const e=await this.requestAutoplayAbilityByMuted(!0);o=e.autoplayAbility,r=r&&r!==e.detectionMethod?"DifferentDetectionMethods unmuted=["+r+"] muted=["+e.detectionMethod+"]":e.detectionMethod}this.isStopped||(this.revertVideoState(),this.isStopped=!0,e(pa({canPlayUnMuted:n,canPlayMuted:o,detectionMethod:r||Pm.NotRecognized})))}}),this.stop=()=>{this.isStopped||(this.isStopped=!0,s(new Error("requestAutoplayAbility has been stopped")),this.revertVideoState())}}async requestAutoplayAbilityByMuted(e){const{video:t}=this;if(vo(t,()=>{t.load()}),await(async(e,t)=>{let i;try{await new Promise((r,n)=>{t&&t.then(r,n),i=window.setTimeout(r,e)})}finally{window.clearTimeout(i)}})(0),this.isStopped)return{autoplayAbility:!1,detectionMethod:Pm.RAAStopped};t.muted=e,t.volume=e?0:1;const i=await new Promise(e=>{_o(t,{useProgressEvent:!0,timeoutForNonPromisePlay:km}).then(t=>{e({autoplayAbility:!0,detectionMethod:t})}).catch(i=>{const r=xn(t);r&&r.code===qg.MEDIA_ERR_DECODE?setTimeout(()=>{e({autoplayAbility:!0,detectionMethod:Pm.MediaError})},0):e({autoplayAbility:!1,detectionMethod:i})})});return this.isStopped?{autoplayAbility:!1,detectionMethod:Pm.RAAStopped}:i}getIsActiveWindow(){const e=ia(this.video);if(!e)return!1;const t=da(e);return Boolean(t&&t.hasBeenActive)}}let Nm=function(e){return e.AutoplayDisabled="AutoplayDisabled",e.RASAborted="RASAborted",e}({});const Lm=u(Object.getPrototypeOf)?e=>Object.getPrototypeOf(e):e=>e.__proto__||Object.prototype;var Mm=e(9979),Vm=e.n(Mm);const xm=[{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}},{enabled:"webkitSupportsFullscreen",element:"webkitDisplayingFullscreen",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}}];let Fm=function(e){return e.NATIVE="NATIVE",e.HLS="HLS",e.MPD="MPD",e.MP4="MP4",e}({}),Um=function(e){return e.init="init",e.waitForUserPlay="waitForUserPlay",e.waitForDocumentVisibility="waitForDocumentVisibility",e.starting="starting",e.started="started",e.broken="broken",e.destroyed="destroyed",e}({}),Bm=function(e){return e.AdCompleted="AdCompleted",e.LoadSource="LoadSource",e.PlayerDestroy="PlayerDestroy",e.CutOff="CutOff",e.PlayerError="PlayerError",e.AdTypeChange="AdTypeChange",e.InsertIntoCalled="InsertIntoCalled",e.AdSkipped="AdSkipped",e}({}),Hm=function(e){return e.AdStart="AdStart",e.AdOther="AdOther",e.AdBetween="AdBetween",e.AdEnd="AdEnd",e}({}),Gm=function(e){return e.WATERFALL="waterfall",e.PIXEL="pixel",e}({}),jm=function(e){return e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end",e}({}),Wm=function(e){return e.DIRECT="direct",e.MT="mt",e}({}),Ym=function(e){return e.preroll="preroll",e.midroll="midroll",e.postPauseroll="postPauseroll",e.postroll="postroll",e.inroll="inroll",e}({});const Km=async(e,t)=>fetch(e,{method:"POST",body:JSON.stringify([t])}),zm=function(){let e;return{createInstance:(t,i,r)=>(e&&e.resetTimer(),e=((e,t,i)=>{let r,n,o=0,a=Number.POSITIVE_INFINITY,s=!1;const l=()=>{const d=Math.floor(i.getConfig().getControllerWatchedTime());Number.isInteger(n)&&d<t&&!s&&(n&&clearTimeout(n),n=setTimeout(l,1e3),o!==d&&(o=d,r=e.setPosition(o,t)),a-=1,i.getConfig().callbacks.onAdPodTimeToSkipChange(jl(a)))},d=()=>{o=0,r=void 0,a=Number.POSITIVE_INFINITY,n&&clearTimeout(n)};return{start:()=>{s=!1,d(),n=setTimeout(l,1e3)},stop:()=>{s=!0,d()},play:()=>{n&&clearTimeout(n),n=setTimeout(l,1e3)},pause:()=>{n&&clearTimeout(n)},resetTimer:()=>{s=!0,d()},getNextAdTime:()=>r,getSkipAdTime:()=>a,setSkipAdTime:e=>{a=e},getTime:()=>o,setTime:e=>{o=e}}})(t,i,r),e)}}();let qm=function(e){return e.PREROLL="preroll",e.MIDROLL="midroll",e.POSTROLL="postroll",e}({});const Xm={destroy:p,setStatsRootFields:p,dispatchEvent:p,getNextAdInfo:()=>{},preroll:{loadViewers:()=>Promise.resolve([])},midroll:{loadViewers:()=>Promise.resolve([])},inroll:{loadViewers:()=>Promise.resolve([]),schedule:p},postroll:{loadViewers:()=>Promise.resolve([])},postPauseroll:{loadViewers:()=>Promise.resolve([])}},Qm=e=>({promise:new Promise((t,i)=>{an({src:e.vasLoaderUrl,onError:t=>{e.yaDirectPixel&&Km(e.yaDirectPixel.url,Sa({},e.yaDirectPixel.data,{eventType:"dsp_request_failed",inventory:"instream",eventUnixTime:Math.floor(Date.now()/1e3)})),i(t)},onLoad:()=>{e.yaDirectPixel&&Km(e.yaDirectPixel.url,Sa({},e.yaDirectPixel.data,{eventType:"dsp_request",inventory:"instream",eventUnixTime:Math.floor(Date.now()/1e3)})),e.win.ya.videoAd.loadModule(e.moduleName).then(e=>t(e)).catch(i)}})})}),Jm="https://yandex.ru/ads/system/adsdk.js",Zm={[qm.MIDROLL]:Ym.midroll,[qm.POSTROLL]:Ym.postroll,[qm.PREROLL]:Ym.preroll},$m={play:jm.PLAY,pause:jm.PAUSE,end:jm.END,idle:jm.PAUSE};class eA extends Nl{constructor(e){super(),this.params=e,this.previousAdPlayingState="",this.destroyPromise=new Promise(e=>{this.addDestroyHandler(()=>{e()})}),this.currentAdPlaybackController=void 0,this.playbackQueue=[],this.logAdStart=U(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length;this.params.onAdStart({adPodsCount:t,adType:e}),e===Ym.inroll&&this.params.onInrollAdStart({adPodsCount:t})}),this.logAdEnd=U(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length;e===Ym.inroll&&this.params.onInrollAdEnd({adPodsCount:t}),this.params.onAdEnd({stopAdReason:this.destroyReason||Bm.AdCompleted,adPodsCount:t,adType:e})}),this.adPodIndex=0,this.startPlayingAd=U(async()=>{if(this.logAdStart(),this.params.yaDirectPixel&&this.playbackQueue.length>0){const e=this.playbackQueue[0],t=e.adViewer.getYandexBidReqIdArray();Km(this.params.yaDirectPixel.url,Ia({},this.params.yaDirectPixel.data,{eventUnixTime:Math.floor(Date.now()/1e3),eventType:"ads_rendered",inventory:"instream",count:e.adViewer.getAdPodsCount(),bidReqId:t&&t.length>0?t[0]:void 0}))}for(;this.adPodIndex<this.playbackQueue.length&&!this.isDestroyed;)await this.playAdPod(this.playbackQueue[this.adPodIndex]),this.adPodIndex++;this.logAdEnd();const e=this.playbackQueue[this.playbackQueue.length-1];this.isDestroyed||void 0===e||i(()=>{this.params.onLastAdPodStopped({adType:e.adViewer.getAdBreakType()})}),this.destroy(Bm.AdCompleted)}),this.dispatchOnFirstAdPodStarted=U(()=>{this.params.onFirstAdPodStarted()}),this.updateAdPodCloseState=e=>{this.params.onAdPodCloseStateChange(e.getAdPodCloseState())},this.updateAdVolumeAvailabilityStateChange=e=>{this.params.onAdVolumeAvailabilityStateChange(e.getAdVolumeAvailabilityState())},this.updateAdPodTimeToSkip=e=>{const t=e.getAdPodTimeToSkip();this.params.onAdPodTimeToSkipChange(B(t)?jl(Math.ceil(t)):void 0)},this.playAdPod=async e=>{let{adType:t,adViewer:i,additionalData:r,adDisplayConfig:n,posterUrl:o,adElement:a}=e;if(0===i.getAdPodsCount())return void this.params.logger.log("AdViewer is empty");if(this.params.onAdPodLoading({adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:r}),t===Ym.inroll){const{cueId:e}=r;this.params.onInrollAdPodStart({adPodsCount:this.playbackQueue.length,cueId:e}),i.setStatsRootFields({cueid:e})}const s=i.createPlaybackController(this.params.video,a,Ia({videoSlotCanAutoPlay:!0,controlsSettings:this.params.getControlsSettings(),visibilitySlot:this.params.playerContainer,lang:this.params.lang,contentAfterAd:this.getContentAfterAd(t,o),enableNewSkin:!0,adSequence:{index:this.adPodIndex,count:this.playbackQueue.length}},n));this.currentAdPlaybackController=s,this.updateAdPodDuration(s),this.params.onAdPodCurrentTimeChange(jl(0)),this.params.onAdSkippableStateChange(s.getAdSkippableState()),this.updateAdPodCloseState(s),this.updateAdVolumeAvailabilityStateChange(s),s.subscribe("AdPlayingStateChange",()=>{this.updateAdPodPlayingStateChange()}),s.subscribe("AdMediaStateChange",()=>{this.updateAdPodPlayingStateChange()}),s.subscribe("AdRemainingTimeChange",()=>{const e=s.getAdPodRemainingTime(),t=this.updateAdPodDuration(s);this.params.onAdPodCurrentTimeChange(jl(t-e)),this.updateAdPodTimeToSkip(s),this.updateAdPodPlayingStateChange()}),s.subscribe("AdPodError",e=>{let{code:t}=e;if(this.params.yaDirectPixel){const e=this.playbackQueue[this.adPodIndex],t=e.adViewer.getYandexBidReqIdArray();Km(this.params.yaDirectPixel.url,Ia({},this.params.yaDirectPixel.data,{eventUnixTime:Math.floor(Date.now()/1e3),eventType:"ads_render_failed",inventory:"instream",count:e.adViewer.getAdPodsCount(),bidReqId:t&&t.length>0?t[0]:void 0}))}this.params.onAdPodError({additionalData:this.playbackQueue[this.adPodIndex].additionalData,adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adType,adPodIndex:this.adPodIndex+1,code:t})}),s.subscribe("AdInteraction",()=>{this.params.onAdInteraction()}),s.subscribe("AdSkippableStateChange",e=>{this.updateAdPodTimeToSkip(s),this.params.onAdSkippableStateChange(e.skippableState)}),s.subscribe("AdStartRejected",e=>{this.params.onAdStartRejected(new Error("AdStartRejected"))}),s.subscribe("AdPodDurationChange",()=>{this.updateAdPodDuration(s)}),s.subscribe("AdPodStartRequest",()=>{this.params.onBeforeAdPodStart({adPlaybackController:s})}),s.subscribe("AdPodStarted",()=>{var e;const t=null==(e=s.getCurrentViewerAssets())?void 0:e.isFullyClickable,i=jl(s.getAdPodDuration()),n=s.getAdContentSize();this.dispatchOnFirstAdPodStarted(),this.params.onAdPodStarted({adPodIndex:this.adPodIndex+1,adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:r,isFullyClickable:t,adPodDuration:i,width:(null==n?void 0:n.width)||0,height:(null==n?void 0:n.height)||0}),this.updateAdPodPlayingStateChange(),this.updateAdPodDuration(s)});const l=()=>{this.params.onAdPodDurationChange(void 0),this.params.onAdPodCurrentTimeChange(void 0),this.params.onAdSkippableStateChange(!1),this.params.onAdPodTimeToSkipChange(void 0),this.params.onAdPodCloseStateChange(void 0)};s.subscribe("AdPodStopped",()=>{l(),this.params.onAdPodStopped()}),s.subscribe("AdPodSkipped",()=>{l(),this.params.onAdPodSkipped({adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,adPodIndex:this.adPodIndex+1,additionalData:r})}),s.subscribe("AdContentSizeChange",()=>{const e=s.getAdContentSize();if(void 0===e)return;const{width:t,height:i}=e;this.params.onAdSizeChange({width:Yl(B(t)?t:NaN),height:Yl(B(i)?i:NaN)})}),s.subscribe("AdPodImpression",()=>{this.params.onAdPodImpression({adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:r})}),s.subscribe("AdClickThru",()=>{this.params.onAdClickThru({adPodIndex:this.adPodIndex+1,adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:r})}),this.shouldSkipAllAdPods()&&s.subscribe("AdPodSkipped",()=>{this.destroy(Bm.AdSkipped)}),s.subscribe("AdPodCloseStateChange",()=>{this.updateAdPodCloseState(s)}),s.subscribe("AdVolumeAvailabilityStateChange",()=>{this.updateAdVolumeAvailabilityStateChange(s)}),await new Promise(e=>{s.subscribe("AdStopped",e),s.playAd(),this.params.onAdPodPlayingStateChange({adType:t,playingState:jm.BUFFERING,expectedStalledReason:0===this.adPodIndex?Hm.AdStart:Hm.AdBetween})}),this.currentAdPlaybackController=void 0,this.params.onAdPodEnd({adPodIndex:this.adPodIndex+1,adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:r}),t===Ym.inroll&&(this.params.onInrollAdPodEnd({adPodsCount:this.playbackQueue.length,cueId:r.cueId}),i.setStatsRootFields({cueid:void 0}))},this.addDestroyHandler(()=>{this.currentAdPlaybackController&&(this.currentAdPlaybackController.stopAd(),this.currentAdPlaybackController=void 0)})}playAdViewers(e){this.isDestroyed||(this.playbackQueue.push(e),this.addDestroyHandler(()=>{e.adViewer.destroy()}),Promise.resolve().then(()=>this.startPlayingAd()))}resumeAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.resumeAd(),this.updateAdPodPlayingStateChange())}pauseAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.pauseAd(),this.updateAdPodPlayingStateChange())}skipAdPod(){this.currentAdPlaybackController&&this.currentAdPlaybackController.skipAd()}setVolume(e){this.currentAdPlaybackController&&this.currentAdPlaybackController.setAdVolume(e)}getDestroyPromise(){return this.destroyPromise}getAdTypeForLogs(){const[e]=this.playbackQueue;return e?e.adType:(this.params.onUnrecognizedAdType(),"unrecognized")}updateAdPodPlayingStateChange(){if(!this.currentAdPlaybackController)return;const e=this.currentAdPlaybackController.getAdMediaState(),t=this.currentAdPlaybackController.getAdPlayingState(),i=this.playbackQueue[this.adPodIndex].adPodType,r=this.params.video.src,n="stalled"===(null==e?void 0:e.name)&&r?{adType:i,playingState:jm.BUFFERING,expectedStalledReason:Hm.AdOther}:{adType:i,playingState:$m[t],expectedStalledReason:void 0};"pause"===t&&"pause"!==this.previousAdPlayingState&&this.params.onAdPodPause({adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adType,adPodIndex:this.adPodIndex+1,additionalData:this.playbackQueue[this.adPodIndex].additionalData}),"play"===t&&"pause"===this.previousAdPlayingState&&this.params.onAdPodResume({adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adType,adPodIndex:this.adPodIndex+1,additionalData:this.playbackQueue[this.adPodIndex].additionalData}),this.params.onAdPodPlayingStateChange(n),this.previousAdPlayingState=t}updateAdPodDuration(e){const t=jl(e.getAdPodDuration());return this.params.onAdPodDurationChange(t),t}shouldSkipAllAdPods(){var e;return Boolean(null==(e=this.params.adConfig)?void 0:e.skipAllAdPods)||this.params.isSkipAllPodsFlagEnabled||!1}getContentAfterAd(e,t){const i=this.playbackQueue.length-1===this.adPodIndex,r=this.shouldSkipAllAdPods(),n=t?[{url:t}]:[];switch(e){case Ym.preroll:return i||r?{type:"startVideo",poster:n}:{type:"nextAd",poster:[]};case Ym.postroll:return{poster:[]};case Ym.midroll:case Ym.postPauseroll:case Ym.inroll:return i||r?{type:"continueVideo",poster:n}:{type:"nextAd",poster:[]};default:return{poster:[]}}}}class tA{constructor(){this.handlers=Object.create(null),this.onceHandlers=Object.create(null),this.maxEventListeners=10}setMaxListeners(e){!isFinite(e)||e<=0||(this.maxEventListeners=e)}on(e,t){this.getHandlers(e).push(t),this.checkSubscriptions(e)}once(e,t){this.getOnceHandlers(e).push(t),this.checkSubscriptions(e)}off(e,t){const i=this.getHandlers(e),r=this.getOnceHandlers(e);if(void 0===t)return i.length=0,void(r.length=0);this.removeHandler(t,i),this.removeHandler(t,r)}emit(e,t){const i=this.getHandlers(e),r=this.getOnceHandlers(e).slice();this.getOnceHandlers(e).length=0,i.slice().concat(r).forEach(e=>{try{e(t)}catch(kE){setTimeout(()=>{throw kE},0)}})}getHandlers(e){return void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e]}getOnceHandlers(e){return void 0===this.onceHandlers[e]&&(this.onceHandlers[e]=[]),this.onceHandlers[e]}checkSubscriptions(e){const t=this.getHandlers(e).length+this.getOnceHandlers(e).length;t>this.maxEventListeners&&console.warn("There are "+t+" subscriptions on event named "+String(e))}removeHandler(e,t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}let iA=function(e){return e.original="original",e}({});class rA{constructor(e,t){this.parent=e,this.element=document.createElement("div");const{style:i}=this.element;i.backgroundColor=function(e){switch(e){case iA.original:return"rgba(0, 255, 0, 0.5)";default:throw new Error("Unexpected BroadcastAdType ["+e+"]")}}(t),i.width="10px",i.height="10px",i.cssFloat="left",i.marginRight="1px"}setVisibility(e){e?this.show():this.hide()}show(){this.parent.appendChild(this.element)}hide(){_(this.element)}}class nA{constructor(e){this.element=document.createElement("div"),e.appendChild(this.element);const{style:t}=this.element;t.position="absolute",t.bottom="1px",t.left="1px"}createIndicator(e){return new rA(this.element,e)}}const oA=Gl(1e3),aA=Gl(6e5);let sA=function(e){return e.INVALID_INROLL_FRAME="INVALID_INROLL_FRAME",e.INVALID_START="INVALID_START",e.CROSSED_BY_INVALID="CROSSED_BY_INVALID",e.MAX_DURATION="MAX_DURATION",e}({});const lA=Gl(5e3),dA=Gl(1e4),cA=Kl(aA,ql(dA,3)),uA=Gl(-aA);class hA extends tA{constructor(e){super(),this.logger=e,this.adIntervals=[]}handleInrollFrame(e){var t;if(!function(e){if(e.offset<uA||e.offset>cA)return!1;if(void 0===e.cutoff)return!0;if(e.cutoff<uA||e.cutoff>cA)return!1;const t=e.cutoff-e.offset;return t>=lA&&t<=aA}(e))return null==(t=this.logger)||t.warn("invalid inroll frame:",e),void this.handleInvalidInrollFrame(e,sA.INVALID_INROLL_FRAME);const i=this.adIntervals.find(t=>{let{cueId:i}=t;return i===e.cue_id});if(!i)return this.addAdIntervalByFastFrame(e);this.updateAdIntervalByInrollFrame(i,e)}validateAdIntervalsByTimestamp(e){for(let t=0;t<this.adIntervals.length;t++){const i=this.adIntervals[t];if(i.start>e)return;if(!i.isValid||i.isEndReceived)continue;if(e-i.start>aA){this.invalidateAdInterval(i,sA.MAX_DURATION);continue}const r=this.adIntervals[t+1];if(!r)return;r.start<=e&&this.invalidateAdInterval(i,sA.CROSSED_BY_INVALID)}}handleInvalidInrollFrame(e,t){const i=this.adIntervals.find(t=>{let{cueId:i}=t;return i===e.cue_id});if(i)return this.invalidateAdInterval(i,t),void this.updateAdIntervalByInrollFrame(i,e);const r=Oa(e);this.invalidateAdInterval(r,t),this.pushAdInterval(r)}addAdIntervalByFastFrame(e){const t=Oa(e);return this.pushAdInterval(t),t.isValid?t:void 0}updateAdIntervalByInrollFrame(e,t){const i=t.pts+t.offset;if(Math.abs(e.start-i)>oA)return void this.invalidateAdInterval(e,sA.INVALID_START);if(e.isEndReceived)return;const r=void 0!==t.cutoff,n=r?Kl(t.pts,t.cutoff):Ca(t.pts,e.start);e.isEndReceived=r,e.end=n,this.handleUpdatedAdInterval(e)}findCrossedAdIntervals(e){return this.adIntervals.filter(t=>e!==t&&(e.start<t.start?e.end>t.start:t.end>e.start))}pushAdInterval(e){const t=this.findCrossedAdIntervals(e);t.length&&this.invalidateAdInterval(e,sA.CROSSED_BY_INVALID),this.adIntervals.push(e),this.adIntervals.sort((e,t)=>{let{start:i}=e,{start:r}=t;return i-r}),this.invalidate(t,sA.CROSSED_BY_INVALID),e.isValid&&this.emit("AdIntervalUpdated",e)}handleUpdatedAdInterval(e){const t=this.findCrossedAdIntervals(e);if(t.length)return t.push(e),void this.invalidate(t,sA.CROSSED_BY_INVALID);e.isValid&&this.emit("AdIntervalUpdated",e)}invalidate(e,t){e.forEach(e=>{this.invalidateAdInterval(e,t)})}invalidateAdInterval(e,t){e.isValid&&(e.isValid=!1,e.invalidateReason=t,this.emit("InvalidAdInterval",{reason:t,cueId:e.cueId}))}}class pA{constructor(){this.ads=[],this.postAdsIds=[]}add(e){if(this.postAdsIds.indexOf(e.cueId)>-1)return;const t=this.findById(e.cueId);t?t.startTime=e.startTime:this.ads.push(wa({},e,{adViewers:e.adViewers.reduce((e,t)=>e.concat(t.separateAdPods()),[])}))}getAdViewers(e,t){const[i,r]=Si(this.ads,i=>{let{startTime:r,endTime:n,cueId:o,adViewers:a}=i;if(o!==t)return!1;if(e<r)return!1;if(n-1e3*ip<e)return!1;for(const t of a){if(e+1e3*t.getAdDuration()<n)return!0}return!1});if(0===i.length)return[];this.postAdsIds.push(...i.map(e=>{let{cueId:t}=e;return t})),this.ads=r,i.sort((e,t)=>e.startTime-t.startTime);let n=jl(0);const o=[];for(const{adViewers:a,endTime:s,cueId:l}of i)for(const t of a){const i=Kl(e,ql(n,1e3));if(s-1e3*ip<i)break;s<Kl(i,ql(t.getAdDuration(),1e3))||(o.push({adViewer:t,additionalData:{cueId:l},adType:Ym.inroll}),n=Kl(n,jl(t.getAdDuration())))}return o}findById(e){return this.ads.find(t=>{let{cueId:i}=t;return i===e})}}class fA extends tA{constructor(e,t,i,r,n,o,a){let s;super(),this.getCueId=i,this.getUtcPositionMs=r,this.getMultiroll=n,this.onInvalidMetadata=o,this.logger=a,this.adIntervalStorage=void 0,this.isEnabled=!0,this.adIndicators=void 0,this.inrolls=new pA,this.adIntervalStorage=new hA(this.logger),this.adIndicators=new nA(t);const l=this.adIndicators.createIndicator(iA.original);e.addEventListener("timeupdate",()=>{const t=this.getCueId();if(s!==t){const e=void 0!==t;l.setVisibility(e),s=t}const i=this.getUtcPositionMs();i&&(this.adIntervalStorage.validateAdIntervalsByTimestamp(i),this.isEnabled&&!e.paused&&(this.emit("BeforeInrollHandle"),this.handleInrolls()))}),this.adIntervalStorage.on("AdIntervalUpdated",e=>{this.emit("AdIntervalUpdated",{cueId:e.cueId,start:e.start,end:e.end})}),this.adIntervalStorage.on("InvalidAdInterval",e=>{var t;let{cueId:i,reason:r}=e;null==(t=this.logger)||t.warn("invalid ad interval: [cueId="+i+"] [reason="+r+"]"),this.onInvalidMetadata({cueId:i,reason:r}),this.emit("AdIntervalRemoved",i)})}handleInrollFrame(e){const t=this.adIntervalStorage.handleInrollFrame(e);if(!t)return Promise.resolve();const{cueId:i,start:r,end:n,isEndReceived:o}=t,a=o?n+1e3*ip:r+aA;return this.addInroll(i,r,Gl(a),{inrollFrame:e})}setEnabled(e){this.isEnabled=e}async addInroll(e,t,i,r){let{inrollFrame:n}=r;this.emit("BroadcastAdReceived",{cueId:e,podStart:t,adType:Ym.inroll});const o=this.getMultiroll(),a=await o.inroll.loadViewers(ka({},n));if(0===a.length)return;const s=ba(a);this.emit("BroadcastAdInit",{cueId:e,podStart:t,duration:s,adPodsCount:a.length,adType:Ym.inroll}),this.inrolls.add({adViewers:a,cueId:e,startTime:t,endTime:i})}handleInrolls(){const e=this.getUtcPositionMs();if(!e)return;const t=this.getCueId();if(!t)return;const i=this.inrolls.getAdViewers(e,t);i.length&&this.emit("InrollAdPlayRequest",i)}}class gA extends tA{constructor(e){super(),this.config=e,this.adman=void 0,this.multiroll=Xm,this.plannedAdViewers=[],this.timer=void 0,this.broadcastAd=void 0,this.currentAdPlaybackQueue=void 0,this.stopAd=()=>Promise.resolve(),this.playAdViewers=async(e,t,i,r,n)=>{try{await this.playAdViewersInternal(e,t,i,r,n)}catch(kE){this.emit("PlayAdViewersError",{error:kE,adType:e,adViewersWithData:t,adDisplayConfig:i})}},this.playAdViewersInternal=async(e,i,r,n,o)=>{const a=this.config.getAdInfo(),s=this.config.getControllerIsFullscreen(),l=this.config.getControllerIsPip(),d=s&&Aa(this.config.getPlayerContainerDocument().defaultView,this.config.playerVideoElement)===this.config.playerVideoElement,c=d||l?i.filter(e=>{const{adViewer:t}=e;return t.filterAdPodsIndependentOnHtmlControls("StreamPlayer can't play CPC ads: ["+(l?"PiP":d?"FullScreen":"unknown")+"] mode"),t.getAdPodsCount()>0}):i,u=c.map(e=>{let{adViewer:t}=e;return t}),h=function(e){return e.reduce((e,t)=>Kl(e,x(t.getAdPodsCount())),x(0))}(u),p=ba(u);if(0===h)return void this.emit("NoAdPodsToPlayAd");a&&this.emit("AdIsAlreadyPlayingError",{currentAdType:a.adType,adType:e}),this.prepareBeforeOrAfterAd(!1,e),this.emit("PlayAdViewers",{adType:e,adPodsCount:h,isDelayed:o});const f=e===Ym.inroll?{cueId:this.config.getAdOriginalBroadcastAdCueId(),startProgramDateTime:jl(this.config.getControllerProgramDateTime()/1e3),startVideoTime:jl(this.config.getVideoControllerCurrentTime()||this.config.getControllerCurrentTime()),startTimestamp:jl(Date.now()/1e3)}:{};let g=!1;const v=U(async i=>{let{data:r,stopAdReason:n}=i;var o,a;this.config.shouldCaptureScreenshot()&&(this.config.resetPosterFitStyle(),this.config.setBackgroundVisibility(!0),null==(o=(a=this.config).onceCanPlay)||o.call(a,()=>{this.config.setBackgroundImage(),this.config.clearVideoControllerScreenshot()}));const s=this.config.getInStreamPlayingState();g=!0,this.currentAdPlaybackQueue&&(this.currentAdPlaybackQueue.destroy(n),this.currentAdPlaybackQueue=void 0),e!==Ym.postroll&&(this.config.logger.log("videoController.play()"),s!==jm.PAUSE&&t(this.config.playVideoController())),this.config.updateAdInfo(void 0),this.config.callbacks.onExpectedStalledChange(this.config.createExpectedStalled(Hm.AdEnd,{adType:e})),this.prepareBeforeOrAfterAd(!0,e);const l=async()=>{await this.config.attachEncoder()};if(n===Bm.InsertIntoCalled)return l();const{loadPositionAfterAd:d}=r;d&&(this.config.putStartPosition(d),await l())});this.stopAd=v;const m=this.getSeekPositionAfterAd({adType:e,adViewersDuration:p});if(this.config.putStartPosition(m),this.config.shouldCaptureScreenshot()&&this.config.captureVideoControllerScreenshot(this.config.playerVideoElement).then(e=>{e&&(this.config.setBackgroundImage(e),this.config.setBackgroundVisibility(!1))}),await this.config.detachEncoder(),(()=>{this.config.updateAdInfo({adType:e,params:f})})(),g)return;const A=this.createAbPlaybackQueue(e);this.currentAdPlaybackQueue=A,c.forEach(t=>{let{adViewer:i,additionalData:o,adType:a}=t;A.playAdViewers({adType:e,adPodType:a,adViewer:i,additionalData:o,adDisplayConfig:r,adElement:n.adProvider===Wm.MT?this.config.playerAdVideo:this.config.playerAdDiv,posterUrl:this.getPosterUrlForAd()})}),this.plannedAdViewers=[],await A.getDestroyPromise(),g||await v({stopAdReason:Bm.AdCompleted,data:{loadPositionAfterAd:m}})}}getConfig(){return this.config}getCurrentAdPlaybackQueue(){return this.currentAdPlaybackQueue}getAdman(){return this.adman}getTimer(){return this.timer}getPlannerAdViewers(){return this.plannedAdViewers}getBroadcastAd(){return this.broadcastAd}planAdViewers(e){this.plannedAdViewers=e}resetPlannedAdViewers(){this.plannedAdViewers=[]}getMultiroll(){return this.multiroll}resetMultiroll(){this.multiroll=Xm}destroy(){this.multiroll.destroy()}skipAdmanAd(){var e,t;null==(e=this.getAdman())||e.skip(),null==(t=this.getTimer())||t.setSkipAdTime(Number.POSITIVE_INFINITY)}stopAdmanAd(){var e,t;null==(e=this.getAdman())||e.stop(),null==(t=this.getTimer())||t.setSkipAdTime(Number.POSITIVE_INFINITY)}getUtcPosition(){return this.config.getVideoControllerUtcPosition()}getSeekPositionAfterAd(e){let{adType:t,adViewersDuration:i}=e;const r=this.getUtcPosition();if(t===Ym.inroll){const e=Kl(this.config.getControllerCurrentTime(),i);return{utc:r?Kl(r,i):void 0,videoTime:e}}return t===Ym.preroll?this.config.getControllerStartPosition():t===Ym.midroll||t===Ym.postPauseroll?{utc:jl(r)||void 0,videoTime:jl(this.config.getVideoControllerCurrentTime()||0)}:t===Ym.postroll?{videoTime:jl(0)}:{}}getPosterUrlForAd(){const e=this.config.getControllerSourcePreviewParam();return e&&e!==this.config.getDefaultSourcePreviewParam()?e:null}createAbPlaybackQueue(e){let t=!1;return new eA({video:this.config.playerVideoElement,onUnrecognizedAdType:()=>{this.emit("UnrecognizedAdTypeError")},onAdStartRejected:e=>{this.config.rejectPlayerPlayDeferred(e)},onAdSkippableStateChange:e=>{this.config.callbacks.onAdSkippableStateChange(e)},onAdPodCloseStateChange:e=>{this.config.callbacks.onAdPodCloseStateChange(e)},onAdVolumeAvailabilityStateChange:e=>{this.config.callbacks.onAdVolumeAvailabilityStateChange(e)},onAdPodError:e=>{let{code:t,additionalData:i,adPodIndex:r,adPodsCount:n,adType:o}=e;this.config.callbacks.onAdError(),this.emit("AdPodError",{code:t,additionalData:i,adPodsCount:n,adType:o,adPodIndex:r,adProvider:Wm.DIRECT})},onAdPodDurationChange:e=>{this.config.callbacks.onAdPodDurationChange(e)},onAdPodCurrentTimeChange:e=>{this.config.callbacks.onAdPodCurrentTimeChange(e)},onAdPodTimeToSkipChange:e=>{this.config.callbacks.onAdPodTimeToSkipChange(e)},onAdInteraction:()=>{this.config.callbacks.onAdInteraction()},onFirstAdPodStarted:()=>{this.config.hidePlayerPoster(),e!==Ym.postroll&&this.config.preloadVideoControllerSource(),this.config.resolvePlayerPlayDeferred()},onLastAdPodStopped:e=>{this.multiroll.dispatchEvent({event:"AdBreakEnd",data:e})},onBeforeAdPodStart:e=>{this.config.callbacks.onBeforeAdPodStart(e)},onAdPodStarted:e=>{let{isFullyClickable:t,adPodDuration:i,adPodIndex:r,adPodsCount:n,adType:o,additionalData:a,width:s,height:l}=e;this.emit("AdPodStart",{adPodIndex:r,adPodsCount:n,adType:o,additionalData:a,isFullyClickable:t||!1,adPodDuration:i,width:s,height:l,adProvider:Wm.DIRECT}),this.config.putResourcesIdle(!0),this.config.callbacks.onAdPodStart({isFullyClickable:t,adPodDuration:i})},onAdPodSkipped:e=>{let{adPodsCount:t,adType:i,adPodIndex:r,additionalData:n}=e;this.config.callbacks.onAdPodSkip(),this.emit("AdPodSkip",{adPodsCount:t,adType:i,adPodIndex:r,additionalData:n,adProvider:Wm.DIRECT})},onAdPodStopped:()=>{t=!0,this.config.putInStreamPlayingState(void 0),this.config.callbacks.onAdPodEnd()},onAdPodPlayingStateChange:e=>{let{playingState:t,expectedStalledReason:i,adType:r}=e;t===jm.BUFFERING&&this.config.callbacks.onExpectedStalledChange(this.config.createExpectedStalled(i,{adType:r})),this.config.putInStreamPlayingState(t)},onAdClickThru:e=>{let{adPodIndex:t,adPodsCount:i,adType:r,additionalData:n}=e;this.config.callbacks.onAdPodClick(),this.emit("AdClickThru",{adPodIndex:t,adPodsCount:i,adType:r,additionalData:n,adProvider:Wm.DIRECT})},onAdSizeChange:e=>{this.config.putVideoSize({videoWidth:Yl(void 0===e.width?NaN:e.width),videoHeight:Yl(void 0===e.height?NaN:e.height)})},getControlsSettings:this.config.getAdControlsSettings,adConfig:this.config.getAdConfig(),playerContainer:this.config.getPlayerContainer(),lang:this.config.lang,yaDirectPixel:this.preparePixelData(),logger:this.config.logger,isSkipAllPodsFlagEnabled:this.config.isSkipAllPodsFlagEnabled,onAdStart:e=>{let{adPodsCount:t,adType:i}=e;this.emit("AdStart",{adProvider:Wm.DIRECT,adPodsCount:t,adType:i})},onInrollAdStart:e=>{let{adPodsCount:t}=e;this.emit("InrollAdStart",{adPodsCount:t})},onAdEnd:e=>{let{adPodsCount:t,adType:i,stopAdReason:r}=e;this.emit("AdEnd",{stopAdReason:r,adPodsCount:t,adType:i,adProvider:Wm.DIRECT})},onInrollAdEnd:e=>{let{adPodsCount:t}=e;this.emit("InrollAdEnd",{adPodsCount:t})},onAdPodPause:e=>{let{adType:t,adPodIndex:i,adPodsCount:r,additionalData:n}=e;this.emit("AdPodPause",{adType:t,adPodsCount:r,adPodIndex:i,additionalData:n})},onAdPodResume:e=>{let{adType:t,adPodIndex:i,adPodsCount:r,additionalData:n}=e;this.emit("AdPodResume",{adType:t,adPodsCount:r,adPodIndex:i,additionalData:n})},onAdPodLoading:e=>{let{adType:t,adPodsCount:i,additionalData:r}=e;this.emit("AdPodLoading",{adPodsCount:i,adType:t,additionalData:r})},onInrollAdPodStart:e=>{let{adPodsCount:t,cueId:i}=e;this.emit("InrollAdPodStart",{adPodsCount:t,cueId:i})},onAdPodImpression:e=>{let{adPodsCount:t,adType:i,additionalData:r}=e;this.emit("AdPodImpression",{adPodsCount:t,adType:i,additionalData:r})},onAdPodEnd:e=>{let{adPodIndex:t,adPodsCount:i,adType:r,additionalData:n}=e;this.emit("AdPodEnd",{adProvider:Wm.DIRECT,adPodIndex:t,adPodsCount:i,adType:r,additionalData:n})},onInrollAdPodEnd:e=>{let{adPodsCount:t,cueId:i}=e;this.emit("InrollAdPodEnd",{adPodsCount:t,cueId:i})}})}preparePixelData(){const{yaDirectPixelUrl:e,yaDirectPixelData:t}=this.config.yaDirectPixel||{};if(e&&t)return{url:e,data:Da({},t,{containerId:t.containerId||this.config.playerContainerElement.id,pageId:this.config.adConfigPartnerId,impId:this.config.adConfigImpId})}}async initMultirollModule(e,i){let r=Xm;if(!e)return r;switch(e.adProvider){case Wm.MT:try{var n,o,a,s,l,d,c,u,h,f;if(this.config.isIOS&&!this.config.isMyTargetOnIOSEnabled)break;const g=localStorage.getItem("zen-player-mytarget-testmode"),v=Da({duration:Math.floor(e.duration||this.config.getVideoControllerDuration()),group_id:e.statId||e.partnerId,video_id:e.videoContentId,content_id:e.mytargetId,autoplay:this.config.getControllerAutoplay(),genre:e.videoGenreName,live:this.config.getPlayerIsLive()?1:0,brandsafety:"yanewstragic"===this.config.getControllerFrom()?1:0},this.config.admanMeta,{preview:g?4:void 0,SkipAd:g?1:void 0}),m=e.adStatType&&e.adStatType!==Gm.PIXEL?void 0:this.preparePixelData(),A=Pa(window,e,this.config.getControllerVsid(),!0,this.config.playerVersion,{slot:e.slotId,wrapper:this.config.playerAdMtDiv,videoEl:this.config.playerAdVideo,audioEl:this.config.playerAdVideo,clickEl:this.config.playerDiv,midrollPoints:g?[10]:void 0,forcePreloadAdditionalData:!0,params:g?Da({},v,{test_mode:1}):v,browser:{adBlock:!1,mobile:!1}},m),E=await Promise.race([A,i.stopPromise.then(()=>{})]);if(void 0===E)return r;let y;this.adman=E,this.timer=zm.createInstance(this.adman,Math.floor(e.duration||this.config.getVideoControllerDuration()),this),null==(n=this.adman)||n.onReady(e=>{var t;null==(t=this.timer)||t.start()}),null==(o=this.adman)||o.adMidrollPoint(e=>{var t,i;this.config.shouldPlayAd()&&(m&&Km(m.url,Da({},m.data,{eventUnixTime:Math.floor(Date.now()/1e3),eventType:"ads_rendered",inventory:"instream",count:void 0,bidReqId:void 0})),this.config.callbacks.onAdLoaded({adType:Ym.midroll}),null==(t=this.adman)||t.start(qm.MIDROLL),this.config.hasPlayerVideoController()&&(this.config.playerAdVideo.style.display="block",this.config.pauseVideoController(),this.config.updateAdInfo({adType:Ym.midroll,params:{}})),null==(i=this.adman)||i.setVolume(this.config.getControllerMuted()?0:.7*this.config.getControllerVolume()))}),null==(a=this.adman)||a.onTimeRemained(e=>{var t;null==(t=this.adman)||t.setVolume(this.config.getControllerMuted()?0:.7*this.config.getControllerVolume()),this.config.callbacks.onAdPodCurrentTimeChange(jl(e.currentTime))});let S=!1;if(null==(s=this.adman)||s.onStarted((t,i)=>{var r;(S=!1,y=Zm[i.type],this.emit("AdStart",{adProvider:Wm.MT,adPodsCount:0,adType:y}),this.emit("AdPodStart",{adPodsCount:0,adPodIndex:-1,adType:y,adProvider:Wm.MT,additionalData:{},isFullyClickable:!0,adPodDuration:jl(i.duration),width:i.width||0,height:i.height||0}),this.config.playerVideoElement.style.opacity="0",this.config.putShowAdSkin(!0),this.config.callbacks.onAdPodStart({isFullyClickable:!0,adPodDuration:jl(i.duration)}),this.config.callbacks.onAdVolumeAvailabilityStateChange(!0),this.config.callbacks.onAdPodDurationChange(jl(i.duration)),this.config.toggleVideoControllerAdShown(!0),this.config.hidePlayerPoster(),this.config.preloadVideoControllerSource(),this.config.resolvePlayerPlayDeferred(),this.config.putResourcesIdle(!0),i.duration>6&&i.allowClose&&i.allowCloseDelay&&!e.hideAdControls)&&(null==(r=this.timer)||r.setSkipAdTime(i.allowCloseDelay),this.config.putShowSkipAdButton(!0))}),null==(l=this.adman)||l.onClicked(()=>{this.emit("AdClickThru",{adType:y||Ym.midroll,adPodsCount:0,additionalData:{},adPodIndex:-1,adProvider:Wm.MT})}),null==(d=this.adman)||d.onCompleted(()=>{var e;this.config.hasPlayerVideoController()&&(this.config.playerAdVideo.style.display="none",this.config.playerVideoElement.style.opacity="1",this.config.toggleVideoControllerAdShown(!1),this.config.playVideoController(),this.config.callbacks.onAdPodTimeToSkipChange(jl(Number.POSITIVE_INFINITY)),null==(e=this.timer)||e.setSkipAdTime(Number.POSITIVE_INFINITY),this.config.putShowSkipAdButton(!1),this.config.putShowAdSkin(!1),this.config.callbacks.onAdVolumeAvailabilityStateChange(!1),this.config.updateAdInfo(void 0));this.emit("AdPodEnd",{adProvider:Wm.MT,adPodIndex:-1,adPodsCount:0,adType:y||Ym.midroll,additionalData:{}}),this.emit("AdEnd",{adType:y||Ym.midroll,adPodsCount:0,adProvider:Wm.MT,stopAdReason:S?Bm.AdSkipped:Bm.AdCompleted})}),null==(c=this.adman)||c.onSkipped(()=>{var e;(S=!0,this.config.hasPlayerVideoController())&&(this.config.playerAdVideo.style.display="none",this.config.playerVideoElement.style.opacity="1",this.config.toggleVideoControllerAdShown(!1),this.config.playVideoController(),this.config.callbacks.onAdPodTimeToSkipChange(jl(Number.POSITIVE_INFINITY)),null==(e=this.timer)||e.setSkipAdTime(Number.POSITIVE_INFINITY),this.config.putShowSkipAdButton(!1),this.config.putShowAdSkin(!1),this.config.callbacks.onAdVolumeAvailabilityStateChange(!1),this.config.updateAdInfo(void 0));this.emit("AdPodSkip",{adType:y||Ym.midroll,adPodIndex:-1,adPodsCount:0,adProvider:Wm.MT,additionalData:{}})}),null==(u=this.adman)||u.onClosed(()=>{this.emit("AdEnd",{adType:y||Ym.midroll,adPodsCount:0,adProvider:Wm.MT,stopAdReason:Bm.AdSkipped})}),null==(h=this.adman)||h.onError(e=>{m&&Km(m.url,Da({},m.data,{eventUnixTime:Math.floor(Date.now()/1e3),eventType:"ads_render_failed",inventory:"instream",count:void 0,bidReqId:void 0})),e&&(this.config.logger.log("Adman error:"+e),this.config.callbacks.onAdError(),this.emit("AdPodError",{adPodIndex:-1,adPodsCount:0,adType:y||Ym.midroll,additionalData:{},code:e,adProvider:Wm.MT}))}),t(i.stopPromise.then(()=>{var e;return null==(e=this.adman)?void 0:e.destroy()})),r={destroy:null==(f=this.adman)?void 0:f.destroy,setStatsRootFields:p,dispatchEvent:p,getNextAdInfo:()=>{var e;return{adType:Ym.midroll,additionalData:{},remainingTime:null==(e=this.timer)?void 0:e.getNextAdTime()}},preroll:{loadViewers:()=>Promise.resolve([])},midroll:{loadViewers:()=>Promise.resolve([])},inroll:{loadViewers:()=>Promise.resolve([]),schedule:p},postroll:{loadViewers:()=>Promise.resolve([])},postPauseroll:{loadViewers:()=>Promise.resolve([])}},e.adStatType===Gm.WATERFALL){const t=async function(e,t,i,r){var n;void 0===e&&(e=window);const o=Qm({serviceName:"player",serviceVersion:r,vasLoaderUrl:Jm,config:_a({},t,{additionalCustomRootFields:{vsid:i,contentPlayerVersion:r,testIds:null==(n=t.additionalParams)?void 0:n.slots}}),win:e,moduleName:"Multiroll"}).promise;return o.catch(p),o}(window,Da({},e,{partnerId:1798264,duration:v.duration}),this.config.getControllerVsid(),this.config.playerVersion),r=await Promise.race([t,i.stopPromise.then(()=>{})]),{loadMultiroll:n}=r;n(Da({},e,{partnerId:1798264,duration:v.duration,secureMode:"Safe",getSTRMChunkHost:()=>{const e=this.config.getSTRMChunkUrls();if(0===e.length)return;const{hostname:t,protocol:i}=mt(e[0]);return i+"//"+t+"/"}}),{preroll:{shouldPreload:()=>!1},midroll:{preloadOffset:20,preloadMinTime:jl(5)},postroll:{preloadOffset:20,preloadMinTime:jl(5)},getPreloadParams:()=>{const e={videoSlot:this.config.playerVideoElement};if(!this.config.hasPlayerVideoController()||!this.config.getNextAdInfo())return e;const t=this.config.getVideoControllerBandwidthEstimate();return t.value?Da({},e,{desiredBitrate:t.value/1e3}):e},adLoaded:()=>null}),setTimeout(()=>{var e;return null==(e=document.querySelector("script[src='"+Jm+"']"))?void 0:e.remove()},1e3)}}catch(kE){location.href.includes("dzen.ru/news")||(this.config.callbacks.onAdError(),this.emit("MultirollInitError",{error:kE,adConfig:e}))}break;case Wm.DIRECT:default:try{const n=Pa(window,e,this.config.getControllerVsid(),!1,this.config.playerVersion,{},e.adStatType&&e.adStatType!==Gm.PIXEL?void 0:this.preparePixelData()),o=await Promise.race([n,i.stopPromise.then(()=>{})]);if(void 0===o)return r;const{loadMultiroll:a}=o,s={adSdkVersion:ya(window),adSdkLoaderVersion:Ea(window)};this.config.callbacks.onAdSDKVersionDefined(s);const l=a(Da({},e,{secureMode:"Safe",getSTRMChunkHost:()=>{const e=this.config.getSTRMChunkUrls();if(0===e.length)return;const{hostname:t,protocol:i}=mt(e[0]);return i+"//"+t+"/"}}),{preroll:{shouldPreload:()=>{const e=this.config.getControllerStartStage();return this.config.getControllerPreload()&&(e===Um.waitForUserPlay||e===Um.waitForDocumentVisibility)}},midroll:{preloadOffset:20,preloadMinTime:jl(5)},postroll:{preloadOffset:20,preloadMinTime:jl(5)},getPreloadParams:()=>{const e={videoSlot:this.config.playerVideoElement};if(!this.config.hasPlayerVideoController()||!this.config.getNextAdInfo())return e;const t=this.config.getVideoControllerBandwidthEstimate();return t.value?Da({},e,{desiredBitrate:t.value/1e3}):e},adLoaded:e=>{let{adBreakType:t}=e;const i=(()=>{switch(t){case Ym.preroll:return Ym.preroll;case Ym.midroll:return Ym.midroll;case Ym.postroll:return Ym.postroll;case Ym.inroll:return Ym.inroll;case Ym.postPauseroll:return Ym.postPauseroll}})();void 0!==i&&this.config.callbacks.onAdLoaded({adType:i})}});t(i.stopPromise.then(()=>l).then(e=>e.destroy()));const d=await Promise.race([l,i.stopPromise.then(()=>{})]);if(void 0===d)return r;r=d}catch(kE){this.config.callbacks.onAdError(),this.emit("MultirollInitError",{error:kE,adConfig:e})}}return this.multiroll=r,r}prepareBeforeOrAfterAd(e,t){this.broadcastAd&&t!==Ym.inroll&&this.broadcastAd.setEnabled(e)}initBroadcastAd(){var e,t;const{playerVideoElement:i}=this.config;if(this.broadcastAd=new fA(i,i.parentElement,()=>this.config.getCueId(),()=>this.config.getUtcPositionMs(),this.getMultiroll,e=>{this.emit("InvalidMetadataError",e)},this.config.logger),this.config.getVideoControllerVideoEngine()===Fm.NATIVE){let e=0;i.addEventListener("timeupdate",()=>{const{currentTime:t}=i;this.config.getPlayerIsLive()&&t<e&&this.broadcastAd&&this.config.putOriginalBroadcastAdCues({}),e=t})}null==(e=(t=this.config).onMetadataChange)||e.call(t,e=>{const{fragmentMetadataArray:t,fragmentStart:i}=e;if(this.config.logger.log("receive metadata: ",t),!this.broadcastAd)return;const r=this.config.getControllerProgramDateTime();if(void 0===r)return;const n=Kl(r,ql(i,1e3));let o;Math.random()<this.config.getMinimalChance()&&this.emit("ReceivedMetadata",e),t.forEach(e=>{try{const t=JSON.parse(e);if(!function(e){return I(e)&&d(e.cue_id)&&B(e.offset)}(t))return;o=Da({},t,{pts:n})}catch(t){this.config.logger.log("metadata is not valid ["+e+"]")}}),o&&this.broadcastAd.handleInrollFrame(o).catch(e=>{this.config.logger.error(e),this.emit("BroadcastAdBlockInitError",{error:e,metadata:{cueId:o.cue_id,podStart:n+o.offset}})})}),this.broadcastAd.on("AdIntervalRemoved",e=>{this.emit("AdIntervalRemoved",e)}),this.broadcastAd.on("AdIntervalUpdated",e=>{this.emit("AdIntervalUpdated",e)}),this.broadcastAd.on("InrollAdPlayRequest",e=>{this.emit("InrollAdPlayRequest",e),this.playAdViewers(Ym.inroll,e,{},{})}),this.broadcastAd.on("BeforeInrollHandle",()=>{this.emit("BeforeInrollHandle")}),this.broadcastAd.on("BroadcastAdReceived",e=>{this.emit("BroadcastAdReceived",e)}),this.broadcastAd.on("BroadcastAdInit",e=>{this.emit("BroadcastAdInit",e)})}}const vA=(e,t)=>{for(const i of t.split(".")){if(!I(e)){e=void 0;break}e=e[i]}return e},mA="__ADB_CONFIG__",AA=I(mA)&&mA.fn&&n(mA.fn.encodeUrl)?mA.fn.encodeUrl:void 0,EA=void 0!==AA?e=>AA(e):void 0,yA=function(e){if(void 0===e&&(e=window),EA)return EA;const t=hg(e);for(;t.length;){const e=t.pop();if(!e)continue;const i=vA(e,"ya.videoAd.encodeUrl");if(n(i))return i}}(window),SA={vast:'<?xml version="1.0" encoding="utf-8"?>\n<VAST version="2.0">\n    <Ad id="0">\n        <InLine>\n            <AdSystem>AWAPS</AdSystem>\n            <AdTitle>Advertising</AdTitle>\n            <Survey>http://www.yandex.ru</Survey>\n\n            <Creatives>\n                <Creative id="2120833">\n                    <Linear skipoffset="00:00:05">\n                        <Duration>00:00:20</Duration>\n                        <VideoClicks>\n                            <ClickThrough id="AW"><![CDATA[https://yandex.ru]]></ClickThrough>\n                        </VideoClicks>\n                        <MediaFiles>\n                            <MediaFile id="720p.mp4" delivery="progressive" bitrate="1576" width="1296" height="720"\n                                       type="video/mp4">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/720p.mp4]]></MediaFile>\n                            <MediaFile id="720p.flv" delivery="progressive" bitrate="1582" width="1296" height="720"\n                                       type="video/x-flv">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/720p.flv]]></MediaFile>\n                            <MediaFile id="720p.webm" delivery="progressive" bitrate="1957" width="1296" height="720"\n                                       type="video/webm">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/720p.webm]]></MediaFile>\n                            <MediaFile id="480p.mp4" delivery="progressive" bitrate="901" width="864" height="480"\n                                       type="video/mp4">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/480p.mp4]]></MediaFile>\n                            <MediaFile id="480p.flv" delivery="progressive" bitrate="907" width="864" height="480"\n                                       type="video/x-flv">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/480p.flv]]></MediaFile>\n                            <MediaFile id="480p.webm" delivery="progressive" bitrate="1199" width="864" height="480"\n                                       type="video/webm">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/480p.webm]]></MediaFile>\n                            <MediaFile id="360p.mp4" delivery="progressive" bitrate="631" width="648" height="360"\n                                       type="video/mp4">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/360p.mp4]]></MediaFile>\n                            <MediaFile id="360p.flv" delivery="progressive" bitrate="637" width="648" height="360"\n                                       type="video/x-flv">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/360p.flv]]></MediaFile>\n                            <MediaFile id="360p.webm" delivery="progressive" bitrate="849" width="648" height="360"\n                                       type="video/webm">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/360p.webm]]></MediaFile>\n                            <MediaFile id="240p.mp4" delivery="progressive" bitrate="411" width="432" height="240"\n                                       type="video/mp4">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/240p.mp4]]></MediaFile>\n                            <MediaFile id="240p.flv" delivery="progressive" bitrate="417" width="432" height="240"\n                                       type="video/x-flv">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/240p.flv]]></MediaFile>\n                            <MediaFile id="240p.webm" delivery="progressive" bitrate="533" width="432" height="240"\n                                       type="video/webm">\n                                <![CDATA[https://stands.s3.yandex.net/streams/gillette_video/240p.webm]]></MediaFile>\n                        </MediaFiles>\n                    </Linear>\n                </Creative>\n            </Creatives>\n        </InLine>\n    </Ad>\n    <Ad id="1">\n        <InLine>\n          <Description>\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u0440\u0435\u0430\u0442\u0438\u0432\u0430 Motion!</Description>\n          <AdSystem>Yabs Ad Server</AdSystem>\n          <AdTitle>Interactive Direct In Video</AdTitle>\n\n          <Creatives>\n              <Creative id="777">\n                  <Linear skipoffset="00:00:05">\n                      <Duration>00:00:10</Duration>\n                      <MediaFiles>\n                          \x3c!-- VPAID viewer --\x3e\n                          <MediaFile width="0" height="0" delivery="progressive" type="application/javascript"\n                                    apiFramework="VPAID">\n                              <![CDATA[\n                                  https://yastatic.net/awaps-ad-sdk-js/1_0/vpaid-motion.js\n                              ]]>\n                          </MediaFile>\n                      </MediaFiles>\n                      <AdParameters>\n      <![CDATA[\n      {\n      "AUCTION_DC_PARAMS": {\n        "creative_params": {\n          "crypta_user_gender": "0",\n          "crypta_user_age": "2"\n        },\n      "data_params": {\n        "misc": {\n          "object_id": "4755336413",\n          "click_url": {\n            "abuse": "//yandex.ru/"\n          },\n          "target_url": "https://yandex.ru/"\n        },\n      "4755336413": {\n      "object_id": "4755336413",\n      "target_url": "https://yandex.ru/",\n      "click_url": {\n        "action_button": "http://yandex.ru/",\n        "text_name": "http://yandex.ru/"\n      },\n      "count": "https://an.yandex.ru/resource/spacer.gif?",\n      "unmoderated": {\n        "liked": 0,\n        "images": [\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/x90",\n            "90",\n            "90"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y90",\n            "90",\n            "90"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/x80",\n            "80",\n            "80"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y80",\n            "80",\n            "80"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y150",\n            "150",\n            "150"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/x160",\n            "160",\n            "160"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y160",\n            "160",\n            "160"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/x180",\n            "180",\n            "180"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y180",\n            "180",\n            "180"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y300",\n            "300",\n            "300"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/x450",\n            "450",\n            "450"\n          ],\n          [\n            "//avatars.mds.yandex.net/get-direct/329391/6N6U-RNh5-mIJsm3brHqqQ/y450",\n            "450",\n            "450"\n          ]\n        ]\n      },\n      "text": {\n        "domain": "\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0440\u0435\u043a\u043b\u0430\u043c\u0430",\n        "banner_flags": "",\n        "title_hyph": "",\n        "dynamic_disclaimer":"1",\n        "title": "\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0440\u0435\u043a\u043b\u0430\u043c\u0430",\n        "age": "0+",\n        "body": "\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0440\u0435\u043a\u043b\u0430\u043c\u0430",\n        "body_hyph": "",\n        "lang": "1"\n      }\n      }\n      }\n      },\n      "mediaFiles": [],\n      "theme": "video-banner_motion",\n      "measurers": {\n      },\n      "trackingEvents": {\n      }\n      }\n      ]]>\n                      </AdParameters>\n                  </Linear>\n                  <CreativeExtensions>\n\n                  </CreativeExtensions>\n              </Creative>\n          </Creatives>\n          <Extensions>\n              <Extension type="controls">\n                  <control id="adlabel" layout="1"/>\n                  <control id="countdown" layout="1"/>\n                  <control id="soundbtn" layout="1"/>\n              </Extension>\n          </Extensions>\n      </InLine>\n    </Ad>\n</VAST>\n',partnerId:291194,category:0},TA=["resourceTimings"],RA=["error"],PA=document.createElement("video"),_A=Gl(500);class bA extends Td{get state(){return this.playerStore.getState()}constructor(e,t,i,o){var a,s,c;super(),a=this,this.callbacks=void 0,this.videoController=void 0,this.maxBufferLength=void 0,this.visibilityDetectPromise=void 0,this.defineAutoplaySettingsPromise=void 0,this.abortRequestAutoplaySettings=Q,this.clearRequestAutoplaySettingsTimeout=Q,this.onlineMonitor=new Wf,this.resourceTimingsMonitor=void 0,this.playbackProgressStorage=new Kf,this.visualState=void 0,this.debug=!1,this.container=void 0,this.video=void 0,this.videoSizeSensor=void 0,this.div=void 0,this.adDiv=void 0,this.adMtDiv=void 0,this.adVideo=void 0,this.styleTag=void 0,this.sizeSensor=void 0,this.playbackQualityController=void 0,this.playerStore=void 0,this.playCallbacks=[],this.isAdFreeSession=void 0,this.preferNative=void 0,this.config=void 0,this.stopLoadSource=Q,this.onReady=void 0,this.preloaders=[],this.cachePreloaders=[],this.playDeferred=void 0,this.capSizesOverrideTries=0,this.capSizesOverride=void 0,this.adManager=void 0,this.adStartPlaybackStats=void 0,this.stopAd=e=>this.adManager.stopAd(e),this.setHiddenControls=e=>{e.includes(ed.ALL)?this.playerStore.dispatch(Rh(td)):this.playerStore.dispatch(Rh(e)),this.videoController&&!this.playerStore.getState().ad.adInfo&&this.videoController.updateNativeControlsVisibility()},this.seekToLive=()=>{if(!this.videoController||!this.videoController.isDvrEnabled())return;const{skinDVRStartTime:e,skinDVRDuration:t}=this.state.skin,i=Kl(e,t);this.seek({videoTime:i})},this.setPlaybackRate=e=>{const{max:t,min:i}=nr(this.state);this.videoController.setPlaybackRate(l(e,i,t))},this.seek=function(e,t){let{videoTime:i,utc:r}=e;if(void 0===t&&(t=!1),"number"===typeof r){const e=a.videoController.getUtcStartTime(),i=zl(r,e);a.seekToVideoPosition(i,t)}else"number"===typeof i&&a.seekToVideoPosition(i,t)},this.setVolume=e=>{var t;if(!this.videoController)return null==(t=this.adManager.getAdman())||t.setVolume(this.state.controller.muted?0:.7*this.state.controller.volume),this.playerStore.dispatch(Cu({muted:this.state.controller.muted,volume:e,changeReason:Jp.SetVolume})),void this.abortRequestAutoplaySettings(Fp.VolumeChange);const{muted:i,volume:r}=this.state.controller;let n=e,o=i;if(0===e){const{userVolume:e}=this.state.controller;n=e||r||1,o=!0}this.playerStore.dispatch(Cu({volume:n,muted:o,changeReason:Jp.SetVolume}));const a=this.adManager.getCurrentAdPlaybackQueue();a&&ei(this.state)?a.setVolume(e):this.videoController&&(this.videoController.setVolume(n),this.videoController.setMuted(o))},this.setMuted=e=>{const t={volume:this.state.controller.volume,muted:e,changeReason:Jp.SetMuted};if(!this.videoController)return this.playerStore.dispatch(Cu(t)),void this.abortRequestAutoplaySettings(Fp.MuteChange);this.playerStore.dispatch(Cu(t));const i=this.adManager.getCurrentAdPlaybackQueue();i&&ei(this.state)?i.setVolume(e?0:this.state.controller.volume):this.videoController&&this.videoController.setMuted(e)},this.playInrollAd=e=>{this.shouldPlayAd()&&this.getMultiroll().inroll.schedule(xa({},e,{timeOffset:(null==e?void 0:e.timeOffset)||0}))},this.playAdViewers=async(e,t,i,r,n)=>{this.shouldPlayAd()&&this.adManager.playAdViewers(e,t,i,r,n)},this.handleSizeSensorUpdate=e=>{let{width:t,height:i}=e;this.emit("VisualStateChange",xa({},this.visualState.getState(),{width:t,height:i}))},this.defineAutoplaySettingsAndLoadSource=()=>{const e=this.config.source,t=this.playerStore.getState(),{initialAutoplay:i,allowMuted:r,muted:n,volume:o,togglePlaybackOnVisibilityChangeSetting:s}=t.controller;this.defineAutoplaySettings(this.video,{autoplay:i,muted:n||0===o,allowMuted:!(!s||!s.forceAutoplay)||r}),this.loadSource(e,{shouldSaveProgress:!1}).catch(e=>{pp.error("load source error",e),qr(e,Yh.INIT),this.onError(e)}).then(()=>{this.onReady(),this.state.controller.autoplay||this.playerStore.dispatch(Th(!0))}).then(()=>{void 0!==e.params.adConfig&&(Ps?ie({method:"GET",url:Rs,retries:2,checkStatus:e=>e>=200&&e<400}).then(e=>{if(!e.responseText.trim().includes('<VAST version="3.0">'))throw new Error("Invalid XML in response from ["+Rs+"]")}):Promise.resolve()).catch((function(e){let{message:t}=void 0===e?{}:e;location.href.includes("dzen.ru/news")?a.playerStore.dispatch(au(!1)):(a.playerStore.dispatch(au(!0)),a.onError(new jc({code:Cs.STRM_ABD_INVALID_RESPONSE,isFatal:!0,details:{reason:t}})))}))})},this.subscribeHandlers=()=>{this.onlineMonitor.on("Online",()=>{this.playerStore.dispatch(Wu(!0)),ei(this.state)||this.videoController&&this.videoController.onOnline(),this.callbacks.onExpectedStalledChange(ut(Fh.Offline,void 0))}),this.onlineMonitor.on("Offline",()=>{this.playerStore.dispatch(Wu(!1)),this.videoController&&this.videoController.onOffline()}),this.on("VideoTypeChange",e=>{this.playerStore.dispatch(Nu(e))}),this.on("DurationChange",e=>{this.playerStore.dispatch(ku(e)),this.videoController.updateDVRParams(),this.updateVideoInfo()}),this.on("DvrChange",()=>{this.updateVideoInfo()}),this.on("ProgramDateTimeChange",e=>{this.playerStore.dispatch(Ku(e))}),this.on("CurrentTimeChange",this.handleVideoControllerCurrentTimeChange),this.on("BufferingRangesChange",e=>{this.playerStore.dispatch(Zu(e))}),this.on("VideoTrackValueChange",e=>{this.playerStore.dispatch(rh({videoTrackValue:e,isAbrEnabled:this.state.controller.isAbrEnabled}))}),this.on("VideoTrackChange",e=>{this.playerStore.dispatch(nh(e))}),this.on("AudioTrackValueChange",e=>{this.playerStore.dispatch(ah(e))}),this.on("AudioTracksChange",e=>{this.playerStore.dispatch(sh(e))}),this.on("TextTrackValueChange",e=>{const{controller:{textTrackEnabled:t,textTrackValue:i}}=this.getState(),r=void 0!==e,n=void 0===e?i:e;this.playerStore.dispatch(ch(r)),this.playerStore.dispatch(ph(n));if((t?i:void 0)===(r?e:void 0))return;const o=r?rr(this.getState()):void 0;this.callbacks.onTextTrackChange(o)}),this.on("TextTracksChange",e=>{this.playerStore.dispatch(dh(e))}),this.on("VideoPlayingStateChange",e=>{this.playerStore.dispatch(Oh(e))});const e=this.logCanPlay(Yh.INIT);this.once("CanPlay",e),this.once("SetSource",()=>this.off("CanPlay",e));const t=this.logLoadStartHavingCurrentData(Yh.INIT);this.once("LoadedData",t),this.once("SetSource",()=>this.off("LoadedData",t)),this.once("Destroy",()=>{this.off("ContentImpression")});const i=R(this.getContainerDocument(),e=>{this.playerStore.dispatch(Eh(e))});var r;this.once("Destroy",i),this.once("Destroy",(r=e=>{this.callbacks.logEvent({event:Cp.DrmSystemsSupportDetected,params:e})},void 0===Lf?(Df.push(r),()=>{const e=Df.indexOf(r);-1!==e&&Df.splice(e,1)}):(r(Lf),Q)))},this.setBackgroundImage=e=>{this.div.style.backgroundImage=e?"url('"+e+"')":""},this.setBackgroundVisibility=e=>{this.div.style.backgroundSize=e?"contain":"0  0"},this.shouldCaptureScreenshot=()=>{var e;return this.videoController&&this.videoController.engine===Qp.MPD&&this.state.controller.videoType===Bh.VOD&&!(null!=(e=this.state.controller.stream)&&e.drmConfig)},this.handleVideoControllerCurrentTimeChange=e=>{if(this.state.controller.encoderState!==xh.Attached)return;!(e<jl(.5)&&this.state.controller.engine===Qp.NATIVE&&this.state.controller.videoType===Bh.LIVE)&&(this.playerStore.dispatch(Mu(e)),this.playerStore.getState().ad.adInfo||this.playbackProgressStorage.saveProgress(e)),this.videoController.updateDVRParams(),this.updateVideoInfo()},this.handleVisualStateChange=e=>{let{isPip:t,isFullScreen:i,isVisible:r}=e;this.playerStore.dispatch(vh(i));const{isSupportedPipMode:n,isYandexPipMode:o,isVisibilitySupported:a}=this.visualState;this.emit("VisualStateChange",xa({isPip:t,isVisible:r,isFullScreen:i,isSupportedPipMode:n,isYandexPipMode:o,isVisibilitySupported:a},this.sizeSensor.getSize())),n&&!o&&(this.playerStore.dispatch(mh(t)),a&&this.playerStore.dispatch(Ah(r)))},this.onRecover=async e=>{const t=Va(this.getSyncDebugInfo(),TA);this.callbacks.onRecover(xa({},e,t)),this.callbacks.onExpectedStalledChange(ut(Fh.Recover,{recoverReason:e.reason}))},this.logLoadStartHavingCurrentData=e=>()=>{if(!js){if(this.video.readyState<this.video.HAVE_CURRENT_DATA){const t=this.logLoadStartHavingCurrentData(e);return this.once("LoadedData",t),void this.once("SetSource",()=>this.off("LoadedData",t))}this.isCanPlayAndStartHavingCurrentDataLog()&&this.emit("ContentImpression")}},this.logCanPlay=e=>()=>{js||this.isCanPlayAndStartHavingCurrentDataLog()&&(this.callbacks.logEvent({event:Cp.CanPlay,params:{stage:e}}),this.emit("ContentImpression"))},this.isCanPlayAndStartHavingCurrentDataLog=()=>!this.state.ad.hasPreroll&&this.state.controller.preload,this.startStream=()=>this.state.controller.encoderState===xh.Attached?Promise.resolve():this.attachEncoder().catch(pp.error),this.handleFirstContentImpression=()=>{this.resetPosterFitStyle(),this.callbacks.logEvent({event:Cp.ContentImpression,params:{}}),this.callbacks.onContentImpression({hasPreroll:this.state.ad.adSyncInit,engine:this.state.controller.engine}),this.playerStore.dispatch(Th(!0)),this.hidePoster()},this.setMaxListeners(14),this.container=e,this.preferNative=!0===t.preferNative,this.config=t.isAdTestMode?(e=>Ma({},e,{source:Ma({},e.source,{params:Ma({},e.source.params,{adConfig:Ma({},e.source.params.adConfig,SA)})})}))(t):t,this.isAdFreeSession=Boolean(t.isAdFreeSession),this.onReady=U(o);const u=t.source,{params:h}=u,{additionalParams:p}=h,f=t.volume,{togglePlaybackOnVisibilityChange:g}=t;this.callbacks=t.callbacks,this.maxBufferLength=t.maxBufferLength,this.resourceTimingsMonitor=new $f(t.resourceTimingsMonitor);const{autoplay:v}=t,m=t.hidden;this.debug=Boolean(t.debug),this.debug&&pp.enableConsole(),this.div=document.createElement("div"),this.div.className=mm().locals.StreamPlayer,d(t.backgroundColor)&&(this.div.style.backgroundColor=t.backgroundColor),this.adDiv=document.createElement("div"),this.adDiv.className=mm().locals.StreamPlayer_ui,this.adMtDiv=document.createElement("div"),this.adMtDiv.className=mm().locals.StreamPlayer_ui,this.adVideo=document.createElement("video"),this.adVideo.setAttribute("playsinline","playsinline");this.styleTag=document.createElement("style"),this.styleTag.appendChild(document.createTextNode(".rb-adman-ad-actions { z-index: 2;}")),this.adVideo.className=mm().locals.StreamPlayer_ui,this.adVideo.style.display="none",this.adVideo.style.zIndex="1",this.div.tabIndex=-1,this.container.appendChild(this.div),this.container.appendChild(this.adDiv);const A=Boolean(t.allowMuted),E=xa({},t);delete E.callbacks;const y=ir(this,{controller:xa({},Uh,{autoplay:v,initialAutoplay:v,allowMuted:A,preload:t.preload,from:p.from,vsid:p.vsid,streamBlock:p.stream_block,volume:t.volume,muted:t.muted,userVolume:void 0===t.volume?NaN:f,isFullscreen:!1,togglePlaybackOnVisibilityChangeSetting:g,isDocumentVisible:T(this.getContainerDocument()),isOnline:!0,isAbrEnabled:t.autoQuality,defaultQuality:t.defaultQuality,feed:t.feed,preview:h.preview,playerConfig:E}),ad:xa({},Dh,{adblockDetected:Ps,nativeAdControlsVisibility:t.useNativeAdControls}),skin:xa({},Lp,{hiddenControls:m,useNativeSubtitles:!0,nativeControlsVisibility:!id(m)})});this.playerStore=y;const P=this.container.getElementsByTagName("video")[0]||function(){const e=document.createElement("video");return window.parent&&window.parent.HTMLVideoElement&&Sm(HTMLMediaElement.prototype,window.parent.HTMLVideoElement.prototype),e}();this.video=P,P.poster||(P.poster=ld),this.playbackQualityController=new Am(P);const _=function(e){const t=Lm(e);return t?()=>{Lm(e)!==t&&Vm()(e,t)}:Q}(P);this.div.appendChild(P),_(),this.div.appendChild(this.adMtDiv),this.adMtDiv.appendChild(this.adVideo),this.adMtDiv.appendChild(this.styleTag);const b=this.getContainerDocument().getElementsByTagName("head")[0];!function(e,t){const i=document.createElement("style");i.textContent+=e,t?t.appendChild(i):r(window).appendChild(i)}(mm().toString(),b),S(P,mm().locals.player__video),this.videoSizeSensor=new Ql(P),function(e){e.setAttribute("playsinline","playsinline"),e.setAttribute("webkit-playsinline","webkit-playsinline")}(P),this.visualState=i.visualState,this.visualState.setVideoElement(P),this.adManager=new gA({lang:this.config.lang,playerContainerElement:this.container,playerVideoElement:this.video,callbacks:this.callbacks,playerAdMtDiv:this.adMtDiv,playerAdVideo:this.adVideo,playerAdDiv:this.adDiv,playerDiv:this.div,yaDirectPixel:this.config.yaDirectPixelUrl&&this.config.yaDirectPixelData?{yaDirectPixelUrl:this.config.yaDirectPixelUrl,yaDirectPixelData:this.config.yaDirectPixelData}:void 0,getPlayerContainerDocument:()=>this.getContainerDocument(),rejectPlayerPlayDeferred:e=>{var t;null==(t=this.playDeferred)||t.reject(e)},resolvePlayerPlayDeferred:()=>{var e;null==(e=this.playDeferred)||e.resolve()},preloadVideoControllerSource:()=>this.preloadVideoControllerSource(),getPlayerIsLive:()=>this.isLive(),hasPlayerVideoController:()=>void 0!==this.videoController,pauseVideoController:()=>{var e;return null==(e=this.videoController)?void 0:e.pause()},toggleVideoControllerAdShown:e=>{this.videoController&&(this.videoController.adShown=e)},getVideoControllerBandwidthEstimate:()=>{var e;return null==(e=this.videoController)?void 0:e.getBandwidthEstimate()},getVideoControllerDuration:()=>{var e;return null==(e=this.videoController)?void 0:e.getDuration()},getVideoControllerUtcPosition:()=>{var e;return(null==(e=this.videoController)?void 0:e.getUtcPosition())||wv},getVideoControllerCurrentTime:()=>{var e;return null==(e=this.videoController)?void 0:e.getCurrentTime()},getVideoControllerVideoEngine:()=>{var e;return null==(e=this.videoController)?void 0:e.engine},playVideoController:()=>{var e;return null==(e=this.videoController)?void 0:e.play()},captureVideoControllerScreenshot:e=>{var t;return(null==(t=this.videoController)?void 0:t.captureScreenshot(e))||Promise.resolve(void 0)},clearVideoControllerScreenshot:()=>{var e;return null==(e=this.videoController)?void 0:e.clearScreenshot()},hidePlayerPoster:()=>this.hidePoster(),shouldCaptureScreenshot:()=>this.shouldCaptureScreenshot(),attachEncoder:()=>this.attachEncoder(),detachEncoder:()=>this.detachEncoder(),resetPosterFitStyle:()=>this.resetPosterFitStyle(),setBackgroundImage:e=>this.setBackgroundImage(e),setBackgroundVisibility:e=>this.setBackgroundVisibility(e),onceCanPlay:e=>{this.once("CanPlay",e)},onMetadataChange:e=>{this.on("MetadataChange",e)},getSTRMChunkUrls:()=>Pi(this.resourceTimingsMonitor.getAllResourcesTimings()),createExpectedStalled:ut,getPlayerContainer:()=>this.config.useFriendlyFrame?function(e,t){const i=t.getElementById(La(e));let r=i&&i.parentElement;return r=r&&r.parentElement,r||void 0}(this.state.controller.vsid,window.parent.document):document.getElementById("q"),logger:pp,adConfigImpId:null==(s=this.config.source.params.adConfig)?void 0:s.impId,adConfigPartnerId:null==(c=this.config.source.params.adConfig)?void 0:c.partnerId,admanMeta:{dzenuid:this.config.dzenuid,vid:this.config.vid,ea:this.config.ea,eg:this.config.eg},isSkipAllPodsFlagEnabled:jr("web_skip_all_adpods"),isIOS:fd,getControllerWatchedTime:()=>this.state.controller.watchedTime,getControllerCurrentTime:()=>this.state.controller.currentTime,getControllerStartPosition:()=>this.state.controller.startPosition,getControllerSourcePreviewParam:()=>{var e;return null==(e=this.state.controller.sourceParams)?void 0:e.preview},getDefaultSourcePreviewParam:()=>ld,getControllerProgramDateTime:()=>this.state.controller.programDateTime,getControllerIsFullscreen:()=>this.state.controller.isFullscreen,getControllerIsPip:()=>this.state.controller.isPip,getAdOriginalBroadcastAdCueId:()=>this.state.ad.originalBroadcastAdCueId,getCueId:()=>wt(this.state),getUtcPositionMs:()=>function(e){const{controller:{currentTime:t,programDateTime:i}}=e;return void 0===i?i:Kl(i,ql(t,1e3))}(this.state),getNextAdInfo:()=>this.state.ad.nextAdInfo,getControllerStartStage:()=>this.state.controller.startStage,getControllerPreload:()=>this.state.controller.preload,getControllerVsid:()=>this.state.controller.vsid,getAdConfig:()=>this.state.ad.adConfig,getAdInfo:()=>this.state.ad.adInfo,getControllerVolume:()=>this.state.controller.volume,getControllerMuted:()=>this.state.controller.muted,getAdControlsSettings:()=>function(e){const{ad:{nativeAdControlsVisibility:t}}=e;return{controlsVisibility:t?{}:{mute:!1,timeline:!1,play:!1,loader:!1}}}(this.state),getInStreamPlayingState:()=>this.state.ad.inStreamPlayingState,getControllerAutoplay:()=>this.state.controller.autoplay,getControllerFrom:()=>this.state.controller.from,updateAdInfo:e=>{this.playerStore.dispatch(ru(e))},putStartPosition:e=>{this.playerStore.dispatch(ju(e))},putResourcesIdle:e=>{this.playerStore.dispatch(Th(e))},putInStreamPlayingState:e=>{this.playerStore.dispatch(gu(e))},putVideoSize:e=>{this.playerStore.dispatch(Du(e))},putShowAdSkin:e=>{this.playerStore.dispatch(bh(e))},putShowSkipAdButton:e=>{this.playerStore.dispatch(_h(e))},putOriginalBroadcastAdCues:e=>{this.playerStore.dispatch(su(e))},getMinimalChance:()=>.01,playerVersion:"1.0-1238",shouldPlayAd:()=>this.shouldPlayAd()}),this.adManager.on("NoAdPodsToPlayAd",()=>{this.callbacks.logEvent({event:"NoAdPodsToPlayAd",params:void 0})}),this.adManager.on("PlayAdViewers",e=>{let{adPodsCount:t,adType:i,isDelayed:r}=e;this.callbacks.logEvent({event:Cp.PlayAdViewers,params:{adType:i,adPodsCount:t,isDelayed:r||!1}}),this.callbacks.onBeforeAdStart()}),this.adManager.on("AdPodError",e=>{this.callbacks.logEvent({event:Cp.AdPodError,params:e})}),this.adManager.on("AdPodStart",e=>{this.callbacks.logEvent({event:Cp.AdPodStart,params:xa({},e,this.adStartPlaybackStats||Na(this.state))})}),this.adManager.on("AdPodSkip",e=>{this.callbacks.logEvent({event:Cp.AdPodSkip,params:e})}),this.adManager.on("AdIntervalRemoved",e=>{this.playerStore.dispatch(du(e))}),this.adManager.on("AdIntervalUpdated",e=>{let{cueId:t,start:i,end:r}=e;this.playerStore.dispatch(lu({cueId:t,start:Xl(i,1e3),end:Xl(r,1e3)}))}),this.adManager.on("BeforeInrollHandle",()=>{this.playerStore.dispatch(hu())}),this.adManager.on("BroadcastAdReceived",e=>{this.callbacks.logEvent({event:Cp.BroadcastAdReceived,params:e})}),this.adManager.on("BroadcastAdInit",e=>{this.callbacks.logEvent({event:Cp.BroadcastAdInit,params:e})}),this.adManager.on("ReceivedMetadata",e=>{this.callbacks.logEvent({event:Cp.StreamPlayerReceivedMetadata,params:e})}),this.adManager.on("AdClickThru",e=>{this.callbacks.logEvent({event:Cp.AdClickThru,params:e})}),this.adManager.on("AdEnd",e=>{this.adStartPlaybackStats=void 0,this.callbacks.logEvent({event:Cp.AdEnd,params:e}),this.callbacks.onAdEnd()}),this.adManager.on("InrollAdEnd",e=>{this.callbacks.logEvent({event:Cp.InrollAdEnd,params:e})}),this.adManager.on("AdPodEnd",e=>{this.callbacks.logEvent({event:Cp.AdPodEnd,params:e})}),this.adManager.on("InrollAdPodEnd",e=>{this.callbacks.logEvent({event:Cp.InrollAdPodEnd,params:e})}),this.adManager.on("AdStart",e=>{this.adStartPlaybackStats=Na(this.state),this.callbacks.logEvent({event:Cp.AdStart,params:xa({},e,this.adStartPlaybackStats)})}),this.adManager.on("InrollAdStart",e=>{this.callbacks.logEvent({event:Cp.InrollAdStart,params:e})}),this.adManager.on("AdPodPause",e=>{this.callbacks.logEvent({event:Cp.AdPodPause,params:e})}),this.adManager.on("AdPodResume",e=>{this.callbacks.logEvent({event:Cp.AdPodResume,params:e})}),this.adManager.on("AdPodLoading",e=>{this.callbacks.logEvent({event:Cp.AdPodLoading,params:e})}),this.adManager.on("InrollAdPodStart",e=>{this.callbacks.logEvent({event:Cp.InrollAdPodStart,params:e})}),this.adManager.on("AdPodImpression",e=>{this.callbacks.logEvent({event:Cp.AdPodImpression,params:e})}),this.adManager.on("BroadcastAdBlockInitError",e=>{let{error:t,metadata:i}=e;this.onError(new jc(t,{code:Cs.BROADCAST_AD_BLOCK_INIT_ERROR,isFatal:!1,details:{code:t.code,message:t.message,id:t.id,details:t.details,stack:t.stack,metadata:i}}))}),this.adManager.on("PlayAdViewersError",e=>{let{error:t}=e,i=Va(e,RA);this.onError(new jc(t,{code:Cs.PLAY_AD_VIEWERS_ERROR,isFatal:!1,details:i}))}),this.adManager.on("AdIsAlreadyPlayingError",e=>{this.onError(new jc({code:Cs.AD_IS_ALREADY_PLAYING,isFatal:!1,details:e}))}),this.adManager.on("UnrecognizedAdTypeError",()=>{this.onError(new jc({code:Cs.AD_TYPE_IS_NOT_RECOGNIZED,isFatal:!1}))}),this.adManager.on("MultirollInitError",e=>{let{error:t,adConfig:i}=e;this.onError(new jc({isFatal:n(yA)&&("0"===String(t.code)||!t.code),code:Cs.MULTIROLL_INIT_ERROR,details:{error:t,adConfig:i}}))}),this.adManager.on("InvalidMetadataError",e=>{this.onError(new jc({code:Cs.INVALID_METADATA,details:e}))}),this.on("VisualStateChange",e=>{e&&this.callbacks.onVisualStateChange(e)});const I=function(e,t,i){let r,n=0;const o=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e.call(i,...r)};return function(){const e=Date.now(),i=e-n;clearTimeout(r);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];i<t?r=window.setTimeout(o,t-i,...s):(n=e,o(...s))}}(this.handleSizeSensorUpdate,_A);this.sizeSensor=this.videoSizeSensor,this.sizeSensor.onResize.add(e=>{let{width:t,height:i}=e;return I({width:Yl(t),height:Yl(i)})}),I(this.sizeSensor.getSize()),this.once("Destroy",()=>this.sizeSensor.destroy()),g&&this.visualState.isYandexPipMode&&Qr(window,!1,this.video),this.visualState.observe(this.handleVisualStateChange),this.handleVisualStateChange(this.visualState.getState()),this.visibilityDetectPromise=Promise.resolve(this.visualState.getState()),this.defineAutoplaySettingsAndLoadSource(),Promise.resolve().then(()=>{this.initEventSubscribes(t,P)}),this.logEpisodesEventWhenAvailable()}logEpisodesEventWhenAvailable(){void 0!==this.config.episodes&&this.config.episodes.length>0&&this.callbacks.logEvent({event:Cp.VideoEpisodesLoaded,params:{}})}toggleAdFreeSession(e){this.isAdFreeSession=e}updateEpisodes(e){this.config.episodes=e,this.playerStore.dispatch(kh(e)),this.logEpisodesEventWhenAvailable()}shouldPlayAd(){var e;return 1!==(null==(e=this.state.ad.adConfig)?void 0:e.partnerId)&&!this.isAdFreeSession}recoverStream(){return this.videoController?this.videoController.recoverStream():Promise.resolve()}getRecoverHelper(){if(this.videoController)return this.videoController.recoverHelper}toggleNativeSubtitles(e){this.videoController&&this.videoController.toggleNativeSubtitles(e)}updateVideoControllerNativeControlsVisibility(){this.videoController&&this.videoController.updateNativeControlsVisibility()}getMultiroll(){return this.adManager.getMultiroll()}getConnectionQuality(){return this.videoController?this.videoController.getConnectionQuality():Sp.UNKNOWN}setPictureInPictureEnabled(e){Qr(window,e,this.video)}setFeed(e){this.playerStore.dispatch(hh(e))}getRemainingBufferedTime(){return this.videoController?this.videoController.getRemainingBufferedTime():{total:jl(0)}}getSegmentSize(){var e;return null==(e=this.videoController)?void 0:e.getSegmentSize()}getVideoPlaybackQuality(){return this.playbackQualityController.getPlaybackQuality()}getMaxCapAllowedVideoTrack(){if(this.videoController)return this.videoController.getMaxCapAllowedVideoTrack()}getContainerSize(){var e;return null==(e=this.videoController)?void 0:e.getContainerSize()}getVideoTrack(){return xi(this.state)}getVideoTracks(){return this.state.controller.videoTracks}getAudioTrack(){return ni(this.state)}getAudioTracks(){return this.state.controller.audioTracks}getTextTrack(){return function(e){const{textTrackEnabled:t}=e.controller;if(t)return rr(e)}(this.state)}getTextTracks(){return this.state.controller.textTracks}setNativeTextTrackVisibility(e){this.playerStore.dispatch(uh(e))}setNativeAdControlsVisibility(e){this.playerStore.dispatch(pu(e))}getMuted(){return this.state.controller.muted}getLiveLatency(){return void 0===this.videoController?void 0:this.videoController.getLiveLatency()}getPlayingState(){return this.state.controller.playingState}getDuration(){return this.state.controller.duration}getCurrentTime(){return this.state.controller.currentTime}getTimelineInfo(){const{controller:{duration:e,currentTime:t},skin:{skinDVRStartTime:i,skinDVRDuration:r}}=this.state;return{currentTime:t,duration:e,utcStartTime:this.getUtcStartTime(),dvrStartTime:i,dvrDuration:r}}getWatchedTime(){return this.state.controller.watchedTime}getPreloadDetails(){const{preloadDetails:e}=this.state.controller;if((null==e?void 0:e.preloadingMethod)!==zp.Internal)return e}async getLongStalledDebugInfo(){if(this.videoController&&this.videoController.shouldLogStalledDebugInfo())return this.requestDebugInfo()}getBandwidthEstimate(){return(void 0===this.videoController?this.state.controller.lastKnownBandwidthEstimate:this.videoController.getBandwidthEstimate())||void 0}getCurrentStream(){return this.state.controller.stream}setVideoStyle(e){this.playerStore.dispatch(Ch(xa({},this.playerStore.getState().controller.videoElementStyle,e))),c(this.video,e)}setSource(e,t){let{shouldSaveProgress:i=!1}=void 0===t?{}:t;this.capSizesOverrideTries=0,this.loadSource(e,{shouldSaveProgress:i}).catch(e=>{qr(e,Yh.SET_SOURCE),this.onError(e)}),this.emit("SetSource",e);const r=this.logCanPlay(Yh.SET_SOURCE);this.once("CanPlay",r),this.once("SetSource",()=>this.off("CanPlay",r));const n=this.logLoadStartHavingCurrentData(Yh.SET_SOURCE);this.once("LoadedData",n),this.once("SetSource",()=>this.off("LoadedData",n))}getSourceId(){return this.playerStore.getState().controller.sourceId}getUtcPosition(){return this.videoController?this.videoController.getUtcPosition():wv}planAdViewers(e){this.adManager.planAdViewers(e)}play(){var e;if(null!=(e=this.videoController)&&e.adShown)return new Promise(()=>null);this.performPlayCallbacks();const t=this.adManager.getCurrentAdPlaybackQueue();var i;if(t&&ei(this.state))return t.resumeAd(),null==(i=this.playDeferred)||i.resolve(),Promise.resolve();const r=this.adManager.getPlannerAdViewers();var n;if(r.length>0)return this.adManager.playAdViewers(Kh.postPauseroll,r,{},{}),null==(n=this.playDeferred)||n.resolve(),Promise.resolve();if(!this.videoController||this.state.controller.encoderState!==xh.Attached)return this.playerStore.dispatch(Ru(!0)),this.playerStore.dispatch(Pu(Vh.starting)),this.abortRequestAutoplaySettings(Fp.ApiPlay),this.playDeferred||(this.playDeferred=new dd,this.playDeferred.promise.catch(Q).then(()=>{this.playDeferred=void 0})),this.playDeferred.promise;const o=this.videoController.getCurrentTime(),a=this.videoController.getDuration();a>0&&o>=a&&this.seek({videoTime:jl(0)}),pp.log("StreamPlayer.play() -> videoController.play()");const s=this.videoController.play();var l;(s.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()},e=>{var t;return null==(t=this.playDeferred)?void 0:t.reject(e)}),o>0)&&(null==(l=this.adManager.getTimer())||l.play());return s}pause(){var e,t;this.playerStore.dispatch(Th(!0)),this.state.controller.startStage!==Vh.started&&(this.playerStore.dispatch(Ru(!1)),this.playerStore.dispatch(Pu(Vh.waitForUserPlay))),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()"));const i=this.adManager.getCurrentAdPlaybackQueue();i&&ei(this.state)?i.pauseAd():this.videoController&&this.state.controller.encoderState===xh.Attached?(this.adManager.stopAdmanAd(),null==(t=this.adManager.getTimer())||t.pause(),this.videoController.pause()):this.playerStore.dispatch(Ru(!1))}getPlaybackRate(){return this.state.controller.playbackRate}setVideoTrack(e){const t=this.getVideoTrack();if(va(t,e))return;this.playerStore.dispatch(ih(e===Wp.value));const i=e===Wp.value&&this.state.controller.isAbrSupported?Wp:this.state.controller.videoTracks.find(t=>t.value===String(e)),{videoHeight:r}=this.state.controller,n=((null==i?void 0:i.height)||0)>r;i&&i.value!==Wp.value&&n&&function(e,t){void 0===t&&(t=Up),t in pm?pm[t].preferHd=e:pm[t]={preferHd:e},pf.setItem("videoplayer-prefer-hd",JSON.stringify(pm))}(!0,this.state.controller.from),this.playerStore.dispatch(oh({name:i&&i.value!==Wp.value&&i.name||void 0,height:i&&i.height?Yl(i.height):void 0})),i&&(this.videoController.setVideoTrack(i),this.callbacks.onExpectedStalledChange(ut(Fh.VideoTrackChange,{newTrack:i,oldTrack:t})),pp.log("SELECTED VIDEO TRACK: ",i))}setAudioTrack(e){const t=this.getAudioTrack();if(va(t,e))return;const i=this.state.controller.audioTracks.find(t=>t.value===String(e));i&&(this.playerStore.dispatch(lh({name:i.name||void 0,lang:i.lang||void 0})),this.videoController.setAudioTrack(i),this.callbacks.onExpectedStalledChange(ut(Fh.AudioTrackChange,{newTrack:i,oldTrack:t})),pp.log("SELECTED AUDIO TRACK: ",i))}getSyncDebugInfo(){const{resourceTimingsMonitor:e,videoController:t}=this;return{recoverHelperState:t?t.getRecoverHelperState():qp.OFF,state:this.getState(),remainingBufferedTime:Ii(this.state),resourceTimings:e.getAllResourcesTimings(),connectionQuality:t?t.getConnectionQuality():Sp.UNKNOWN}}async requestDebugInfo(){return xa({},this.getSyncDebugInfo(),{videoController:this.videoController?await this.videoController.requestDebugInfo():{noController:!0}})}getState(){return this.state}setTextTrack(e){const{textTracks:t,userTextTrackLang:i,userTextTrackName:r,textTrackEnabled:n,textTrackValue:o}=this.state.controller;if(n&&o===e)return;if("auto"===e)return void this.playerStore.dispatch(gh());const a=void 0===e?void 0:t.find(t=>t.value===e),s={enabled:Boolean(a),lang:a?a.lang||void 0:i,name:a?a.name||void 0:r};this.playerStore.dispatch(fh(s)),a?(this.videoController.setTextTrack(a),pp.log("SELECTED TEXT TRACK: ",a)):(this.videoController.disableTextTrack(),pp.log("DISABLE TEXT TRACK"))}getVolume(){return this.state.controller.volume}setFullscreen(e){if(e)try{this.visualState.changeFullscreenState({isFullScreen:!0})}catch(t){pp.error("Request fullscreen for element:",t)}else try{this.visualState.changeFullscreenState({isFullScreen:!1})}catch(t){pp.error("Exit fullscreen for element:",t)}}async destroy(){this.adManager.stopAd({stopAdReason:rp.PlayerDestroy,data:{loadPositionAfterAd:void 0}}),this.stopLoadSource(Xp.destroy),this.getMultiroll().destroy();const e=this.adManager.getCurrentAdPlaybackQueue();e&&e.destroy(rp.PlayerDestroy),this.onlineMonitor.destroy(),this.visualState.destroy(),this.resourceTimingsMonitor.destroy(),this.playbackQualityController.destroy(),this.emit("Destroy"),await this.destroyVideoController(),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(this.container)}skipAdPod(){this.adManager.skipAdmanAd();const e=this.adManager.getCurrentAdPlaybackQueue();e&&e.skipAdPod()}patchAdControlsVisibility(e,t){return t&&(e.controlsSettings={controlsVisibility:{skip:!1}}),e}stop(){this.config.keepLastFrame||this.seek({videoTime:jl(0)}),this.pause()}preloadSource(e){this.callbacks.logEvent({event:Cp.PreloadSource,params:{source:e}});let t=Q,i=!1;return{promise:this.preloadSourceImpl(e,()=>i,e=>{t=e}),abort:()=>{i||(i=!0,t())}}}initEventSubscribes(e,t){this.once("Destroy",f(this.getMainContainer(),"click",t=>{if(this.state.controller.watchedTime>0)return;if(void 0!==this.state.ad.inStreamPlayingState)return;void 0!==e.shouldPlayOnFirstClick&&e.shouldPlayOnFirstClick&&this.play()},{once:!0})),Gs&&this.once("Destroy",ca(()=>this.destroy())),this.once("Destroy",f(this.div,"selectstart",e=>{e.preventDefault(),e.stopPropagation()})),this.once("Destroy",N(()=>{this.playerStore.dispatch(hu())})),this.once("Destroy",f(this.getMainContainer(),"click",t=>{this.state.controller.watchedTime>0||void 0===this.state.ad.inStreamPlayingState&&e.shouldPlayOnFirstClick&&this.play()},{once:!0})),Gs&&this.once("Destroy",ca(()=>this.destroy())),this.once("Destroy",()=>{this.off("VisualStateChange")}),this.initClickerEventListener(this.div),this.initTouchZoomPreventor(this.div),this.once("Destroy",f(this.video,"volumechange",()=>{const e=this.adManager.getCurrentAdPlaybackQueue();(this.videoController||e)&&this.updateVolumeInfo()})),this.subscribeHandlers()}initClickerEventListener(e){const t=new Pd(e);this.once("Destroy",()=>t.destroy()),t.on("Event",e=>{let{type:t,event:i}=e;if(ei(this.state))return;const r=xa({},i);r.preventDefault=void 0,this.callbacks.onVideoClickerEvent({type:t,event:r})})}initTouchZoomPreventor(e){const t=new Od(e);this.once("Destroy",()=>t.destroy())}requestAutoplaySettings(e,t,r){return function(e){return void 0===e&&(e=window),hg(e).some(e=>{const{hasBeenActive:t}=i(()=>da(e))||{hasBeenActive:!1};return t})}(window)?{promise:Promise.resolve({autoplay:t.autoplay,muted:t.muted,detectionMethod:"ACTIVATED_WINDOW"}),abort:Q,skipCacheUpdate:!0}:ga(xa({},t,{videoSlot:e}))}defineAutoplaySettings(e,t){if(this.state.controller.autoplay&&!this.state.controller.isDocumentVisible)return this.playerStore.dispatch(Pu(Vh.waitForDocumentVisibility)),this.playerStore.dispatch(Ru(!1)),void(this.defineAutoplaySettingsPromise=Promise.resolve());let r;const n=la(t),{promise:o,skipCacheUpdate:a=!1,abort:s}=this.requestAutoplaySettings(e,t,n),{promise:l,clear:d}=Zl(Gp);this.clearRequestAutoplaySettingsTimeout=()=>{d()},l.then(()=>{this.state.controller.startStage===Vh.init&&this.playerStore.dispatch(Pu(Vh.waitForUserPlay))});const c=H();this.abortRequestAutoplaySettings=e=>{void 0===r&&this.callbacks.logEvent({event:"PlayWithoutRAAResults",params:{delay:Gl(c()),reason:e}}),s()},this.runRequestAutoplaySettingsLogger(o,t,n),o.then(e=>{var r,o;a||(o=e,function(e,t){return!t||e.allowMuted!==t.allowMuted||e.autoplay!==t.autoplay||e.muted!==t.muted}(r=t,n)&&i(()=>{pf.setItem(sa(r),JSON.stringify(aa({},o,{cacheVersion:2,time:Date.now()})))}))}),this.defineAutoplaySettingsPromise=Promise.all([o,this.visibilityDetectPromise]).then(e=>{let[t]=e;r=t,this.clearRequestAutoplaySettingsTimeout();const{isVisible:i}=this.state.controller;pp.log("Autoplay settings defined",r);const{autoplay:n,muted:o,autoplayImpossible:a,requireAllowMutedToAutoplay:s}=r;this.callbacks.onChangeAutoplayImpossible(a||!1),this.playerStore.dispatch(Cu({muted:o,volume:this.state.controller.volume,changeReason:Jp.RequestAutoplaySettings}));const l=function(e){const{controller:{togglePlaybackOnVisibilityChangeSetting:t,muted:i}}=e;return!!t&&!(t.onlyMuted&&!i)}(this.state)&&!1===i;l&&this.callbacks.logEvent({event:"HiddenAutoplayPrevented",params:{autoplaySettingsRequestResult:r}});const d=n&&!l&&this.state.controller.autoplay;pp.log("autoplay status:",n),pp.log("isVisible",i),pp.log("preventHiddenAutoplay",l);const c=d?Vh.starting:Vh.waitForUserPlay;var u;(this.playerStore.dispatch(Pu(c)),d)?this.playerStore.dispatch(_u(!0)):null==(u=this.playDeferred)||u.reject(new Error("playing rejected cause of autoplay-false"));if(this.playerStore.dispatch(Ru(d)),a){this.playerStore.dispatch(Ou(!0)),this.callbacks.logEvent({event:"AutoplayImpossible",params:{autoplaySettingsRequestResult:r}});try{console.warn("Cannot autoplay video"+(s?" with sound":"")+" in this environment."+(s?" Use autoplay={allowMuted: true} if you prefer mute video and enable autoplay.":""))}catch(h){}}})}createVideoController(e,t){let{stream:i,supportInfo:r}=e;const n={playerStore:this.playerStore,video:this.video,videoSizeSensor:this.videoSizeSensor,stream:i,sourceParams:t,debug:this.debug,liveOffset:this.config.liveOffset,slowConnection:this.config.slowConnection,maxBufferLength:this.maxBufferLength,defaultQuality:this.state.controller.defaultQuality,isMultipleHLSAudioBitrate:this.config.isMultipleHLSAudioBitrate,isDebugSupportedVideoCodecEventEnabled:this.config.isDebugSupportedVideoCodecEventEnabled,isDowngradeVideoTrackFallbackEnabled:this.config.isDowngradeVideoTrackFallbackEnabled,maxRecoverAttempts:this.config.maxRecoverAttempts,bandwidthEstimateOffset:this.config.bandwidthEstimateOffset,resourceTimingsMonitor:this.resourceTimingsMonitor,capSizesOverride:this.capSizesOverride,setPlayerBackgroundImage:this.setBackgroundImage,setPlayerBackgroundVisibility:this.setBackgroundVisibility,onError:e=>this.onError(e),onRecover:this.onRecover,logEvent:this.callbacks.logEvent,onSubtitlesChange:this.callbacks.onSubtitlesChange,onThumbnailTileGeneralMetaInfoChange:this.callbacks.onThumbnailTileGeneralMetaInfoChange,onExpectedStalledChange:this.callbacks.onExpectedStalledChange,getPipWindowSize:()=>this.visualState.getPipWindowSize()},o=(a=r.engine,s=n,l=this.getPreloader(i,t),a===Qp.HLS?new Vv(s):a===Qp.MPD?new lm(s,l):a===Qp.MP4?new jv(s):new hm(s));var a,s,l;this.cleanCachePreloaders();const d=e=>{this.videoController=e,this.playerStore.dispatch(Tu(r.engine)),this.callbacks.onEngineChange(r.engine,this.playerStore.getState().controller.sourceId),e.on("VideoPlayingStateChange",e=>this.emit("VideoPlayingStateChange",e)),e.on("MetadataChange",e=>this.emit("MetadataChange",e)),e.on("CurrentTimeChange",e=>this.emit("CurrentTimeChange",e)),e.on("DurationChange",e=>this.emit("DurationChange",e)),e.on("DvrChange",()=>this.emit("DvrChange")),e.on("DVRDurationChange",e=>this.callbacks.onDVRDurationChange(e)),e.on("DVRStartTimeChange",e=>this.callbacks.onDVRStartTimeChange(e)),e.on("ProgramDateTimeChange",e=>this.emit("ProgramDateTimeChange",e)),e.on("BufferingRangesChange",e=>this.emit("BufferingRangesChange",e)),e.on("CanPlay",()=>this.emit("CanPlay")),e.on("ContentImpression",()=>this.emit("ContentImpression")),e.on("DrmSystemChange",this.callbacks.onDrmSystemChange),e.on("LoadedData",()=>this.emit("LoadedData")),e.on("VideoTypeChange",e=>this.emit("VideoTypeChange",e)),e.on("VideoTrackValueChange",e=>this.emit("VideoTrackValueChange",e)),e.on("AudioTrackValueChange",e=>this.emit("AudioTrackValueChange",e)),e.on("TextTrackValueChange",e=>this.emit("TextTrackValueChange",e)),e.on("VideoTracksChange",e=>this.emit("VideoTrackChange",e)),e.on("AudioTracksChange",e=>this.emit("AudioTracksChange",e)),e.on("TextTracksChange",e=>this.emit("TextTracksChange",e))};return Jl(o)?Promise.resolve().then(async()=>d(await o)):d(o)}cleanCachePreloaders(){for(;this.cachePreloaders.length>0&&this.config.cacheSourcesCount<this.cachePreloaders.length;)this.cachePreloaders[0].destroy(),this.cachePreloaders.splice(0,1)}getPreloader(e,t){const i=Dr(e.url),r=this.preloaders.filter(e=>Dr(e.getSource().stream.url)===i);var n;r.push(...this.cachePreloaders.filter(e=>Dr(e.getSource().stream.url)===i)),r.sort((n=t.startPosition.videoTime||jl(0),function(e,t){const{total:i,audio:r,video:o}=Ir(e.getBufferedInfo(),n),{total:a,audio:s,video:l}=Ir(t.getBufferedInfo(),n);return i!==a?a-i:o!==l?l-o:s-r}));const o=r[0];if(void 0===o)return;let a=this.preloaders.indexOf(o);return a>-1?this.preloaders.splice(a,1):(a=this.cachePreloaders.indexOf(o),a>-1&&this.cachePreloaders.splice(a,1)),o}getPreparedSourceParams(e,t,i){return xa({},Hp,t,{startPosition:this.getInitialStartPosition(t,i),withCredentials:Nr(e,t)})}getInitialStartPosition(e,t){const i=e&&e.startPosition||Hp.startPosition;if(i){if(v(i).some(e=>B(i[e])))return i}const r=null==t?void 0:t.getProgress();return void 0===r?i:{videoTime:r}}async loadSource(e,t){var i;let{shouldSaveProgress:r}=t;pp.log("loadSource start",e),this.callbacks.onEngineChange(void 0,this.playerStore.getState().controller.sourceId),this.callbacks.onDrmSystemChange(void 0);const n=r?"LoadSourceWithSaveProgress":"LoadSource";this.callbacks.logEvent({event:n,params:{source:e}}),this.shouldCaptureScreenshot()&&(this.setBackgroundImage(),this.setBackgroundVisibility(!1),this.videoController.clearScreenshot()),this.adManager.stopAdmanAd(),null==(i=this.adManager.getTimer())||i.stop(),this.adManager.stopAd({stopAdReason:rp.LoadSource,data:{loadPositionAfterAd:void 0}}),this.adManager.resetPlannedAdViewers(),this.stopLoadSource(Xp.setSource),this.playbackProgressStorage.clearVideoContentId(),this.playerStore.dispatch(Gu(void 0)),this.playerStore.dispatch(Fu(void 0)),this.playerStore.dispatch(Uu(void 0)),this.playerStore.dispatch(Hu(e.streams)),this.playerStore.dispatch(Th(!1));const{preferredAudioLangs:o,preferredTextLangs:a}=e.params.preferredTracks;o.length>0&&this.playerStore.dispatch(lh({lang:o[0],name:void 0})),a.length>0&&this.playerStore.dispatch(fh({lang:a[0],name:void 0,enabled:!0}));const s=new kd;this.stopLoadSource=e=>s.stop(e);try{this.getMultiroll().destroy()}catch(kE){}this.adManager.resetMultiroll();const l=!this.videoController,{streams:d}=e,c=_r({streams:d,video:this.video,preferNative:this.preferNative}),u=kr(e.params),h=function(e){return I(e)&&!1===e.hasPreroll}(u);this.playerStore.dispatch(uu(I(u)&&(!h||!1!==u.hasPreroll)));let p=h||!this.shouldPlayAd()?null:this.adManager.initMultirollModule(u,s);const f=this.destroyVideoController(),g=await c;if(this.playerStore.dispatch(Gu(g.streamsWithSupportInfo)),s.stopReason)return void this.callbacks.logEvent({event:Cp.StreamStopWhileChoosingStream,params:void 0});if("error"===g.status)throw g.error;const{supportedStream:v}=g;var m;(m=v).supportInfo.engine===Qp.MPD?oa(_g):m.supportInfo.engine===Qp.HLS&&oa(Pg);const{stream:A}=v;this.playbackProgressStorage.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const E=this.getPreparedSourceParams(A,e.params,this.playbackProgressStorage);if(await f,s.stopReason)return void this.callbacks.logEvent({event:Cp.StreamStopWhileDestroyVideoController,params:void 0});if(this.resetPlayerStore(A,E,{shouldSaveProgress:r,isFirstLoad:l}),await Promise.race([this.defineAutoplaySettingsPromise,s.stopPromise]),s.stopReason)return void this.callbacks.logEvent({event:Cp.StreamStopDuringDefineAutoplaySettings,params:void 0});const y=this.createVideoController(v,E);if(Jl(y)&&(await Promise.race([y,s.stopPromise]),s.stopReason))return;this.state.ad.hasPreroll||!this.state.controller.preload&&!this.state.controller.autoplay||this.preloadVideoControllerSource(),l?(Promise.resolve().then(()=>{this.adManager.initBroadcastAd()}),Or(A.url,Boolean(E.withCredentials)).then(e=>{location.href.includes("dzen.ru/news")?this.playerStore.dispatch(au(!1)):this.playerStore.dispatch(au(e||Ps))}),this.setMuted(this.state.controller.muted),this.setVolume(this.state.controller.volume)):this.prepareNextSource(A,E),this.setPosterFitStyle(),this.once("ContentImpression",this.handleFirstContentImpression),this.once("SetSource",()=>this.off("ContentImpression",this.handleFirstContentImpression));const S=async()=>{p||(p=this.adManager.initMultirollModule(u,s));const e=await p;if(s.stopReason)return this.callbacks.logEvent({event:Cp.StreamStopWhileLoadingMultiroll,params:{streamStopReason:s.stopReason}}),void e.destroy()};if(this.shouldPlayAd())if(h){const{adInitOffset:e=0}=u||{};new Promise(t=>{let i=!1;const r=()=>{this.off("CurrentTimeChange",n),this.off("ContentImpression",o)},n=()=>{if(!i)return;this.getWatchedTime()<=e||(r(),t())},o=()=>{i=!0};this.on("ContentImpression",o),this.on("CurrentTimeChange",n),this.once("SetSource",r)}).then(()=>{s.stopReason||S()})}else await S();s.stopReason||this.startPrerollAndContent(s,l,u)}async preloadSourceImpl(e,t,i){const{streams:r}=e,n=_r({streams:r,video:PA,preferNative:this.preferNative}),o=await n;if(t())throw new Error("abort preloadSource");if("error"===o.status)throw o.error;const{supportedStream:a}=o,{stream:s,supportInfo:l}=a,d=new Kf;d.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const c=this.getPreparedSourceParams(s,e.params,d),u=Lr({stream:s,sourceParams:c}),h=this.preloaders.find(e=>Lr(e.getSource())===u);if(h)return i(()=>h.destroy()),h.preload();const p=function(e){let{engine:t,source:i,getState:r,getCapSizes:n}=e;switch(t){case Qp.MPD:return new zg({source:i,getState:r,getCapSizes:n,type:zp.Api});default:return}}({engine:l.engine,source:{stream:s,sourceParams:c},getState:()=>this.playerStore.getState(),getCapSizes:()=>{var e;return null==(e=this.videoController)?void 0:e.getCapSizes()}});if(!p)throw new Error("can not create preloader");return this.preloaders.splice(0,0,p),this.preloaders=this.preloaders.filter(e=>!e.isDestroyed).slice(0,10),i(()=>p.destroy()),p.preload()}async startPrerollAndContent(e,t,i){pp.log("startPrerollAndContent");let r=[];const n=U(()=>this.startStream()),o=U(async()=>{if(!this.shouldPlayAd())return;const t=this.getMultiroll().preroll.loadViewers({}),i=await Promise.race([t,e.stopPromise.then(()=>{})]);if(void 0===i)return;r=i;const n=r.length>0;this.playerStore.dispatch(cu(n)),n&&this.callbacks.logEvent({event:Cp.PrerollInit,params:{}})}),{startStage:a,preload:s}=this.state.controller;if(a===Vh.waitForUserPlay||a===Vh.waitForDocumentVisibility){if(pp.log("Waiting for "+(a===Vh.waitForUserPlay?"user gesture":"document visibility")),this.callbacks.logEvent({event:a===Vh.waitForUserPlay?Cp.WaitForUserGesture:Cp.WaitForDocumentVisibility,params:{preload:s}}),s){if(pp.log("Preload preroll in player"),await Promise.race([o(),e.stopPromise]),e.stopReason)return void this.callbacks.logEvent({event:Cp.StreamStopWhilePreloadingPreroll,params:{streamStopReason:e.stopReason}});this.state.ad.hasPreroll||(pp.log("No preroll, preload content"),n())}if(a===Vh.waitForDocumentVisibility&&await function(e,t){return T(e)===t?Promise.resolve():new Promise(i=>{R(e,e=>{e===t&&i()})})}(this.getContainerDocument(),!0),this.state.controller.startStage===Vh.waitForUserPlay&&await this.waitForPlay(),e.stopReason)return void this.callbacks.logEvent({event:a===Vh.waitForUserPlay?Cp.StreamStopWhileWaitingForPlay:Cp.StreamStopWhileWaitingForDocumentVisibility,params:{streamStopReason:e.stopReason}})}if(pp.log("Start playing"),t&&this.playerStore.dispatch(Ru(!0)),await Promise.race([o(),e.stopPromise]),e.stopReason)this.callbacks.logEvent({event:Cp.StreamStopWhileLoadingPreroll,params:{streamStopReason:e.stopReason}});else{if(!this.state.ad.hasPreroll)return await n(),this.playAfterWaitingForDocumentVisibility(),void this.performPlayCallbacks();this.playerStore.dispatch(_u(!0)),pp.log("Start preroll"),this.adManager.playAdViewers(Kh.preroll,$(r,Kh.preroll),this.patchAdControlsVisibility({videoSlotCanAutoPlay:a!==Vh.waitForDocumentVisibility||void 0},i.hideAdControls),i)}}waitForPlay(){const e=H();return new Promise(t=>{let i=Q,r=0;const n=n=>{i(),clearInterval(r),this.callbacks.logEvent({event:Cp.WaitForPlayCompleted,params:{reason:n,timeout:Gl(e())}}),this.playerStore.getState().controller.startStage!==Vh.started&&this.playerStore.dispatch(Pu(Vh.starting)),t()};this.video.paused?(this.playCallbacks.push(()=>{n(Kp.PlayCallback)}),i=f(this.video,"play",()=>{n(Kp.VideoPlayEvent)}),r=window.setInterval(()=>{this.video.paused||n(Kp.DetectByInterval)},250)):n(Kp.VideoIsNotPausedOnInit)})}updateVideoInfo(){ei(this.state)?this.playbackQualityController.persist():this.playbackQualityController.update()}resetPlayerStore(e,t,i){let{shouldSaveProgress:r,isFirstLoad:n}=i;this.playerStore.dispatch(Bu()),this.playerStore.dispatch(Fu(e)),this.playerStore.dispatch(Uu(t));const o=this.getStartPositionForLoadSource(t,{shouldSaveProgress:r});if(this.playerStore.dispatch(ju(o)),r||this.playerStore.dispatch(ku(Uh.duration)),this.playerStore.dispatch(Mu(Wl(Math.max(0,o.videoTime||Uh.currentTime)))),!n){const{additionalParams:e=Bp}=t,{from:i=Up}=e;this.playerStore.dispatch(xu(i)),this.playerStore.dispatch(yh(t.preview||Hp.preview)),this.playerStore.dispatch(Zu(Uh.bufferingRanges)),r||this.playerStore.dispatch(Sh(Uh.watchedTime)),this.playerStore.dispatch(Nu(void 0)),this.playerStore.dispatch(Ku(void 0)),this.playerStore.dispatch(nh(Uh.videoTracks)),this.playerStore.dispatch(ah(Uh.audioTrackValue)),this.playerStore.dispatch(sh(Uh.audioTracks)),this.playerStore.dispatch(ch(Uh.textTrackEnabled)),this.playerStore.dispatch(ph(Uh.textTrackValue)),this.playerStore.dispatch(dh(Uh.textTracks)),this.callbacks.onSubtitlesChange([]),this.callbacks.onThumbnailTileGeneralMetaInfoChange(void 0),this.playerStore.dispatch(su({})),this.state.controller.playingState===$l.END&&this.playerStore.dispatch(Lu($l.PAUSE)),this.playerStore.dispatch(gu(void 0)),this.playerStore.dispatch(cu(!1)),this.playerStore.dispatch(vu(void 0)),this.playerStore.dispatch(wh(Uh.preloadDetails))}this.playerStore.dispatch(iu(kr(t)))}prepareNextSource(e,t){this.playerStore.dispatch($u({})),this.emit("DurationChange",jl(NaN)),this.playerStore.dispatch(_u(!0)),this.playbackQualityController.reset(),this.playCallbacks=[],this.playerStore.dispatch(rh({videoTrackValue:Uh.videoTrackValue,isAbrEnabled:this.state.controller.isAbrEnabled})),this.adManager.getBroadcastAd()&&this.playerStore.dispatch(su({})),this.callbacks.onExpectedStalledChange(ut(Fh.SetSource,{stream:e,params:t}))}performPlayCallbacks(){this.playCallbacks.length>0&&(O(this.playCallbacks),this.playCallbacks=[])}seekToVideoPosition(e,t){Number.isNaN(e)||(ei(this.state)&&!t?this.playerStore.dispatch(ju({videoTime:e})):this.videoController.seek(e))}isLive(){return this.state.controller.videoType===Bh.LIVE}getStartPositionForLoadSource(e,t){let{shouldSaveProgress:i}=t;const{controller:{currentTime:r,watchedTime:n}}=this.state,o=this.getUtcStartTime(),a=void 0===o?void 0:Kl(o,r),s=I(e.startPosition)?e.startPosition:{};return i&&n>0?{videoTime:r,utc:a}:s}getUtcStartTime(){const{controller:{programDateTime:e}}=this.state;return void 0===e?void 0:Xl(e,1e3)}downgradeQualityViaCapSize(){const e=this.getVideoTrack();if(null!=e&&e.width){const i=this.state.controller.videoTracks.find(t=>void 0!==t.width&&void 0!==e.width&&(null==t?void 0:t.width)<e.width);if(i&&i.width){var t;if((null==(t=this.capSizesOverride)?void 0:t.maxWidth)!==i.width){const e=Yl(i.width);this.capSizesOverride={maxWidth:e}}(this.videoController instanceof lm?this.videoController.destroyShakaPlayer():Promise.resolve()).then(()=>{this.loadSource(this.config.source,{shouldSaveProgress:!0}).then(()=>{this.play()})}),this.capSizesOverrideTries+=1}}}isDowngradeQualityFallbackPossible(){return this.config.isDowngradeVideoTrackFallbackEnabled&&this.capSizesOverrideTries<6&&(!Mr()||null===Yf.getItem("unsuccessfullMaxCapSizeTry"))}saveUnsuccessfullDowngradeTryToSessionStorage(){Mr()&&Yf.setItem("unsuccessfullMaxCapSizeTry","true")}onError(e){const{capSizesOverrideTries:t}=this;e.code===Os.SHAKA_VIDEO_ERROR_3016&&this.isDowngradeQualityFallbackPossible()&&this.downgradeQualityViaCapSize();const i=t<this.capSizesOverrideTries,r=new jc(e,{code:e.code||Cs.DEFAULT_ERROR,isFatal:!i&&void 0});var n;(this.playerStore.dispatch($u({error:r})),i)&&this.callbacks.logEvent({event:Cp.SetMaxWidthCapSize,params:{maxWidth:null==(n=this.capSizesOverride)?void 0:n.maxWidth}});if(!r.isFatal)return;6===this.capSizesOverrideTries&&this.saveUnsuccessfullDowngradeTryToSessionStorage();const o=this.adManager.getCurrentAdPlaybackQueue();!ei(this.state)&&o&&o.destroy(rp.PlayerError),this.playerStore.dispatch(Oh($l.PAUSE)),this.resourceTimingsMonitor.updateInfo(),this.destroyVideoController()}async detachEncoder(){this.videoController&&(await this.videoController.detachEncoder(),this.playerStore.dispatch(bu(xh.Detached)))}async attachEncoder(){this.state.controller.isOnline||await new Promise(e=>this.onlineMonitor.once("Online",e)),this.playerStore.dispatch(bu(xh.Attaching));try{await this.videoController.attachEncoder()}catch(kE){throw this.playerStore.dispatch(bu(xh.Detached)),kE}this.playerStore.dispatch(bu(xh.Attached)),this.updateVolumeInfo();const e=this.state.controller.playingState,t=this.videoController.getPlayingState();t&&e!==t&&this.emit("VideoPlayingStateChange",t)}async destroyVideoController(){this.videoController&&(this.cacheVideoController(),await this.videoController.destroy(),this.playerStore.dispatch(bu(xh.Detached)))}cacheVideoController(){if(this.config.cacheSourcesCount<=0)return;if(!this.videoController)return;if(this.state.controller.videoType!==Bh.VOD)return;const e=this.videoController.createCachePreloader();if(!e)return;const t=Dr(this.videoController.getStreamUrl()),i=this.cachePreloaders.findIndex(e=>Dr(e.getSource().stream.url)===t);i>-1&&(this.cachePreloaders[i].destroy(),this.cachePreloaders.splice(i,1)),this.cachePreloaders.push(e)}runRequestAutoplaySettingsLogger(e,t,i){e.then(e=>{this.callbacks.logEvent({event:e.autoplay?"AutoplayAllowed":"AutoplayDisabled",params:{autoplaySettingsRequestResult:e,initialAutoplayParams:t,cachedAutoplayParams:i}})})}async playAfterWaitingForDocumentVisibility(){const{videoController:e}=this,{startStage:t,initialAutoplay:i}=this.state.controller;if(t===Vh.waitForDocumentVisibility&&i&&e){this.callbacks.logEvent({event:Cp.PlayAfterWaitingForDocumentVisibility,params:{}});try{var r;this.performPlayCallbacks(),await e.play(),null==(r=this.playDeferred)||r.resolve()}catch(a){var n,o;if(null!=(n=this.state.controller.errorInfo.error)&&n.isFatal)return void(null==(o=this.playDeferred)||o.reject(a));const{allowMuted:t,muted:i}=this.state.controller;if(!(t&&!i))return;this.setMuted(!0),e.play().then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()},e=>{var t;return null==(t=this.playDeferred)?void 0:t.reject(e)})}}}getContainerDocument(){return this.container.ownerDocument||document}getMainContainer(){return this.config.useFriendlyFrame?this.container:document}setPosterFitStyle(){c(this.video,xa({objectFit:"cover"},this.playerStore.getState().controller.videoElementStyle))}resetPosterFitStyle(){c(this.video,xa({objectFit:"contain"},this.playerStore.getState().controller.videoElementStyle))}hidePoster(){this.video.poster=ld}preloadVideoControllerSource(){void 0!==this.videoController?(this.callbacks.logEvent({event:Cp.PreloadSource,params:{whileAd:!0}}),t(this.videoController.preloadSource())):console.warn("preloadVideoControllerSource: videoController is undefined")}updateVolumeInfo(){this.playerStore.dispatch(Cu({volume:this.video.volume,muted:this.video.muted,changeReason:Jp.VolumeChangeEvent}))}}class IA{constructor(e,t){void 0===e&&(e=window),this.handlers=[],this.onDestroy=new Ll,this.fullscreenElement=null,this.setFullScreenElementFromAPI=()=>{const e=Aa(this.win,this.video);this.setFullscreenElement(e)},this.win=e,this.video=t,t&&fd&&(this.onDestroy.addOne(f(t,"webkitbeginfullscreen",()=>{this.setFullscreenElement(t)})),this.onDestroy.addOne(f(t,"webkitendfullscreen",()=>{this.setFullscreenElement(null)}))),this.names=ma(e,t),this.names&&(this.onDestroy.addOne(f(this.win.document,this.names.events.change,this.setFullScreenElementFromAPI)),this.setFullScreenElementFromAPI())}requestFullscreenForElement(e,t){if(void 0===this.names)throw new this.win.Error("Fullscreen is not supported");{const{request:i}=this.names;if(!(i in e))throw new this.win.Error("Fullscreen is not supported");e[i](t)}}isFullscreen(){return null!==this.fullscreenElement}exit(){if(void 0===this.names)throw new Error("Fullscreen is not supported");this.video&&this.fullscreenElement===this.video?this.video[this.names.exit]():this.win.document[this.names.exit]()}getFullscreenElement(){return this.fullscreenElement}addHandler(e){if("function"!==typeof e)throw new this.win.Error("Fullscreen handler must be a function");this.handlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e)}destroy(){this.handlers.length=0,this.onDestroy.dispatch(void 0)}setFullscreenElement(e){this.fullscreenElement=e,this.handlers.forEach(t=>t(e))}}const CA=(e,t,i)=>{const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t.call(i,e[n],n,e);return r};class OA{constructor(e){this.args=e,this.runningCount=0,this.callback=(e,t)=>{const i=e+1;t?i===this.strategies.length?this.args.callback(t):i===this.runningCount&&this.startNext():(this.stopUntil(i),this.args.callback(t))},this.strategies=CA(e.strategyFactories,(e,t)=>e(e=>this.callback(t,e)))}static from(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>{const i=[];for(const r of t){let t=()=>null;const n=r(Fa({},e,{callback:e=>t(e)}));if(!n)return null;i.push(e=>(t=e,n))}return new OA({callback:e.callback,strategyFactories:i})}}start(){!this.runningCount&&this.strategies.length&&this.startNext()}stop(){this.stopUntil(0)}get isDetermined(){for(const e of this.strategies)if(!e.isDetermined)return!1;return!0}getIsVisible(){for(let e=0;e<this.strategies.length;e++)if(!this.strategies[e].getIsVisible())return!1;return!0}startNext(){this.strategies[this.runningCount++].start()}stopUntil(e){for(;this.runningCount>e;)this.strategies[--this.runningCount].stop()}}const wA=(e,t,i,r)=>function(){try{return t.apply(i||this,arguments)}catch(o){if(n(r)&&r(o),!0===o.preventProtect)throw o;wA.log(o,e)}};wA.log=function(e,t){console.log("LOG:"+t+":"+e)},wA.setTimeout=(e,t,i,r)=>window.setTimeout(wA("timeout",e,i,r),t);class kA{}kA.YaContextCallbacks=Ua("Ya.C","ontext._callbacks"),kA.YaContextCallbacksCalls=Ua("Ya.C","ontext._callbacks_call"),kA.AdvManager=Ua("A","dvManager"),kA.AdvBlock=Ua("A","dvBlock"),kA.RTB=Ua("R","TB"),kA.Rtb=Ua("R","tb"),kA.MetrikaAdtune=Ua("metrika_a","dtune");let DA="hidden",NA="visibilitychange";if(!(DA in document)){const e=["webkit","moz","ms","o"];for(const t of e){const e=t+"Hidden";if(e in document){DA=e,NA=t+"visibilitychange";break}}}const LA=new class{constructor(e){void 0===e&&(e=window),this.windowObj=e,this.initYaBrowserApi()}canUseYaBroApi(){return Boolean(this.yaBroApiInstance&&this.yaBroApiInstance.isInCustoPage)}isPageHiddenYaBroApi(){return!(this.yaBroApiInstance&&this.yaBroApiInstance.pageVisible)}initYaBrowserApi(){this.windowObj.browser&&this.windowObj.browser.BrowserEmbeddedApi&&this.windowObj.browser.BrowserEmbeddedApi.getInstance().then(e=>{this.yaBroApiInstance=e})}};class MA{constructor(e){this.args=e,this.isDetermined=!0,this.onVisibilityChangeCallback=()=>{this.args.callback(this.getIsVisible())}}static factory(e){return new MA(e)}start(){this.timer=window.setTimeout(()=>{this.onVisibilityChangeCallback(),this.subscription=function(e,t,i,r,n){if(!e||!i)return null;let o=Ga(wA("handler:"+t,i,r));const a={un(){Ys(e,t,o)}};var s;return n&&n.once&&!Ks&&(s=o,o=function(e){s.call(this,e),ja(a)}),Ws(e,t,o,zs?n:n&&n.capture),a}(document,NA,this.onVisibilityChangeCallback)})}stop(){window.clearTimeout(this.timer),ja(this.subscription)}getIsVisible(){return!(LA.canUseYaBroApi()?LA.isPageHiddenYaBroApi():Boolean(document[DA]))}}const VA=function(e){void 0===e&&(e=window);const{userAgent:t}=e.navigator;return!!t.includes("Opera Mini")||(!(!t.includes("; wv)")||!t.includes(" OPR/"))||!!t.includes(" OPiOS/"))}();class xA{constructor(e){this.args=e,this.isDetermined=!0,this.callback=e=>{e.forEach(e=>{const t=e.intersectionRatio>=this.observer.thresholds[0];this.args.callback(t)})},this.threshold=Math.max(2**-149,this.args.portion),this.observer=new IntersectionObserver(this.callback,{threshold:this.threshold})}static factory(e){return"undefined"===typeof IntersectionObserver?null:"thresholds"in IntersectionObserver.prototype&&e.element?new xA(e):null}start(){this.observer.observe(this.args.element)}stop(){this.observer.disconnect()}getIsVisible(){return e=this.args.element,t=this.threshold,VA?e.offsetWidth>0&&e.offsetHeight>0:Ya(e)>=(t||Number.MIN_VALUE);var e,t}}let FA=function(e){return e.PiP="PiP",e.YaBroEarly="YaBroEarly",e.YaBroAttrLegacy="YaBroAttrLegacy",e.YaBroAttrCurrent="YaBroAttrCurrent",e.OperaPopOut="OperaPopOut",e.SafariPresentationMode="SafariPresentationMode",e}({});const UA={[FA.PiP]:{isSupported:e=>{if("pictureInPictureEnabled"in e.document){if(za()){const t=Ka(e);return 20===t.major&&t.minor>4||t.major>20}return!0}return!1},getCurrent:e=>e.document.pictureInPictureElement||null,observe:(e,t,i)=>t?(t.addEventListener("enterpictureinpicture",i),t.addEventListener("leavepictureinpicture",i),()=>{t.removeEventListener("enterpictureinpicture",i),t.removeEventListener("leavepictureinpicture",i)}):Q,getPipWindow:e=>e.pictureInPictureWindow||null},[FA.YaBroEarly]:{isSupported:(e,t)=>"broughtOut"in t,getCurrent:(e,t)=>t&&"broughtOut"in t&&t.broughtOut?t:null,observe:(e,t,i)=>t?(t.addEventListener("oowvideobringin",i),t.addEventListener("oowvideobringout",i),()=>{t.removeEventListener("oowvideobringin",i),t.removeEventListener("oowvideobringout",i)}):Q},[FA.YaBroAttrCurrent]:{isSupported:e=>{if(za()){const t=Ka(e);return 18===t.major&&t.minor>=6||t.major>18}return!1}},[FA.YaBroAttrLegacy]:{isSupported:e=>za()&&Ka(e).major<18},[FA.SafariPresentationMode]:{isSupported:(e,t)=>"webkitPresentationMode"in t,getCurrent:(e,t)=>t&&"picture-in-picture"===t.webkitPresentationMode?t:null,observe:(e,t,i)=>t?(t.addEventListener("webkitpresentationmodechanged",i),()=>t.removeEventListener("webkitpresentationmodechanged",i)):Q},[FA.OperaPopOut]:{isSupported:(e,t)=>"onoperadetachedviewcontrol"in t&&"onoperadetachedviewchange"in t}},BA=[FA.PiP,FA.YaBroEarly,FA.YaBroAttrCurrent,FA.YaBroAttrLegacy,FA.SafariPresentationMode,FA.OperaPopOut];class HA extends Td{constructor(e,t){void 0===e&&(e=window),super(),this.api=null,this.apiName=null,this.window=void 0,this.pipWindow=null,this.currentElement=null,this.unsubscribeFromApi=Q,this.handlePipEvent=e=>{var t;const i=e.target;this.digestCurrentElement(i);const r=Boolean(this.getCurrentElement());this.pipWindow=(null==(t=this.api)||null==t.getPipWindow?void 0:t.getPipWindow(e))||null,this.emit("Change",r)},this.window=e;const i=t||window.HTMLVideoElement.prototype;for(let n=0;n<BA.length;n++){const e=BA[n],t=UA[e];try{if(t.isSupported(this.window,i)){this.api=t,this.apiName=e;break}}catch(r){}}this.digestCurrentElement(t),this.api&&this.api.observe&&(this.unsubscribeFromApi=this.api.observe(this.window,t,this.handlePipEvent))}getSupportedApiName(){return this.apiName}getCurrentElement(){return this.currentElement}addHandler(e){return this.api&&this.api.observe?(this.on("Change",e),()=>this.off("Change",e)):null}getPipWindowSize(){if(!this.pipWindow)return null;const{width:e,height:t}=this.pipWindow;return e&&t?{width:e,height:t}:null}destroy(){this.currentElement=null;const e=this.window.document;null!=e&&e.pictureInPictureElement&&(null==e.exitPictureInPicture||e.exitPictureInPicture()),this.off("Change"),this.unsubscribeFromApi()}digestCurrentElement(e){this.api&&this.api.getCurrent&&(this.currentElement=this.api.getCurrent(this.window,e))}}let GA=null;try{"undefined"!==typeof IntersectionObserver&&(GA=OA.from(xA.factory,MA.factory))}catch(DE){}class jA extends Td{constructor(e){super(),this.isSupportedPipMode=!0,this.isYandexPipMode=!1,this.isVisibilitySupported=Boolean(GA),this.window=void 0,this.element=void 0,this.fullscreenApi=void 0,this.pipApi=void 0,this.video=void 0,this.state={isPip:!1,isFullScreen:!1,isVisible:!0},this.observe=e=>(this.on("Change",e),()=>this.off("Change")),this.fireVisualStateHandlers=()=>{const{isPip:e,isVisible:t,isFullScreen:i}=this.state,r={isPip:e,isVisible:t,isFullScreen:i,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode};this.emit("Change",r)},this.handleVisibilityChange=e=>{this.state.isVisible!==e&&(this.state.isVisible=e,this.fireVisualStateHandlers())},this.handlePipChange=e=>{this.state.isPip!==e&&(this.state.isPip=e,this.state.isFullScreen=this.getFullscreenStateProperty(this.fullscreenApi.getFullscreenElement()),this.fireVisualStateHandlers())},this.getFullscreenStateProperty=e=>qa(this.video.ownerDocument,this.video)||this.video===e,this.handleFullscreenChange=e=>{const t=this.getFullscreenStateProperty(e);this.state.isFullScreen!==t&&(this.state.isFullScreen=t,this.fireVisualStateHandlers())},this.element=e,this.window=ra(this.element)}setVideoElement(e){void 0===this.video&&(this.video=e,this.observeFullscreen(),this.observePip())}setExternalVisibility(e){this.handleVisibilityChange(e)}setExternalFullscreen(e){this.state.isFullScreen!==e&&(this.state.isFullScreen=e,this.fireVisualStateHandlers())}changeFullscreenState(e){e.isFullScreen!==this.state.isFullScreen&&(e.isFullScreen?this.fullscreenApi.requestFullscreenForElement(this.video,{navigationUI:"hide"}):this.fullscreenApi.exit())}changePipState(e){e.isPip!==this.state.isPip&&(e.isPip||this.pipApi.destroy())}destroy(){this.emit("Destroy"),this.off("Destroy")}getState(){const{isPip:e,isVisible:t,isFullScreen:i}=this.state;return{isPip:e,isVisible:t,isFullScreen:i,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode}}getPipWindowSize(){return this.pipApi.getPipWindowSize()}observePip(){this.pipApi=new HA(ra(this.video),this.video),this.pipApi.addHandler(this.handlePipChange),this.once("Destroy",()=>{this.pipApi.destroy()});const e=this.pipApi.getSupportedApiName();this.isSupportedPipMode=e!==FA.OperaPopOut,this.isYandexPipMode=e===FA.YaBroAttrCurrent||e===FA.YaBroAttrLegacy}observeFullscreen(){this.fullscreenApi=new IA(this.window,this.video),this.fullscreenApi.addHandler(this.handleFullscreenChange),this.once("Destroy",()=>{this.fullscreenApi.destroy()})}}let WA=function(e){return e.Unknown="Unknown",e.ExternalApi="ExternalApi",e.VisiblePlayback="VisiblePlayback",e.RestoreAfterInsertInto="RestoreAfterInsertInto",e.WaitForSourceConfigUpdate="WaitForSourceConfigUpdate",e.CompletedRecoverSourceConfig="CompletedRecoverSourceConfig",e}({});class YA extends Error{constructor(e,t){const i="object"===typeof e?e:{message:String(e)};if(super(String(i.message)),this.message=void 0,this.messageDetails=void 0,this.code=void 0,this.category=void 0,this.isFatal=void 0,this.details=void 0,this.stack=void 0,this.vsid=void 0,Vm()(this,YA.prototype),this.message=i.message||this.message,this.messageDetails=i.messageDetails,this.code=i.code||0,this.category=a(this.code),this.details=i.details,this.isFatal=void 0===i.isFatal||i.isFatal,this.stack=i.stack&&"?:?:?"!==i.stack?i.stack:this.details&&this.details.stack||((e,t)=>{const{url:i,line:r,col:n,fileName:o,columnNumber:a,lineNumber:s}=e;return String(t||(i||o||"?")+":"+(r||s||"?")+":"+(n||a||"?"))})(i,this.stack),!this.stack||this.stack===fl)try{throw new Error(this.message)}catch(r){r instanceof Error&&(this.stack=r.stack||fl)}this.vsid=t||i.vsid}toString(){return JSON.stringify(this.toJSON())}toJSON(){const e={message:this.message,messageDetails:this.messageDetails,code:this.code,category:this.category,isFatal:this.isFatal,details:this.details,stack:this.stack,vsid:this.vsid};return Xa({},e,{raw:JSON.stringify(e)})}}class KA{setTimeout(e,t){if(t<=0)return void i(e,Qa);const r=window.setTimeout(e,t);return()=>window.clearTimeout(r)}now(){return Tl()}}class zA{constructor(e,t){void 0===t&&(t=new KA),this.distributionFunction=e,this.clock=t,this.stopped=!0,this.cancel=void 0,this.lastNow=0,this.lastKnockTime=void 0,this.lastTimeout=0,this.restTime=0,this.destroyed=!1,this.isFirstKnock=!0,this.count=0}setEnabled(e){return e?this.start():this.stop(),this}stop(){return this.stopped||(this.stopped=!0,this.cancelTimeout(),this.restTime=Math.max(this.restTime-(this.clock.now()-this.lastKnockTime),0)),this}start(){return this.stopped&&!this.destroyed&&(this.stopped=!1,this.lastKnockTime=this.clock.now(),this.setTimeout(()=>this.knock(this.lastNow+this.lastTimeout),this.restTime)),this}destroy(){this.cancelTimeout(),this.stopped=!0,this.destroyed=!0}knock(e){this.lastNow=e,this.lastKnockTime=this.clock.now(),this.isFirstKnock?this.isFirstKnock=!1:this.count++;const t=this.restTime=this.lastTimeout=this.distributionFunction({time:e,count:this.count});this.stopped||this.destroyed||this.setTimeout(()=>this.knock(e+t),t)}cancelTimeout(){void 0!==this.cancel&&this.cancel(),this.cancel=void 0}setTimeout(e,t){this.cancelTimeout();const i=this.clock.setTimeout(e,t);void 0!==i&&(this.cancelTimeout(),this.cancel=i)}}const qA=[0,1,4,5];let XA=jl(0);const QA=qA.map(e=>(XA=Kl(jl(e),XA),XA)),JA=ql(QA[QA.length-1],1e3),ZA=[Fh.Init];const $A=["from","vsid"],eE=["playready-proxy.ott.yandex.ru","playready-proxy-preproduction.ott.yandex.ru","widevine-proxy.ott.yandex.ru","widevine-proxy-preproduction.ott.yandex.ru","fairplay-proxy.ott.yandex.ru","fairplay-proxy-preproduction.ott.yandex.ru","drm.yandex-team.ru"],tE=e=>{let t=e;if(El(e))return[].concat(e).map(e=>tE(e));if(Gh(e))return new Date(e.getTime());if(!n(e)&&I(e)){t={};for(const[i,r]of Object.entries(e))t[i]=tE(r)}return t};let iE=function(e){return e.play="play",e.pause="pause",e.seek="seek",e.setSource="setSource",e.preloadSource="preloadSource",e.abortPreloadSource="abortPreloadSource",e.setVolume="setVolume",e.setMuted="setMuted",e.setFullscreen="setFullscreen",e.setPictureInPicture="setPictureInPicture",e.setPlaybackRate="setPlaybackRate",e.setVideoTrack="setVideoTrack",e.setAudioTrack="setAudioTrack",e.setTextTrack="setTextTrack",e.changeAdditionalParams="changeAdditionalParams",e.setNativeTextTrackVisibility="setNativeTextTrackVisibility",e.setNativeAdControlsVisibility="setNativeAdControlsVisibility",e.setHiddenControls="setHiddenControls",e.setVideoStyle="setVideoStyle",e.setPictureInPictureEnabled="setPictureInPictureEnabled",e.setFeed="setFeed",e.setExternalVisualState="setExternalVisualState",e.getExternalVisualState="getExternalVisualState",e.getConfig="getConfig",e.requestDebugInfo="requestDebugInfo",e.xhrRequest="xhrRequest",e.stopAd="stopAd",e.toggleAdFreeSessionState="toggleAdFreeSessionState",e.updateEpisodes="updateEpisodes",e.playInrollAd="playInrollAd",e.skipAdPod="skipAdPod",e.destroy="destroy",e}({}),rE=0;const nE=["requestId"],oE=Gl(6e4);const aE=e=>void 0===e?void 0:String(e),sE={state:Wh.NOT_PLAYING,type:void 0,adParams:{}},lE={sourceId:NaN,data:void 0},dE=Gl(1e4),cE=Gl(1e3),uE=Gl(5e3),hE=Gl(3e4);class pE extends Nl{constructor(e,t){super(),this.onTick=e,this.onFlush=t,this.wasFirstFlush=!1,this.lastFlushTime=void 0,this.startTime=void 0,this.timer=void 0,this.handleTimeout=()=>{this.onTick(),this.handleFlush(),this.nextTick()},this.startTime=this.lastFlushTime=Il(),this.timer=window.setTimeout(()=>{this.onTick(),this.nextTick()},0)}next(){this.isDestroyed||(window.clearTimeout(this.timer),this.handleFlush(),this.nextTick())}destroy(){super.destroy(),window.clearTimeout(this.timer)}nextTick(){this.isDestroyed||(window.clearTimeout(this.timer),this.timer=window.setTimeout(this.handleTimeout,this.getTimeout()))}handleFlush(){this.needFlush()&&(this.onFlush(),this.lastFlushTime=this.wasFirstFlush?Il():this.startTime,this.wasFirstFlush=!0)}needFlush(){const e=Il();return this.wasFirstFlush?e-this.lastFlushTime>=hE:e-this.startTime>=dE}getTimeout(){return Il()-this.startTime<dE?cE:uE}}class fE extends Nl{constructor(e){super(),this.props=e,this.prevState=void 0,this.states=[],this.timer=void 0,this.timer=new pE(()=>{this.writeState()},()=>{this.flushStates()})}destroy(){super.destroy(),this.timer.destroy(),this.flushStates()}getStates(){return[...this.states]}flushStates(){const e=this.getStates();e.length>0&&this.props.onFlushStates(e),this.states.length=0}writeStateManually(){this.writeState(),this.timer.next()}writeState(){const e=this.props.getState();void 0!==e&&(wp()(this.prevState,e)||(this.prevState=e,this.states.push(hs({},e,{timestamp:x(Gl(Date.now()))}))))}}const gE=NaN,vE={remainingBufferedTime:V(jl(0)),state:$l.BUFFERING,currentTime:V(Nh),watchedTime:V(jl(0)),duration:V(Uh.duration)},mE=as(window.location),{vsid:AE}=mE,EE="true"===mE.use_friendly_frame,yE=EE;var SE;let TE;I(SE=mE)&&i(()=>{!function(e){qf.flagsInited||(qf.flagsInited=!0,I(e)&&I(e.flags)&&i(()=>{for(const[t,i]of Object.entries(e.flags))qf.flags[t]=String(i)}))}({flags:JSON.parse(SE.flags)})});const RE=new class extends Td{getDataFromPostMessageEvent(e){let{data:t}=e;if("object"!==typeof t)return;const{id:i,batch:r}=t;return"string"===typeof i&&0!==i.length&&r&&Array.isArray(r)?{id:i,batch:r}:void 0}constructor(e){let{id:t,sender:i,receiver:r,syncMode:n=!1,internal:o=!1}=e;super(),this.id=void 0,this.key=void 0,this.abortRequestMap=Object.create(null),this.sender=void 0,this.receiver=void 0,this.sendPromise=void 0,this.messagesBatch=[],this.receiverCallback=void 0,this.id=t,this.key=n?"handle_data_"+t:void 0,this.sender=i,this.receiver=r;const a=e=>{const{id:t,batch:i}=e;t===this.id&&i.forEach(e=>{let{answer:t,command:i,event:r}=e;if(t&&void 0!==t.requestId&&this.emit("Answer",t),r&&this.emit("Event",r),!i)return;const a=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(i,nE),s=ss({},o&&n?tE(a):a,{sendAnswer:e=>{this.sendAnswer(e,i.requestId)}});this.emit("Command",s)})};this.receiverCallback=e=>{const t=this.getDataFromPostMessageEvent(e);void 0!==t&&a(t)},this.key&&(r[this.key]=a),r.addEventListener("message",this.receiverCallback)}sendEvent(e,t){let{data:i,sourceId:r}=t;const n={eventName:e,data:i,sourceId:r};this.sendPostMessage({event:n})}sendCommand(e,t){const i={commandName:e,params:t};this.sendPostMessage({command:i})}sendRequest(e,t,i){void 0===i&&(i=oE);const r={commandName:e,params:t,requestId:rE++},n=this.waitForAnswer(r,i);return this.sendPostMessage({command:r}),n}destroy(){this.receiver.removeEventListener("message",this.receiverCallback),this.off("Command"),this.off("Answer"),this.off("Event"),this.off("Error"),A(this.abortRequestMap,e=>e())}abortAllRequests(){A(this.abortRequestMap,e=>e())}flush(){if(this.sendPromise=void 0,0===this.messagesBatch.length)return;const e={id:this.id,batch:[...this.messagesBatch]};this.messagesBatch=[];try{this.sender.postMessage(e,"*")}catch(t){this.safeSendClonedData(e,"*")}}waitForAnswer(e,t){let i,r=Q;const n=()=>{clearTimeout(i),r(),delete this.abortRequestMap[e.requestId]};return new Promise(o=>{i=window.setTimeout(()=>{const t=this.abortRequestMap[e.requestId];"function"===typeof t&&t()},t);const a=t=>{t.requestId===e.requestId&&(n(),o(t.data))};this.on("Answer",a),r=()=>this.off("Answer",a),this.abortRequestMap[e.requestId]=n})}sendAnswer(e,t){void 0===t&&(t=-1);const i={data:e,requestId:t};this.sendPostMessage({answer:i})}sendPostMessage(e){let{event:t,command:i,answer:r}=e;if(this.key)try{const e={id:this.id,batch:[{event:t,answer:r,command:i}]};return void this.sender[this.key](e)}catch(DE){}this.messagesBatch.push({event:t,answer:r,command:i}),this.planRealSend()}safeSendClonedData(e,t){try{this.sender.postMessage(JSON.parse(JSON.stringify(e)),t)}catch(kE){kE instanceof Error&&this.emit("Error",kE)}}planRealSend(){void 0===this.sendPromise&&(this.sendPromise=Promise.resolve().then(()=>this.flush()))}}({id:AE,sender:window.parent,receiver:window,syncMode:yE,internal:!0}),PE=e=>{RE.sendEvent("onLogEvent",{sourceId:-1,data:e})},_E=new class extends Td{constructor(e){super(),this.getPreloadDetails=e,this.isBuffering=!1,this.timer=void 0,this.stalledId=1,this.expectedStalled=ut(Fh.Init,void 0),this.currentStalled=void 0,this.stalledTime=jl(0),this.stalledCount=0}setBuffering(e){var t;if(e!==this.isBuffering)if(this.isBuffering=e,this.isBuffering)this.timer=new zA(e=>{let{count:t}=e;const i=this.getExpectedStalled();if(t>0){const e=jl(QA[t-1]),r=this.currentStalled?this.currentStalled.id:this.stalledId++;this.currentStalled||this.stalledCount++,this.currentStalled={id:r,expectedStalled:i,duration:e,getElapsedTime:H()},this.send(!1,i,e,r),e===jl(10)&&this.sendLongStalledDebugLog()}return t>=qA.length?(this.destroyTimer(),1/0):1e3*qA[t]}),this.timer.start();else{if(this.currentStalled){const{expectedStalled:e,id:i}=this.currentStalled,r=void 0===(t=this.currentStalled)?jl(0):Kl(t.duration,Xl(t.getElapsedTime(),1e3));this.send(!0,e,r,i),this.currentStalled=void 0,this.stalledTime=Kl(r,this.stalledTime)}this.destroyTimer()}}getStalledHistory(){const{stalledCount:e,stalledTime:t}=this;return{stalledCount:x(e),stalledTime:V(t)}}clearStalledHistory(){this.stalledCount=0,this.stalledTime=jl(0)}destroy(){this.destroyTimer()}getCurrentStalledReason(){var e;return null==(e=this.currentStalled)?void 0:e.expectedStalled.reason}setExpectedStalled(e){this.expectedStalled=e}isExpiredStalled(e){const{getElapsedTime:t,reason:i}=e;return!ZA.includes(i)&&((!this.currentStalled||this.currentStalled.expectedStalled!==e)&&t()>=JA)}getExpectedStalled(){const{expectedStalled:e}=this;return this.isExpiredStalled(e)?ut(Fh.Other,void 0):e}destroyTimer(){this.timer&&(this.timer.destroy(),this.timer=void 0)}send(e,t,i,r){const{reason:n,details:o}=t,a={id:r,isStalledEnd:e,reason:n,stalledDuration:i,details:Ja({},o,n===Fh.SetSource&&this.getPreloadDetails())};this.emit("SendStalled",a)}sendLongStalledDebugLog(){this.emit("SendLongStalledDebugLog")}}(()=>{var e;return null==(e=TE)?void 0:e.getPreloadDetails()});_E.on("SendStalled",e=>{var t,i,r;PE({event:e.isStalledEnd?"StalledEnd":"Stalled",params:gs({},e.details,{stalledDuration:e.stalledDuration,remainingBufferedTime:null==(t=TE)?void 0:t.getRemainingBufferedTime(),videoTrack:null==(i=TE)?void 0:i.getVideoTrack(),stalledId:e.id,isMuted:null==(r=TE)?void 0:r.getMuted()}),additionalStatsLabels:{reason:e.reason}})}),_E.on("SendLongStalledDebugLog",async()=>{var e;const t=await(null==(e=TE)?void 0:e.getLongStalledDebugInfo());t&&PE({event:"LongStalledDebugLog",params:gs({},t)})});const bE=e=>{const t=ls(e),i=t.isFatal?s(t.code,CE):void 0,r=ls(new YA(gs({},t,{messageDetails:i})));RE.sendEvent("onError",{sourceId:vs(),data:r})};let IE=WA.Unknown,CE=Ps,OE=$l.PAUSE;Br(window).playerJsLoaded=!0;const wE={};(async()=>{const e=async function(e){const t=EE&&zf.initialStreamPlayerParams?tE(zf.initialStreamPlayerParams):await e.sendRequest(iE.getConfig,void 0);return gs({},t,{isMultipleHLSAudioBitrate:t.isMultipleHLSAudioBitrate,isDebugSupportedVideoCodecEventEnabled:t.isDebugSupportedVideoCodecEventEnabled,isDowngradeVideoTrackFallbackEnabled:t.isDowngradeVideoTrackFallbackEnabled,mediascopeLogUrl:t.mediascopeLogUrl,isAdFreeSession:t.isAdFreeSession,isAdTestMode:t.isAdTestMode,maxRecoverAttempts:t.maxRecoverAttempts,env:t.env,device:t.device,bandwidthEstimateOffset:t.bandwidthEstimateOffset,maxBufferLength:t.maxBufferLength,skinConfig:t.skinConfig,backgroundColor:t.backgroundColor,togglePlaybackOnVisibilityChange:t.togglePlaybackOnVisibilityChange,keepLastFrame:t.keepLastFrame,isDelayUntilNextEpisodeEnabled:t.isDelayUntilNextEpisodeEnabled,maxDelayUntilNextEpisode:t.maxDelayUntilNextEpisode,episodes:t.episodes,isAdEventsExposed:t.isAdEventsExposed})}(RE),t={onBeforeAdStart:()=>{RE.sendEvent("onBeforeAdStart",{sourceId:vs(),data:void 0})},onAdEnd:()=>{RE.sendEvent("onAdEnd",{sourceId:vs(),data:void 0})},onDrmSystemChange:e=>{RE.sendEvent("onDrmSystemChange",{sourceId:vs(),data:e})},onChangeStream:e=>{RE.sendEvent("onChangeStream",{sourceId:vs(),data:e}),e&&(cs({preview:s.preview,adConfig:s.adConfig,additionalParams:o},e.url),s.stream=e)},onError:bE,onRecover:e=>{RE.sendEvent("onRecover",{sourceId:vs(),data:e})},onStateChange:e=>{const t=vs();OE===$l.BUFFERING&&e===$l.PLAY&&_E.setExpectedStalled(ut(Fh.Other,void 0)),e===$l.BUFFERING?_E.setBuffering(!0):_E.setBuffering(!1),s.playingState!==e&&(s.playingState=e,RE.sendEvent("onStateChange",{sourceId:t,data:{playingState:e,reason:IE}}),IE=WA.Unknown,d.writeStateManually()),OE=e},onAdStateChange:e=>{const{adState:t,playingState:i}=s;t.state===Wh.NOT_PLAYING&&e.state===Wh.PLAYING&&_E.setBuffering(!1);t.state===Wh.PLAYING&&e.state===Wh.NOT_PLAYING&&i===$l.BUFFERING&&_E.setBuffering(!0),t.state!==e.state&&(IE=WA.Unknown),s.adState=e,RE.sendEvent("onAdStateChange",{sourceId:vs(),data:e})},onAdLoaded:e=>{RE.sendEvent("onAdLoaded",{sourceId:vs(),data:e})},onAdError:()=>{RE.sendEvent("onAdError",{sourceId:vs(),data:void 0})},onBeforeAdPodStart:e=>{yE&&RE.sendEvent("onBeforeAdPodStart",{sourceId:vs(),data:e})},onAdPodStart:e=>{RE.sendEvent("onAdPodStart",{sourceId:vs(),data:e})},onAdPodClick:()=>{RE.sendEvent("onAdPodClick",{sourceId:vs(),data:void 0})},onAdPodSkip:()=>{RE.sendEvent("onAdPodSkip",{sourceId:vs(),data:void 0})},onAdPodEnd:()=>{RE.sendEvent("onAdPodEnd",{sourceId:vs(),data:void 0})},onAdSkippableStateChange:e=>{RE.sendEvent("onAdSkippableStateChange",{sourceId:vs(),data:e})},onAdPodCloseStateChange:e=>{RE.sendEvent("onAdPodCloseStateChange",{sourceId:vs(),data:e})},onAdPodDurationChange:e=>{RE.sendEvent("onAdPodDurationChange",{sourceId:vs(),data:e})},onAdPodCurrentTimeChange:e=>{RE.sendEvent("onAdPodCurrentTimeChange",{sourceId:vs(),data:e})},onAdPodTimeToSkipChange:e=>{RE.sendEvent("onAdPodTimeToSkipChange",{sourceId:vs(),data:e})},onAdVolumeAvailabilityStateChange:e=>{RE.sendEvent("onAdVolumeAvailabilityStateChange",{sourceId:vs(),data:e})},onAdInteraction:()=>{RE.sendEvent("onAdInteraction",{sourceId:vs(),data:void 0})},onVideoTypeChange:e=>{RE.sendEvent("onVideoTypeChange",{sourceId:vs(),data:e})},onDVRStartTimeChange:()=>{void 0!==TE&&RE.sendEvent("onTimelineInfoChange",{sourceId:vs(),data:TE.getTimelineInfo()})},onDVRDurationChange:()=>{void 0!==TE&&RE.sendEvent("onTimelineInfoChange",{sourceId:vs(),data:TE.getTimelineInfo()})},onCurrentTimeChange:()=>{void 0!==TE&&(RE.sendEvent("onPositionChange",{sourceId:vs(),data:{time:TE.getCurrentTime(),utcTime:TE.getUtcPosition(),watchedTime:TE.getWatchedTime(),videoPlaybackQuality:TE.getVideoPlaybackQuality(),liveLatency:TE.getLiveLatency()}}),RE.sendEvent("onTimelineInfoChange",{sourceId:vs(),data:TE.getTimelineInfo()}))},onFullScreenChange:e=>{RE.sendEvent("onFullScreenChange",{sourceId:vs(),data:e})},onVolumeChange:e=>{RE.sendEvent("onVolumeChange",{sourceId:vs(),data:e})},onVideoTrackChange:e=>{RE.sendEvent("onVideoTrackChange",{sourceId:vs(),data:e})},onVideoTracksChange:e=>{RE.sendEvent("onVideoTracksChange",{sourceId:vs(),data:e})},onAudioTrackChange:e=>{RE.sendEvent("onAudioTrackChange",{sourceId:vs(),data:e})},onAudioTracksChange:e=>{RE.sendEvent("onAudioTracksChange",{sourceId:vs(),data:e})},onTextTrackChange:e=>{RE.sendEvent("onTextTrackChange",{sourceId:vs(),data:e})},onTextTracksChange:e=>{RE.sendEvent("onTextTracksChange",{sourceId:vs(),data:e})},onSubtitlesChange:e=>{RE.sendEvent("onSubtitlesChange",{sourceId:vs(),data:e})},onPlaybackRateChange:e=>{RE.sendEvent("onPlaybackRateChange",{sourceId:vs(),data:e})},onThumbnailTileGeneralMetaInfoChange:e=>{RE.sendEvent("onThumbnailTileGeneralMetaInfoChange",{sourceId:vs(),data:e})},onOriginalBroadcastAdStateChange:e=>{RE.sendEvent("onOriginalBroadcastAdStateChange",{sourceId:vs(),data:e})},onAdblockDetected:e=>{CE=e},onShowSkipAdButton:e=>{RE.sendEvent("onShowSkipAdButton",{sourceId:vs(),data:e})},onShowAdSkin:e=>{RE.sendEvent("onShowAdSkin",{sourceId:vs(),data:e})},onHideControls:e=>{RE.sendEvent("onHideControls",{sourceId:vs(),data:e})},onContentImpression:e=>{RE.sendEvent("onContentImpression",{sourceId:vs(),data:e})},onResourcesIdle:()=>{RE.sendEvent("onResourcesIdle",{sourceId:vs(),data:void 0})},onVisualStateChange:e=>{RE.sendEvent("onVisualStateChange",{sourceId:vs(),data:e})},onBufferingRangesChange:e=>{RE.sendEvent("onBufferingRangesChange",{sourceId:vs(),data:e})},onStartStageChange:e=>{RE.sendEvent("onStartStageChange",{sourceId:vs(),data:e})},onVideoSizeChange:e=>{RE.sendEvent("onVideoSizeChange",{sourceId:vs(),data:e})},onNextAdRemainingTimeChange:e=>{RE.sendEvent("onNextAdRemainingTimeChange",{sourceId:vs(),data:e})},onVideoClickerEvent:e=>{RE.sendEvent("onVideoClickerEvent",{sourceId:vs(),data:e})},logEvent:PE,onAdSDKVersionDefined:e=>{RE.sendEvent("onAdSDKVersionDefined",{sourceId:vs(),data:e})},onStreamsWithSupportInfoChange:e=>{RE.sendEvent("onStreamsWithSupportInfoChange",{sourceId:vs(),data:e})},onEngineChange:(e,t)=>{RE.sendEvent("onEngineChange",{sourceId:t,data:e})},onNetworkStatusChange:e=>{RE.sendEvent("onNetworkStatusChange",{sourceId:vs(),data:e})},onBandwidthEstimateChange:e=>{RE.sendEvent("onBandwidthEstimateChange",{sourceId:vs(),data:e})},onExpectedStalledChange:e=>{_E.setExpectedStalled(e)},onChangeAutoplayImpossible:e=>{RE.sendEvent("onChangeAutoplayImpossible",{sourceId:vs(),data:e})}},i=await e.then(e=>gs({},e,{callbacks:t}));let{additionalParams:o}=i.source.params;i.env&&Bf.setDeviceType(i.env.deviceType),RE.sendEvent("onInit",lE);const a=function(e){const t=EE?window.parent.document.getElementById(La(AE)):document.getElementById("q");if(!t)throw new YA({code:Os.PLAYER_CONTAINER_NOT_FOUND,isFatal:!1,details:e,message:"Player container was not found"});return t}(i);(function(e){return void 0===e&&(e=window),K(e.document.querySelectorAll("style[data-ya-player-style]"))})().forEach(e=>function(e,t){ia(e)!==ia(t)&&t.appendChild(e)}(e,a)),function(e){if(e.source.streams.some(e=>{let{url:t}=e;return _t(t)})){const e=r(window),t=document.createElement("link");t.rel="preconnect",t.href="https://strm.yandex.ru",e.appendChild(t)}}(i);const s=function(e){const[t]=e.source.streams;return{playingState:void 0,startPosition:e.source.params.startPosition.videoTime,env:e.env,withCredentials:e.source.params.withCredentials,preview:e.source.params.preview,stream:t,adConfig:e.source.params.adConfig,adState:sE,yaDirectPixelUrl:e.source.params.yaDirectPixelUrl,yaDirectPixelData:e.source.params.yaDirectPixelData,vid:e.source.params.vid,dzenuid:e.source.params.dzenuid,ea:e.source.params.ea,eg:e.source.params.eg}}(i),l=new jA(a),d=function(e,t,i,r){const n=new fE({getState:()=>{var i;const n=fs({},vE,{isMuted:r.muted,saveData:us()},t.getStalledHistory()),o=e();if(void 0===o)return n;const a=o.getVideoTrack(),s=o.getAudioTrack(),{droppedVideoFrames:l,totalVideoFrames:d}=o.getVideoPlaybackQuality(),c=o.getState(),{videoWidth:u,videoHeight:h}=c.controller,p=o.getBandwidthEstimate(),f=o.getVideoTracks()[0],g=o.getMaxCapAllowedVideoTrack(),v=o.getLiveLatency(),m=o.getRemainingBufferedTime(),A=null==(i=c.ad.adInfo)?void 0:i.adType,E=!A,y=o.getPlayingState(),S=o.getSegmentSize(),T=o.getContainerSize();return fs({},n,{isVisible:c.controller.isVisible,currentTime:V(o.getCurrentTime()),watchedTime:V(o.getWatchedTime()),duration:V(isNaN(o.getDuration())?jl(0):o.getDuration()),liveLatency:void 0===v?void 0:V(v),isMuted:c.controller.muted,ad:A,remainingBufferedTime:V(m.total),remainingVideoBufferedTime:void 0===m.video?void 0:V(m.video),remainingAudioBufferedTime:void 0===m.audio?void 0:V(m.audio),state:y,auto:void 0===a?void 0:a.auto,bitrate:a&&a.bitrate?Math.max(0,Math.floor(ql(a.bitrate,1e3))):void 0,width:x(u)||void 0,height:x(h)||void 0,maxWidth:E&&null!=f&&f.width?x(Yl(f.width)):void 0,maxHeight:E&&null!=f&&f.height?x(Yl(f.height)):void 0,capWidth:E&&null!=g&&g.width?x(Yl(g.width)):void 0,capHeight:E&&null!=g&&g.height?x(Yl(g.height)):void 0,containerWidth:void 0!==T?x(T.width):void 0,containerHeight:void 0!==T?x(T.height):void 0,audioBitrate:s&&s.bitrate?Math.max(0,Math.floor(ql(s.bitrate,1e3))):void 0,audioTrack:s&&s.value||void 0,audioLang:s&&s.lang||void 0,droppedFrames:x(l)||void 0,shownFrames:x(d-l)||void 0,bandwidthEstimate:void 0===p||isNaN(p.value)?void 0:x(Ul(Math.round(p.value))),bandwidthSource:(null==p?void 0:p.source)||void 0,rtt:ps()||void 0,stalledReason:t.getCurrentStalledReason(),segmentWidth:E&&S?x(S.width):void 0,segmentHeight:E&&S?x(S.height):void 0})},onFlushStates:e=>{i({event:"PlayerAlive",params:{states:e}})}}),o=R(document,e=>{e||n.flushStates()});return n.addDestroyHandler(o),n}(()=>TE,_E,PE,i);TE=new bA(a,i,{visualState:l},()=>RE.sendEvent("onReady",lE)),RE.on("Command",e=>{switch(e.commandName){case iE.pause:IE=e.params,void 0!==TE&&TE.pause(),e.sendAnswer();break;case iE.play:IE=e.params,TE?TE.play().then(()=>{e.sendAnswer(!0)}).catch(()=>{e.sendAnswer(!1)}):e.sendAnswer(!1);break;case iE.seek:TE.seek({videoTime:e.params});break;case iE.setPlaybackRate:TE.setPlaybackRate(e.params);break;case iE.changeAdditionalParams:d.flushStates();break;case iE.setSource:const{sourceConfig:t,shouldSaveProgress:r}=e.params;if(!t)throw new YA("setSource method receives an object");d.flushStates(),_E.clearStalledHistory(),e.sendAnswer(),RE.flush(),s.adConfig=t.params.adConfig,s.yaDirectPixelUrl=t.params.yaDirectPixelUrl,s.yaDirectPixelData=t.params.yaDirectPixelData,s.vid=t.params.vid,s.dzenuid=t.params.dzenuid,s.ea=t.params.ea,s.eg=t.params.eg,s.startPosition=t.params.startPosition.videoTime,s.withCredentials=t.params.withCredentials,s.stream=t.streams[0],s.preview=t.params.preview;const{additionalParams:a}=t.params;a&&(o=a),t.streams=t.streams.map(e=>gs({},e,{drmConfig:e.drmConfig?es(e.drmConfig,o.vsid):void 0,url:Za({url:e.url,adConfig:s.adConfig,additionalParams:o})})),cs(t,t.streams[0].url),TE.setSource(t,{shouldSaveProgress:r});break;case iE.preloadSource:const{sourceConfig:c,requestId:u}=e.params,{additionalParams:h}=c.params;c.streams=c.streams.map(e=>gs({},e,{drmConfig:e.drmConfig?es(e.drmConfig,h.vsid):void 0,url:Za({url:e.url,adConfig:c.params.adConfig,additionalParams:h})}));const{promise:p,abort:f}=TE.preloadSource(c);wE[u]=f,p.then(()=>{RE.sendEvent("onPreloadSourceResolve",{sourceId:-1,data:u})}).catch(()=>{RE.sendEvent("onPreloadSourceReject",{sourceId:-1,data:u})}).then(()=>{delete wE[u]});break;case iE.abortPreloadSource:const g=wE[e.params];n(g)&&(g(),delete wE[e.params]);break;case iE.setVolume:e.params>0&&TE.setMuted(!1),TE.setVolume(e.params);break;case iE.setMuted:TE.setMuted(e.params);break;case iE.setVideoTrack:TE.setVideoTrack(e.params);break;case iE.setAudioTrack:TE.setAudioTrack(e.params);break;case iE.setTextTrack:TE.setTextTrack(e.params);break;case iE.setNativeTextTrackVisibility:TE.setNativeTextTrackVisibility(e.params);break;case iE.setNativeAdControlsVisibility:TE.setNativeAdControlsVisibility(e.params);break;case iE.setFullscreen:TE.setFullscreen(e.params);break;case iE.setPictureInPicture:l.changePipState({isPip:e.params});break;case iE.setHiddenControls:TE.setHiddenControls(e.params);break;case iE.setVideoStyle:TE.setVideoStyle(e.params);break;case iE.setPictureInPictureEnabled:TE.setPictureInPictureEnabled(e.params);break;case iE.setFeed:TE.setFeed(e.params);break;case iE.requestDebugInfo:(async function(){let e={};void 0!==TE&&(e=await TE.requestDebugInfo());const{playingState:t}=s;return gs({},e,s,{playingState:t,vsid:AE,version:"1.0-1238",utcPosition:TE.getUtcPosition(),currentTime:TE.getCurrentTime(),system:os(),clientTimestamp:Date.now(),streamUrl:s.stream.url,internalInitialConfig:i})})().then(t=>e.sendAnswer(t));break;case iE.toggleAdFreeSessionState:TE.toggleAdFreeSession(e.params);break;case iE.updateEpisodes:TE.updateEpisodes(e.params);break;case iE.stopAd:TE.stopAd({stopAdReason:rp.InsertIntoCalled,data:{loadPositionAfterAd:void 0}}).then(()=>{e.sendAnswer()});break;case iE.playInrollAd:TE.playInrollAd(e.params);break;case iE.skipAdPod:TE.skipAdPod();break;case iE.destroy:l.destroy(),_E.destroy(),d.destroy(),void 0!==TE&&TE.destroy(),e.sendAnswer(e.params);break;case iE.setExternalVisualState:"boolean"===typeof e.params.isVisible&&l.setExternalVisibility(e.params.isVisible),"boolean"===typeof e.params.isFullscreen&&l.setExternalFullscreen(e.params.isFullscreen);break;default:throw new Error("IFrameApi Error: unexpected command in MessageEvent: "+e.commandName)}}),RE.on("Error",e=>{const t=new Gc(e,{code:Os.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR,details:{},isFatal:!1});RE.sendEvent("onError",{sourceId:vs(),data:t.toJSON()})}),"boolean"===typeof zf.initialVisibility?l.setExternalVisibility(zf.initialVisibility):RE.sendRequest(iE.getExternalVisualState,void 0).then(e=>{let{isVisible:t}=e;l.setExternalVisibility(t)})})().catch(e=>{RE.sendEvent("onInitError",{sourceId:1,data:ls(new Gc(e,{isFatal:"boolean"!==typeof e.isFatal||e.isFatal,code:e.code||Os.ON_PLAYER_INIT_ERROR}))})})})()})();